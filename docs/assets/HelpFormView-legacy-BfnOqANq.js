System.register(["./index-legacy-CBJaRI7y.js","./TileLayer-legacy-otnLbpi3.js","./Button-legacy-7JcGJbKP.js","./Input-legacy-CPbitdLs.js","./translations-legacy-CsVMiQJ8.js","./clock-legacy-BBjfcj9W.js","./circle-check-big-legacy-C92HfSPk.js","./refresh-cw-legacy-DZna4p8Q.js","./message-square-legacy-Ben-4yVd.js","./arrow-left-legacy-BCEH-quZ.js","./x-legacy-BkTJWami.js","./octagon-alert-legacy-G6jPPgTn.js","./globe-legacy-BH8ukcHr.js","./navigation-legacy-Cgr2GBqX.js","./map-pin-legacy-_ytGCQvV.js","./triangle-alert-legacy-DyH4Tz7g.js","./droplets-legacy-CQtlTzoX.js","./shield-legacy-B3RmIOX6.js","./zap-legacy-D_tyUnNo.js","./index-legacy-DfIheBmm.js"],function(e,t){"use strict";var s,a,l,n,i,r,o,c,d,x,u,m,b,g,h,p,f,j,N,y,v,w,k,A,S,z,C,M,E,L,I;return{setters:[e=>{s=e.c,a=e.r,l=e.j,n=e.S,i=e.n},e=>{r=e.u,o=e.c,c=e.l,d=e.a,x=e.e,u=e.M,m=e.T,b=e.L},e=>{g=e.B},e=>{h=e.I,p=e.T},e=>{f=e.t},e=>{j=e.C},e=>{N=e.C},e=>{y=e.R},e=>{v=e.M},e=>{w=e.A},e=>{k=e.X},e=>{A=e.O},e=>{S=e.G},e=>{z=e.N},e=>{C=e.M},e=>{M=e.T},e=>{E=e.D},e=>{L=e.S},e=>{I=e.Z},null],execute:function(){
/**
       * @license lucide-react v0.556.0 - ISC
       *
       * This source code is licensed under the ISC license.
       * See the LICENSE file in the root directory of this source tree.
       */
const t=s("ambulance",[["path",{d:"M10 10H6",key:"1bsnug"}],["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.28a1 1 0 0 0-.684-.948l-1.923-.641a1 1 0 0 1-.578-.502l-1.539-3.076A1 1 0 0 0 16.382 8H14",key:"lrkjwd"}],["path",{d:"M8 8v4",key:"1fwk8c"}],["path",{d:"M9 18h6",key:"x1upvd"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),D=s("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),R=s("locate-fixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),T=s("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function B(e){const t=r().map;return a.useEffect(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}const O=o(function({position:e,...t},s){const a=new c.Marker(e,t);return d(a,x(s,{overlayContainer:a}))},function(e,t,s){t.position!==s.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==s.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==s.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==s.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==s.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),P=({current:e,total:t})=>{const s=Math.min(100,Math.max(0,e/t*100));return l.jsxs("div",{className:"w-full",children:[l.jsxs("div",{className:"flex justify-between text-xs font-semibold uppercase text-slate-500 mb-2",children:[l.jsxs("span",{children:["Step ",e," of ",t]}),l.jsxs("span",{children:[Math.round(s),"%"]})]}),l.jsx("div",{className:"h-2 w-full bg-slate-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-brand-500 transition-all duration-500 ease-out rounded-full",style:{width:`${s}%`}})})]})};delete b.Icon.Default.prototype._getIconUrl,b.Icon.Default.mergeOptions({iconRetinaUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcY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",iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"});const U=({marker:e,onPick:t})=>(B({click:e=>{t({lat:e.latlng.lat,lng:e.latlng.lng})}}),e?l.jsx(O,{position:[e.lat,e.lng]}):null),F={isSafe:null,location:"",emergencyType:"",isInjured:null,injuryDetails:"",situationDescription:"",canEvacuate:null,hazardsPresent:null,hazardDetails:"",peopleCount:1,petsPresent:null,hasWater:null,hasFood:null,hasMeds:null,hasPower:null,hasPhone:null,needsTransport:null,vulnerableGroups:[],medicalConditions:"",damageType:"",consentToShare:!0};e("HelpFormView",({setView:e})=>{const[s,r]=a.useState(1),[o,c]=a.useState(F),[d,x]=a.useState(!1),[b,B]=a.useState(!1),[O,H]=a.useState("idle"),[q,J]=a.useState(""),[K,V]=a.useState(null),[Y,W]=a.useState(null),[X,G]=a.useState(!1),[Q,Z]=a.useState(!0),[$,_]=a.useState(null),[ee,te]=a.useState(""),[se,ae]=a.useState(!1),[le,ne]=a.useState(!navigator.onLine),ie=a.useRef(!1),re=a.useRef(null),oe=a.useRef(0),[ce,de]=a.useState(!1),[xe,ue]=a.useState(null),[me,be]=a.useState(!1),ge=a.useRef(null),[he,pe]=a.useState(!1);a.useEffect(()=>{r(1),c(F),x(!1),B(!1),H("idle"),V(null),W(null),G(!1),Z(!0),_(null),te(""),ae(!1),ie.current=!1,re.current=null,oe.current=0},[]),a.useEffect(()=>{var e;const t=n.getProfile();J(t.emergencyContactPhone||""),null===(e=navigator.permissions)||void 0===e||e.query({name:"geolocation"}).then(e=>{"granted"===e.state&&Z(!0)});const s=()=>ne(!1),a=()=>ne(!0);return window.addEventListener("online",s),window.addEventListener("offline",a),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}},[]),a.useEffect(()=>{if(ie.current)return;const e=n.getLastKnownLocation();e&&(ie.current=!0,c(t=>t.location?t:{...t,location:e.location}),te(new Date(e.timestamp).toLocaleTimeString()),Z(!1),ae(!1))},[]);const fe=e=>{const t=e.match(/^\s*(-?\d+(?:\.\d+)?)\s*,\s*(-?\d+(?:\.\d+)?)\s*$/);if(!t)return null;const s=Number(t[1]),a=Number(t[2]);return Number.isFinite(s)&&Number.isFinite(a)?Math.abs(s)>90||Math.abs(a)>180?null:{lat:s,lng:a}:null},je=async()=>{const e=String(o.location||"").trim();if(!e)return;const t=fe(e);if(t)return Z(!1),ae(!1),ue(t),de(!0),void W(null);be(!0);try{const t=[async()=>{const t=await fetch(`https://nominatim.openstreetmap.org/search?format=jsonv2&addressdetails=1&q=${encodeURIComponent(e)}&limit=1`,{headers:{Accept:"application/json"}});if(!t.ok)throw new Error("nominatim_failed");const s=await t.json(),a=Array.isArray(s)?s[0]:null;return a?{lat:Number(a.lat),lng:Number(a.lon)}:null},async()=>{var t;const s=await fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(e)}&limit=1`,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error("photon_failed");const a=await s.json(),l=Array.isArray(null==a?void 0:a.features)?a.features[0]:null,n=Array.isArray(null==l||null===(t=l.geometry)||void 0===t?void 0:t.coordinates)?l.geometry.coordinates:null;return n&&2===n.length?{lat:Number(n[1]),lng:Number(n[0])}:null},async()=>{const t=await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(e)}&limit=1`,{headers:{Accept:"application/json"}});if(!t.ok)throw new Error("mapsco_failed");const s=await t.json(),a=Array.isArray(s)?s[0]:null;return a?{lat:Number(a.lat),lng:Number(a.lon)}:null}];let s=NaN,a=NaN;for(const e of t)try{const t=await e();if(t&&Number.isFinite(t.lat)&&Number.isFinite(t.lng)){s=t.lat,a=t.lng;break}}catch{}if(!Number.isFinite(s)||!Number.isFinite(a))return void W("Address not found. Try a more specific address.");const l={lat:s,lng:a};Z(!1),ae(!1),ue(l),de(!0),W(null),ve({location:`${s.toFixed(6)}, ${a.toFixed(6)}`}),te((new Date).toLocaleTimeString())}catch{W("Map search failed. Please try again.")}finally{be(!1)}},Ne=a.useMemo(()=>{const e=fe(o.location||"");if(e)return e;const t=n.getLastKnownLocation();return(null!=t&&t.location?fe(t.location):null)||{lat:37.7749,lng:-122.4194}},[o.location]);a.useEffect(()=>{if(!ce)return;const e=fe(o.location||"");e&&ue(e)},[o.location,ce]);const ye=async()=>{ae(!1),W("Location services unavailable. Please enter address manually.")};a.useEffect(()=>{let e;return Q&&"geolocation"in navigator?(W(null),G(!1),ae(!1),e=navigator.geolocation.watchPosition(e=>{const{latitude:t,longitude:s,accuracy:a}=e.coords,l=Date.now(),i=Number.isFinite(a)?Math.round(a):null,r=re.current,o=null!==i&&(null===r||i<=r+5),d=l-oe.current>3e4;if(o||d){re.current=null!=i?i:r,oe.current=l;const e=`${t.toFixed(6)}, ${s.toFixed(6)}`;c(t=>({...t,location:e})),_(i),te((new Date).toLocaleTimeString()),W(null),G(!1),ae(!1),K&&n.updateRequestLocation(K,e)}},e=>{let t="Location unavailable",s=!1;switch(e.code){case 1:t="GPS denied. Please enter address manually.",G(!0),ye(),s=!0;break;case 2:t="Signal weak. Please enter address manually.",ye(),s=!0;break;case 3:t="GPS Timeout. Retrying...";break;default:t="GPS Error"}se||s||W(t),_(null),s&&Z(!1)},{enableHighAccuracy:!0,maximumAge:0,timeout:2e4})):Q&&!("geolocation"in navigator)&&(W("GPS not supported. Using Network Location."),ye(),Z(!1)),()=>{e&&navigator.geolocation.clearWatch(e)}},[Q,K]),a.useEffect(()=>()=>{if(he){var e;const t=null===(e=ge.current)||void 0===e?void 0:e.srcObject;null==t||t.getTracks().forEach(e=>e.stop())}},[he]);const ve=e=>{c(t=>({...t,...e}))},we=()=>{const e=q.replace(/[^\d+]/g,""),t=null===o.isSafe?"Unknown Status":o.isSafe?"Safe":"IN DANGER",s=o.emergencyType||"Emergency",a=o.location||"GPS Unavailable",l=`I used the AERA app to request emergency assistance.\n\nType: ${s} ${o.situationDescription?`- ${o.situationDescription}`:""}\nLocation: ${a}\nStatus: ${t}`,n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?"&":"?";window.location.href=`sms:${e}${n}body=${encodeURIComponent(l)}`};return b?l.jsxs("div",{className:"min-h-screen bg-white flex flex-col items-center justify-center p-8 text-center animate-fade-in pb-safe",children:[l.jsxs("div",{className:"w-24 h-24 rounded-full flex items-center justify-center mb-6 relative "+(le?"bg-amber-100":"bg-green-100"),children:[l.jsx("div",{className:`absolute inset-0 rounded-full border-4 ${le?"border-amber-500/30":"border-green-500/30"} animate-[ping_2s_ease-out_infinite]`}),le?l.jsx(j,{size:48,className:"text-amber-600 relative z-10"}):l.jsx(N,{size:48,className:"text-green-700 relative z-10"})]}),l.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 mb-2",children:le?"Saved to Outbox":f("help.success_title")}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-900 px-4 py-3 rounded-xl text-sm font-bold mb-8 flex flex-col items-center gap-2 max-w-xs mx-auto animate-pulse",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(y,{size:18,className:"animate-spin"}),"Live Location Sharing Active"]}),l.jsx("span",{className:"font-mono text-xs bg-white/60 px-2 py-1 rounded text-blue-800 border border-blue-100",children:o.location||"Locating..."})]}),le&&l.jsx("p",{className:"text-slate-800 font-medium mb-8 max-w-sm",children:"Your report has been saved to your device. It will automatically upload to responders as soon as you connect to the internet."}),q&&!le&&"idle"!==O&&l.jsxs("div",{className:"text-sm font-bold px-4 py-3 rounded-xl border max-w-xs mx-auto "+("sent"===O?"bg-green-50 text-green-800 border-green-200":"failed"===O?"bg-amber-50 text-amber-800 border-amber-200":"bg-slate-50 text-slate-700 border-slate-200"),children:["sent"===O&&"Emergency contact notified via SMS.","failed"===O&&"Unable to notify emergency contact. You can continue.","sending"===O&&"Notifying emergency contact..."]}),l.jsxs("div",{className:"w-full space-y-4",children:[q&&l.jsxs(g,{fullWidth:!0,onClick:we,className:"bg-slate-900 hover:bg-slate-800 text-white",children:[l.jsx(v,{className:"mr-2",size:20}),f("help.text_contact")]}),l.jsx(g,{fullWidth:!0,variant:"outline",onClick:()=>e("DASHBOARD"),className:"border-slate-300 text-slate-900 font-bold",children:f("help.return_dash")})]})]}):l.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col pb-safe",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 p-4 sticky top-0 z-20",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("button",{onClick:()=>1===s?e("DASHBOARD"):r(e=>Math.max(e-1,1)),className:"p-2 -ml-2 text-slate-600 hover:text-slate-900",children:l.jsx(w,{size:24})}),l.jsx("h1",{className:"font-bold text-xl text-slate-900",children:f("help.title")}),l.jsx("button",{onClick:()=>e("DASHBOARD"),className:"p-2 -mr-2 text-slate-400 hover:text-red-600 transition-colors",title:f("btn.cancel"),children:l.jsx(k,{size:24})})]}),l.jsx(P,{current:s,total:5})]}),l.jsxs("div",{className:"flex-1 p-6 space-y-8 animate-fade-in overflow-y-auto pb-32",children:[1===s&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-xl font-bold text-slate-900",children:f("help.safe_q")}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsx("button",{onClick:()=>ve({isSafe:!0}),className:"p-4 rounded-xl border-2 font-bold transition-all "+(!0===o.isSafe?"border-brand-600 bg-brand-50 text-brand-800":"border-slate-300 bg-white text-slate-700"),children:f("help.yes_safe")}),l.jsx("button",{onClick:()=>ve({isSafe:!1}),className:"p-4 rounded-xl border-2 font-bold transition-all "+(!1===o.isSafe?"border-red-600 bg-red-50 text-red-800":"border-slate-300 bg-white text-slate-700"),children:f("help.no_danger")})]})]}),!1===o.isSafe&&l.jsxs("div",{className:"bg-red-600 text-white p-6 rounded-xl shadow-xl animate-pulse space-y-4 border-4 border-red-800",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(A,{size:48,className:"text-white"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-extrabold uppercase tracking-wider",children:"Immediate Danger"}),l.jsx("p",{className:"font-medium text-red-100",children:"Do not rely solely on this app."})]})]}),l.jsx(g,{fullWidth:!0,size:"xl",className:"bg-white text-red-700 hover:bg-red-50 font-black text-2xl shadow-lg",onClick:()=>{const e="tel:911";try{window.location.href=e}catch{}try{window.open(e,"_self")}catch{alert("Please dial 911 immediately from the nearest available phone.")}},children:"CALL 911 NOW"}),l.jsx("p",{className:"text-center text-sm font-bold opacity-80",children:"If you cannot call, continue filling this form."})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700",children:f("help.location")}),Q&&l.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-green-600 bg-green-50 px-2 py-0.5 rounded border border-green-100 animate-pulse",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})," LIVE TRACKING"]}),se&&l.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-100",children:[l.jsx(S,{size:10})," APPROX (IP)"]})]}),l.jsx(h,{placeholder:f(Q?"help.detecting":"help.manual"),value:o.location||"",onChange:e=>{Z(!1),ae(!1),ue(null),ve({location:e.target.value})},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),je())},className:"bg-white font-mono text-sm border-slate-300 text-slate-900 font-semibold pr-24 "+(Q?"border-brand-500 ring-1 ring-brand-500":se?"border-amber-500 ring-1 ring-amber-500":X?"border-red-500":""),error:Q||se||o.location||!Y||X?void 0:Y}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsxs("button",{type:"button",onClick:()=>{je()},disabled:me||!String(o.location||"").trim(),className:"inline-flex items-center gap-2 text-xs font-bold text-brand-700 bg-brand-50 hover:bg-brand-100 px-3 py-1.5 rounded-full",children:[me?l.jsx(y,{size:12,className:"animate-spin"}):l.jsx(z,{size:12})," ",me?"Searchingâ€¦":"Search Map"]}),l.jsxs("button",{type:"button",onClick:()=>{de(e=>!e),Z(!1),ae(!1)},className:"inline-flex items-center gap-2 text-xs font-bold text-slate-700 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full",children:[l.jsx(C,{size:12})," ",ce?"Hide Map":"Drop a Pin"]}),l.jsxs("button",{type:"button",onClick:()=>{Z(!0),de(!1)},className:"inline-flex items-center gap-2 text-xs font-bold text-brand-700 bg-brand-50 hover:bg-brand-100 px-3 py-1.5 rounded-full",children:[l.jsx(R,{size:12})," Use GPS"]})]})]}),ce&&l.jsxs("div",{className:"mt-3 rounded-xl overflow-hidden border border-slate-200 shadow-sm",children:[l.jsxs("div",{className:"bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-600 flex items-center gap-2",children:[l.jsx(C,{size:12})," Tap the map to set your exact location"]}),l.jsx("div",{className:"h-64 w-full",children:l.jsxs(u,{center:[Ne.lat,Ne.lng],zoom:14,scrollWheelZoom:!0,className:"h-full w-full",children:[l.jsx(m,{attribution:"Â© OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),l.jsx(U,{marker:xe,onPick:e=>{Z(!1),ae(!1),ue(e);const t=`${e.lat.toFixed(6)}, ${e.lng.toFixed(6)}`;ve({location:t}),_(null),te((new Date).toLocaleTimeString()),W(null)}})]})})]}),Q&&null!==$&&l.jsxs("div",{className:"bg-slate-100 rounded-lg p-3 border border-slate-200 -mt-2 shadow-inner",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[(e=>{let t=0,s="bg-slate-300";return e<=15?(t=4,s="bg-green-500"):e<=30?(t=3,s="bg-green-500"):e<=60?(t=2,s="bg-yellow-500"):(t=1,s="bg-red-500"),l.jsxs("div",{className:"flex items-end gap-1 h-3",role:"img","aria-label":`GPS Signal Strength: ${t} of 4 bars`,children:[l.jsx("div",{className:`w-1 rounded-sm ${t>=1?s:"bg-slate-200"} h-1.5`}),l.jsx("div",{className:`w-1 rounded-sm ${t>=2?s:"bg-slate-200"} h-2`}),l.jsx("div",{className:`w-1 rounded-sm ${t>=3?s:"bg-slate-200"} h-2.5`}),l.jsx("div",{className:`w-1 rounded-sm ${t>=4?s:"bg-slate-200"} h-3`})]})})($),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-700 uppercase tracking-wider leading-none mb-0.5",children:(ke=$,ke?ke<=15?"Excellent Signal":ke<=30?"Good Signal":ke<=60?"Fair Signal":"Weak Signal":"")}),l.jsxs("p",{className:"text-xs text-slate-500 font-mono leading-none",children:["Â± ",$,"m precision"]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"flex items-center gap-1 justify-end text-[10px] text-slate-400 font-bold uppercase mb-0.5",children:[l.jsx(T,{size:10})," Last Update"]}),l.jsx("p",{className:"text-xs text-slate-600 font-mono font-bold leading-none",children:ee})]})]}),$>50&&l.jsxs("div",{className:"flex items-center gap-1.5 mt-2 bg-amber-50 p-1.5 rounded border border-amber-100",children:[l.jsx(M,{size:12,className:"text-amber-600"}),l.jsx("p",{className:"text-[10px] text-amber-700 font-bold",children:"Signal weak. Move outdoors or near windows for better precision."})]})]}),Q&&!Y&&null===$&&!se&&l.jsxs("p",{className:"text-xs text-brand-600 font-medium -mt-2 animate-pulse flex items-center gap-1",children:[l.jsx(y,{size:12,className:"animate-spin"})," Acquiring satellite lock..."]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-xl font-bold text-slate-900",children:f("help.what_need")}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"Medical",icon:l.jsx(t,{size:24}),color:"red"},{id:"Fire",icon:l.jsx(D,{size:24}),color:"orange"},{id:"Flood",icon:l.jsx(E,{size:24}),color:"blue"},{id:"Police",icon:l.jsx(L,{size:24}),color:"slate"}].map(e=>l.jsxs("button",{onClick:()=>ve({emergencyType:e.id}),className:"p-4 rounded-xl border flex flex-col items-center gap-2 transition-all "+(o.emergencyType===e.id?`border-${e.color}-600 bg-${e.color}-50 text-${e.color}-900 ring-2 ring-${e.color}-600 ring-offset-1`:"border-slate-300 bg-white text-slate-700 hover:border-slate-400"),children:[e.icon,l.jsx("span",{className:"font-bold text-lg",children:e.id})]},e.id))})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-xl font-bold text-slate-900",children:f("help.injured_q")}),l.jsx("div",{className:"flex gap-4",children:["Yes","No"].map(e=>{const t="Yes"===e;return l.jsx(g,{type:"button",variant:o.isInjured===t?"primary":"outline",onClick:()=>ve({isInjured:t}),className:"flex-1 font-bold "+(o.isInjured!==t?"border-slate-300 text-slate-700":""),children:"Yes"===e?"Yes":"No"},e)})})]})]}),2===s&&l.jsxs("div",{className:"space-y-6",children:[l.jsx(p,{label:f("help.situation"),placeholder:"E.g. Water is rising rapidly, trapped in attic...",value:o.situationDescription,onChange:e=>ve({situationDescription:e.target.value}),className:"border-slate-300 text-slate-900"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-lg font-bold text-slate-900",children:f("help.evac_q")}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(g,{variant:!0===o.canEvacuate?"primary":"outline",onClick:()=>ve({canEvacuate:!0}),className:"flex-1 font-bold",children:"Yes"}),l.jsx(g,{variant:!1===o.canEvacuate?"danger":"outline",onClick:()=>ve({canEvacuate:!1}),className:"flex-1 font-bold",children:"No"})]})]}),l.jsx(h,{type:"number",label:f("help.people_count"),min:1,value:o.peopleCount,onChange:e=>ve({peopleCount:parseInt(e.target.value)}),className:"border-slate-300 text-slate-900 font-bold"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-lg font-bold text-slate-900",children:f("help.pets_q")}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(g,{variant:!0===o.petsPresent?"primary":"outline",onClick:()=>ve({petsPresent:!0}),className:"flex-1 font-bold",children:"Yes"}),l.jsx(g,{variant:!1===o.petsPresent?"secondary":"outline",onClick:()=>ve({petsPresent:!1}),className:"flex-1 font-bold",children:"No"})]})]})]}),3===s&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:f("help.resources_title")}),l.jsx("p",{className:"text-slate-600 font-medium text-base",children:f("help.resources_desc")}),[{key:"hasWater",label:"Clean Water",icon:l.jsx(E,{size:18})},{key:"hasFood",label:"Food",icon:l.jsx("span",{className:"text-lg",children:"ðŸ¥«"})},{key:"hasMeds",label:"Medications",icon:l.jsx("span",{className:"text-lg",children:"ðŸ’Š"})},{key:"hasPower",label:"Electricity",icon:l.jsx(I,{size:18})},{key:"hasPhone",label:"Phone Service",icon:l.jsx("span",{className:"text-lg",children:"ðŸ“¶"})}].map(e=>l.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border border-slate-300 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-slate-100 rounded-lg text-slate-700",children:e.icon}),l.jsx("span",{className:"font-bold text-slate-900",children:e.label})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>ve({[e.key]:!0}),className:"px-4 py-2 rounded-lg text-sm font-bold transition-colors "+(!0===o[e.key]?"bg-green-100 text-green-800 border border-green-200":"bg-slate-100 text-slate-500 border border-slate-200"),children:"Yes"}),l.jsx("button",{onClick:()=>ve({[e.key]:!1}),className:"px-4 py-2 rounded-lg text-sm font-bold transition-colors "+(!1===o[e.key]?"bg-red-100 text-red-800 border border-red-200":"bg-slate-100 text-slate-500 border border-slate-200"),children:"No"})]})]},e.key))]}),4===s&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-lg font-bold text-slate-900",children:f("help.vuln_title")}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:["Elderly","Infants","Disabled","Pregnant"].map(e=>l.jsx("button",{onClick:()=>{const t=o.vulnerableGroups,s=t.includes(e)?t.filter(t=>t!==e):[...t,e];ve({vulnerableGroups:s})},className:"p-3 rounded-lg border text-sm font-bold transition-all "+(o.vulnerableGroups.includes(e)?"bg-brand-50 border-brand-500 text-brand-800":"bg-white border-slate-300 text-slate-600"),children:e},e))})]}),l.jsx(p,{label:f("help.medical_cond"),placeholder:"Diabetes, requires dialysis, wheelchair user...",value:o.medicalConditions,onChange:e=>ve({medicalConditions:e.target.value}),className:"border-slate-300"})]}),5===s&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:f("help.review")}),l.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-4 space-y-4 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-slate-600 font-medium",children:"Emergency Type"}),l.jsx("span",{className:"font-bold text-slate-900",children:o.emergencyType||"Not specified"})]}),l.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-slate-600 font-medium",children:"People Count"}),l.jsx("span",{className:"font-bold text-slate-900",children:o.peopleCount})]}),l.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-slate-600 font-medium",children:"Injuries"}),l.jsx("span",{className:"font-bold text-slate-900",children:o.isInjured?"Yes":"No"})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-slate-600 font-medium",children:"Location"}),l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"block font-bold truncate max-w-[150px] font-mono text-xs text-slate-900",children:o.location||"Pending..."}),Q?l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsxs("span",{className:"text-[10px] text-green-700 font-bold flex items-center justify-end gap-1",children:[l.jsx(y,{size:10,className:"animate-spin"})," Live"]}),$&&l.jsxs("span",{className:"text-[10px] text-slate-500 font-mono",children:["Â±",$,"m"]})]}):se?l.jsxs("span",{className:"text-[10px] text-amber-600 font-bold flex items-center justify-end gap-1",children:[l.jsx(S,{size:10})," Network (Approx)"]}):l.jsxs("span",{className:"text-[10px] text-slate-500 font-bold flex items-center justify-end gap-1",children:[l.jsx(C,{size:10})," Manual/Frozen"]})]})]})]})]})]}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-slate-200 z-30",children:l.jsx("div",{className:"max-w-md mx-auto flex gap-4",children:s<5?l.jsx(g,{fullWidth:!0,onClick:()=>r(e=>Math.min(e+1,5)),size:"lg",className:"font-bold text-lg",children:f("btn.next")}):l.jsx(g,{fullWidth:!0,size:"lg",disabled:d,onClick:async()=>{x(!0);const e=n.getLastKnownLocation(),t=o.location||(null==e?void 0:e.location)||"";t&&!o.location&&c(e=>({...e,location:t}));try{const e=await n.submitRequest({...o,location:t});V(e.id),o.emergencyContactPhone&&(H("sending"),i({contactName:o.emergencyContactName,contactPhone:o.emergencyContactPhone,userName:o.fullName,emergencyType:o.emergencyType,description:o.situationDescription,location:t,requestId:e.id}).then(()=>H("sent")).catch(e=>{console.warn("Emergency contact notify failed",e),H("failed")})),B(!0)}catch(s){console.error(s),alert("Failed to submit request. Saved locally; will retry when online.")}finally{x(!1)}},className:"bg-red-600 hover:bg-red-700 font-bold text-lg shadow-lg shadow-red-200",children:d?le?"Saving...":"Sending...":le?"Save for Sync":f("help.submit_btn")})})})]});var ke})}}});
