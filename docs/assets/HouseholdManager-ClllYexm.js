import{c as u,r as h,j as l,L as N,M as F,i as y,N as C,O as $}from"./index-CJzEU5Yr.js";import{B as g}from"./Button-CnRUMJhP.js";import{I as r}from"./Input-BlISMA55.js";import{X as I}from"./x-pd8-DY5F.js";import{S as A}from"./save-CJzrS06H.js";import{U as z}from"./user-jnEtzzBn.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],L=u("pen",B);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_=u("plus",S);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],H=u("trash-2",G),W=({members:o,onChange:x,readOnly:m=!1,latestSafetyStatusByMember:i={}})=>{const[M,d]=h.useState(!1),[b,n]=h.useState(null),[a,t]=h.useState({id:"",name:"",age:"",needs:"",mobilityFlag:!1,medicalFlag:!1,loginEnabled:!1,loginPhone:""}),p=e=>{const s=C(e).slice(0,15);return s.length<=10?s.length<4?s:s.length<7?"(".concat(s.slice(0,3),") ").concat(s.slice(3)):"(".concat(s.slice(0,3),") ").concat(s.slice(3,6),"-").concat(s.slice(6,10)):"+".concat(s)},E=()=>{t({id:Date.now().toString(),name:"",age:"",needs:"",mobilityFlag:!1,medicalFlag:!1,loginEnabled:!1,loginPhone:""}),n(null),d(!0)},k=e=>{t({...e,mobilityFlag:!!e.mobilityFlag,medicalFlag:!!e.medicalFlag,loginEnabled:!!e.loginEnabled,loginPhone:e.loginPhone||""}),n(null),d(!0)},P=e=>{confirm("Remove this member?")&&x(o.filter(s=>s.id!==e))},D=()=>{const e=a.name.trim(),s=String(a.age||"").trim();if(!e){n("Name is required.");return}if(!N(s)||F(s)===null){n("Date of birth is required in MM/DD/YYYY format.");return}if(a.loginEnabled&&!y(a.loginPhone||"")){n("A valid member phone is required to enable account invites.");return}const f=$(s),Y=["INFANT","CHILD","SENIOR"].includes(f),v={...a,name:e,age:s,ageGroup:f,mobilityFlag:!!a.mobilityFlag||Y,medicalFlag:!!a.medicalFlag,loginPhone:a.loginEnabled?p(a.loginPhone||""):""},j=o.findIndex(w=>w.id===a.id);let c=[...o];j>=0?c[j]=v:c.push(v),x(c),n(null),d(!1)};return M?l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 shadow-sm animate-fade-in",children:[l.jsxs("h4",{className:"font-bold text-slate-900 mb-3 flex items-center justify-between",children:[l.jsx("span",{children:o.some(e=>e.id===a.id)?"Edit Member":"Add Family Member"}),l.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-600",children:l.jsx(I,{size:20})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(r,{label:"Name",placeholder:"e.g. Sarah Jones",value:a.name,onChange:e=>t({...a,name:e.target.value}),autoFocus:!0}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx(r,{label:"Date of Birth",placeholder:"MM/DD/YYYY",value:a.age,onChange:e=>t({...a,age:e.target.value}),error:a.age&&(!N(a.age)||F(a.age)===null)?"Use MM/DD/YYYY":void 0}),l.jsx(r,{label:"Medical/Needs",placeholder:"Optional",value:a.needs,onChange:e=>t({...a,needs:e.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Mobility Flag"}),l.jsxs("select",{value:String(!!a.mobilityFlag),onChange:e=>t({...a,mobilityFlag:e.target.value==="true"}),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-slate-900",children:[l.jsx("option",{value:"true",children:"Yes"}),l.jsx("option",{value:"false",children:"No"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Medical Flag"}),l.jsxs("select",{value:String(!!a.medicalFlag),onChange:e=>t({...a,medicalFlag:e.target.value==="true"}),className:"w-full px-4 py-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-slate-900",children:[l.jsx("option",{value:"true",children:"Yes"}),l.jsx("option",{value:"false",children:"No"})]})]})]}),l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Allow account invite (optional)"}),l.jsx("input",{type:"checkbox",checked:!!a.loginEnabled,onChange:e=>t({...a,loginEnabled:e.target.checked})})]}),l.jsx("p",{className:"text-xs text-slate-500 -mt-1",children:"This does not create an account. It only enables invite-code access for this person."}),a.loginEnabled&&l.jsx(r,{label:"Member Mobile Phone *",placeholder:"(555) 123-4567",value:a.loginPhone||"",onChange:e=>t({...a,loginPhone:p(e.target.value)}),error:a.loginPhone&&!y(a.loginPhone)?"Enter a valid phone number":void 0}),b&&l.jsx("p",{className:"text-xs text-red-600 font-semibold",children:b}),l.jsxs("div",{className:"flex gap-2 pt-2",children:[l.jsx(g,{variant:"ghost",fullWidth:!0,onClick:()=>{d(!1),n(null)},children:"Cancel"}),l.jsxs(g,{fullWidth:!0,onClick:D,children:[l.jsx(A,{size:16,className:"mr-2"})," Save Member"]})]})]})]}):l.jsxs("div",{className:"space-y-3",children:[o.length>0?l.jsx("div",{className:"grid gap-2",children:o.map(e=>l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-3 flex items-center justify-between shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500",children:l.jsx(z,{size:20})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-slate-900 leading-tight",children:e.name}),l.jsxs("p",{className:"text-xs text-slate-500",children:["DOB: ",e.age||"N/A",typeof e.mobilityFlag=="boolean"&&" • Mobility: ".concat(e.mobilityFlag?"Yes":"No"),typeof e.medicalFlag=="boolean"&&" • Medical: ".concat(e.medicalFlag?"Yes":"No")," • Account Invite: ".concat(e.loginEnabled?"Enabled":"Not enabled"),e.loginEnabled&&e.loginPhone&&" • ".concat(e.loginPhone),e.needs&&" • ".concat(e.needs)]}),i[e.id]&&l.jsxs("p",{className:"text-[11px] mt-0.5 font-semibold ".concat(i[e.id].status==="DANGER"?"text-red-700":"text-emerald-700"),children:["Latest safety status: ",i[e.id].status,i[e.id].at?" • ".concat(new Date(i[e.id].at).toLocaleString()):""]})]})]}),!m&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>k(e),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:l.jsx(L,{size:16})}),l.jsx("button",{onClick:()=>P(e.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:l.jsx(H,{size:16})})]})]},e.id))}):l.jsx("div",{className:"text-center p-4 bg-slate-50 rounded-xl border border-dashed border-slate-300 text-slate-500 text-sm",children:"No household members added yet."}),!m&&l.jsxs(g,{variant:"outline",fullWidth:!0,onClick:E,className:"border-dashed border-slate-300 text-slate-600 hover:border-brand-400 hover:text-brand-600",children:[l.jsx(_,{size:18,className:"mr-2"})," Add Member"]})]})};export{W as H};
