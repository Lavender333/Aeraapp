System.register(["./index-legacy-BC6n9_Fz.js","./Input-legacy-CRMIvJst.js","./Button-legacy-TMRSLogx.js","./HouseholdManager-legacy-zKvgXL4u.js","./check-legacy-DLUJwLJ_.js","./supabaseClient-legacy-pWCzIYjf.js","./translations-legacy-DOH-4GSU.js","./x-legacy-D0EAXDA5.js","./arrow-left-legacy-BfJ5XQeX.js","./download-legacy-Cwz6pGl-.js","./circle-check-big-legacy-23eE6yZJ.js","./users-legacy-Bc8dh8j6.js","./copy-legacy-DLN675EY.js","./shield-check-legacy-BuurCFgo.js","./map-pin-legacy-BaIHUmhS.js","./user-legacy-DpSAeiIv.js","./truck-legacy-BDfZ0TYX.js","./mail-legacy-DYrj02mw.js","./phone-legacy-TugBlRgH.js","./search-legacy-HmYGdmWk.js","./building-2-legacy-KsCxgVJv.js","./radio-legacy-BScQ_r6c.js","./save-legacy-BwNvDHpS.js","./globe-legacy-rEOerVk_.js","./lock-legacy-DAAs0KgB.js","./file-text-legacy-CSlIR_5z.js","./loader-circle-legacy-DJmawYAc.js"],function(e,s){"use strict";var t,a,l,r,n,i,d,o,c,x,m,h,p,b,u,g,j,N,f,v,y,w,C,k,S,I,A,D,z,R,P,E,L,M,O,U,T,V,_,B,q,$,F,Y,G,H,W,J,Q,Z,X,K;return{setters:[e=>{t=e.c,a=e.r,l=e.j,r=e.S,n=e.i,i=e.f,d=e.e,o=e.h,c=e.k,x=e.l,m=e.m,h=e.o,p=e.p,b=e.u,u=e.q,g=e.s,j=e.t,N=e.v,f=e.w,v=e.x,y=e.y,w=e.d},e=>{C=e.T,k=e.I},e=>{S=e.B},e=>{I=e.H},e=>{A=e.C},e=>{D=e.s},e=>{z=e.t},e=>{R=e.X},e=>{P=e.A},e=>{E=e.D},e=>{L=e.C},e=>{M=e.A,O=e.U},e=>{U=e.C},e=>{T=e.S},e=>{V=e.M},e=>{_=e.U},e=>{B=e.T},e=>{q=e.M},e=>{$=e.P},e=>{F=e.S},e=>{Y=e.B},e=>{G=e.A,H=e.R},e=>{W=e.H,J=e.S},e=>{Q=e.G},e=>{Z=e.L},e=>{X=e.F},e=>{K=e.L}],execute:function(){
/**
       * @license lucide-react v0.556.0 - ISC
       *
       * This source code is licensed under the ISC license.
       * See the LICENSE file in the root directory of this source tree.
       */
const s=t("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ee=t("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),se=t("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),te=t("eraser",[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]]),ae=t("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),le=t("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),re=t("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),ne=t("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),ie=t("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),de=t("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),oe=({onSave:e,className:s})=>{const t=a.useRef(null),[r,n]=a.useState(!1),[i,d]=a.useState(!1);a.useEffect(()=>{const e=t.current;if(e){const s=e.getBoundingClientRect();e.width=s.width,e.height=s.height;const t=e.getContext("2d");t&&(t.lineWidth=2,t.lineCap="round",t.strokeStyle="#000")}},[]);const o=e=>{const s=t.current;if(!s)return{x:0,y:0};const a=s.getBoundingClientRect();let l,r;return"touches"in e?(l=e.touches[0].clientX,r=e.touches[0].clientY):(l=e.clientX,r=e.clientY),{x:l-a.left,y:r-a.top}},c=e=>{var s;e.preventDefault(),n(!0);const a=null===(s=t.current)||void 0===s?void 0:s.getContext("2d");if(a){const{x:s,y:t}=o(e);a.beginPath(),a.moveTo(s,t)}},x=e=>{var s;if(!r)return;e.preventDefault();const a=null===(s=t.current)||void 0===s?void 0:s.getContext("2d");if(a){const{x:s,y:t}=o(e);a.lineTo(s,t),a.stroke(),d(!0)}},m=()=>{n(!1)};return l.jsxs("div",{className:`space-y-3 ${s}`,children:[l.jsxs("div",{className:"border-2 border-slate-300 rounded-xl overflow-hidden bg-white shadow-inner relative",children:[l.jsx("canvas",{ref:t,className:"w-full h-40 touch-none cursor-crosshair block",onMouseDown:c,onMouseMove:x,onMouseUp:m,onMouseLeave:m,onTouchStart:c,onTouchMove:x,onTouchEnd:m}),l.jsx("div",{className:"absolute bottom-2 left-4 text-xs text-slate-300 pointer-events-none font-bold uppercase select-none",children:"Sign Here"})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(S,{variant:"outline",onClick:()=>{const e=t.current,s=null==e?void 0:e.getContext("2d");e&&s&&(s.clearRect(0,0,e.width,e.height),d(!1))},size:"sm",className:"flex-1 text-slate-500 border-slate-300",children:[l.jsx(te,{size:16,className:"mr-2"})," Clear"]}),l.jsxs(S,{onClick:()=>{if(t.current){const s=t.current.toDataURL("image/png");e(s)}},size:"sm",disabled:!i,className:"flex-1 font-bold bg-blue-600 hover:bg-blue-700 text-white",children:[l.jsx(A,{size:16,className:"mr-2"})," Apply Signature"]})]})]})},ce=e=>{if(!e)return e;const s=e.replace(/[^\d]/g,""),t=s.length;return t<4?s:t<7?`(${s.slice(0,3)}) ${s.slice(3)}`:`(${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6,10)}`},xe=e=>{const s=String(e||"").toUpperCase().replace(/[–—−]/g,"-").replace(/[^A-Z0-9-]/g,"").replace(/-+/g,"-");return s.length<=2||s.includes("-")?s:`${s.slice(0,2)}-${s.slice(2)}`},me=e=>{const s=String(e||"").replace(/\D/g,"");return s.length<4?e:`***-***-${s.slice(-4)}`},he=[{id:"ADMIN",label:"Administrator",description:"Full system access and user management.",permissions:{canViewPII:!0,canDispatchDrone:!0,canApproveFunds:!0,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"FIRST_RESPONDER",label:"First Responder",description:"Field access to location data and medical info.",permissions:{canViewPII:!0,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"LOCAL_AUTHORITY",label:"Local Authority",description:"Oversight of alerts and population tracking.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!0,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"CONTRACTOR",label:"Contractor",description:"Logistics and repair management.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!1}},{id:"INSTITUTION_ADMIN",label:"Institution Admin",description:"Manage community members and hub inventory.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"GENERAL_USER",label:"General User",description:"Standard access to report emergencies.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!1}}];e("SettingsView",({setView:e})=>{const t=void 0,te=a.useRef(null),[pe,be]=a.useState({id:"",fullName:"",phone:"",address:"",householdMembers:1,household:[],zipCode:"",petDetails:"",medicalNeeds:"",medicationDependency:!1,insulinDependency:!1,oxygenPoweredDevice:!1,mobilityLimitation:!1,transportationAccess:!0,financialStrain:!1,consentPreparednessPlanning:!1,emergencyContactName:"",emergencyContactPhone:"",emergencyContactRelation:"",communityId:"",role:"GENERAL_USER",language:"en",active:!0,notifications:{push:!0,sms:!0,email:!0}}),ue=String(pe.role||"").toUpperCase(),ge=["ADMIN","STATE_ADMIN","COUNTY_ADMIN","ORG_ADMIN","INSTITUTION_ADMIN"].includes(ue),je=String(pe.address||"").trim().length>0&&Boolean(t)&&!pe.addressVerified,Ne=pe.addressVerifiedAt?new Date(pe.addressVerifiedAt).toLocaleString():null,[fe,ve]=a.useState("MAIN"),[ye,we]=a.useState(!1),[Ce,ke]=a.useState(!1),[Se,Ie]=a.useState(null),[Ae,De]=a.useState(null),[ze,Re]=a.useState(!1),[Pe,Ee]=a.useState(null),[Le,Me]=a.useState("IDLE"),[Oe,Ue]=a.useState([]),[Te,Ve]=a.useState(!1),[_e,Be]=a.useState(-1),[qe,$e]=a.useState("ALL_USERS"),[Fe,Ye]=a.useState(()=>r.getRoles()||he),[Ge,He]=a.useState([]),[We,Je]=a.useState(""),[Qe,Ze]=a.useState(null),[Xe,Ke]=a.useState(null),[es,ss]=a.useState([]),[ts,as]=a.useState(""),[ls,rs]=a.useState(null),[ns,is]=a.useState([]),[ds,os]=a.useState(!1),[cs,xs]=a.useState([]),[ms,hs]=a.useState(null),[ps,bs]=a.useState({}),[us,gs]=a.useState(!1),[js,Ns]=a.useState(!1),[fs,vs]=a.useState(null),[ys,ws]=a.useState(null),[Cs,ks]=a.useState(""),[Ss,Is]=a.useState(null),[As,Ds]=a.useState(null),[zs,Rs]=a.useState(!1),[Ps,Es]=a.useState([]),[Ls,Ms]=a.useState(null),[Os,Us]=a.useState(null),[Ts,Vs]=a.useState(null),[_s,Bs]=a.useState([]),[qs,$s]=a.useState([]),[Fs,Ys]=a.useState([]),[Gs,Hs]=a.useState(null),[Ws,Js]=a.useState(!1),[Qs,Zs]=a.useState(""),Xs=e=>{be(s=>({...s,householdId:e.householdId,householdCode:e.householdCode,householdName:e.householdName,householdRole:e.householdRole}));const s=r.getProfile();r.saveProfile({...s,householdId:e.householdId,householdCode:e.householdCode,householdName:e.householdName,householdRole:e.householdRole})};a.useEffect(()=>{const e=r.getProfile();if(e.role||(e.role="GENERAL_USER"),e.language||(e.language="en"),void 0===e.active&&(e.active=!0),e.household||(e.household=[]),"string"!=typeof e.zipCode&&(e.zipCode=""),"boolean"!=typeof e.medicationDependency&&(e.medicationDependency=!1),"boolean"!=typeof e.insulinDependency&&(e.insulinDependency=!1),"boolean"!=typeof e.oxygenPoweredDevice&&(e.oxygenPoweredDevice=!1),"boolean"!=typeof e.mobilityLimitation&&(e.mobilityLimitation=!1),"boolean"!=typeof e.transportationAccess&&(e.transportationAccess=!0),"boolean"!=typeof e.financialStrain&&(e.financialStrain=!1),"boolean"!=typeof e.consentPreparednessPlanning&&(e.consentPreparednessPlanning=!1),be(e),e.addressVerified?Me("VALID"):e.address&&e.address.length>5&&Me("IDLE"),e.communityId&&"INSTITUTION_ADMIN"!==e.role){const s=r.getOrganization(e.communityId);s&&Ie(s.name)}},[]),a.useEffect(()=>{let e=!0;return(async()=>{try{const[s,t]=await Promise.all([i(),d()]);if(!e)return;if(s||t){const e={...r.getProfile(),...s||{},...t||{}};r.saveProfile(e),be(e),Me(e.addressVerified?"VALID":"IDLE")}const a=await o();if(!e)return;if(a)Xs(a);else{const s=await c();if(!e)return;Xs(s)}}catch{}})(),()=>{e=!1}},[]),a.useEffect(()=>{ge||"MAIN"===fe||ve("MAIN")},[ge,fe]),a.useEffect(()=>{if("TRUSTED_COMMUNITY"!==sessionStorage.getItem("settingsScrollTarget"))return;const e=window.setTimeout(()=>{var e;null===(e=te.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"}),sessionStorage.removeItem("settingsScrollTarget")},150);return()=>window.clearTimeout(e)},[]),a.useEffect(()=>{const e=Array.isArray(pe.household)?pe.household.length:0;e>0&&pe.householdMembers!==e&&be(s=>({...s,householdMembers:e}))},[pe.household,pe.householdMembers]),a.useEffect(()=>{let e=!0;return(async()=>{if(pe.householdId)try{const s=await x();e&&Es(s)}catch{e&&Es([])}else Es([])})(),()=>{e=!1}},[pe.householdId]),a.useEffect(()=>{let e=!0;return(async()=>{pe.householdId||(Bs([]),$s([]));try{const[s,t]=await Promise.all([m(),h()]);if(!e)return;Bs(s),$s(t)}catch{if(!e)return;Bs([]),$s([])}try{const s=await p(50);e&&Ys(s)}catch{e&&Ys([])}})(),()=>{e=!1}},[pe.householdId,pe.householdRole]),a.useEffect(()=>{let e=null,s=!0;return(async()=>{try{e=await(async e=>{const s=D.channel("notifications").on("postgres_changes",{event:"*",schema:"public",table:"notifications"},s=>e(s)).subscribe();return()=>{D.removeChannel(s)}})(async()=>{if(s)try{const[e,t,a]=await Promise.all([p(50),m(),h()]);if(!s)return;Ys(e),Bs(t),$s(a)}catch{}})}catch{e=null}})(),()=>{s=!1,e&&e()}},[]),a.useEffect(()=>{if(ls){const e=r.getOrgMembers(ls.id);is(e),r.fetchOrgMembersRemote(ls.id).then(({members:e,fromCache:s})=>{is(e),os(s)}).catch(()=>os(!0))}else is([])},[ls]);const Ks=e=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(e)?(Ee(null),!0):(Ee("Invalid format. Use 555-123-4567"),!1),et=async e=>{};a.useEffect(()=>(String(pe.address||"").trim(),Ue([]),void Be(-1)),[pe.address,pe.addressVerified,t]);const st=async e=>{var s;(null!==(s=null!=e?e:pe.address)&&void 0!==s?s:"").trim().length,Me("IDLE")},tt=(e,s)=>{be(t=>{const a={...t,[e]:s};return"address"===e&&(a.addressVerified=!1,a.addressVerifiedAt=void 0,a.googlePlaceId=void 0,a.latitude=void 0,a.longitude=void 0,a.addressLine1=void 0,a.addressLine2=void 0,a.city=void 0,a.state=void 0),a}),"communityId"===e&&(Ie(null),De(null)),"address"===e&&(Me("IDLE"),Ue([]),Be(-1),vs(null))},at=async()=>{const e=String(pe.communityId||"").trim().replace(/[–—−]/g,"-").replace(/\s+/g,"").toUpperCase();if(e){ke(!0),De(null),Ie(null);try{const s=r.getOrganization(e),t=s?{orgCode:e,orgName:s.name}:await w(e);if(!t)return void De("Invalid Community ID");const a=t.orgName||(null==s?void 0:s.name)||e,l={...pe,communityId:e};be(l),r.saveProfile(l),Ie(a);try{await b({fullName:l.fullName,phone:l.phone,email:l.email,address:l.address,addressLine1:l.addressLine1,addressLine2:l.addressLine2,city:l.city,state:l.state,zip:l.zipCode,latitude:l.latitude,longitude:l.longitude,googlePlaceId:l.googlePlaceId,addressVerified:Boolean(l.addressVerified),addressVerifiedAt:l.addressVerifiedAt,emergencyContactName:l.emergencyContactName,emergencyContactPhone:l.emergencyContactPhone,emergencyContactRelation:l.emergencyContactRelation,communityId:e,role:l.role})}catch{}}catch{De("Unable to verify Community ID right now. Please try again.")}finally{ke(!1)}}},lt=e=>{navigator.clipboard.writeText(e),alert("Copied to clipboard")},rt=e=>{const s=(pe.householdCode||"").trim().toUpperCase(),t=(e.id||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(-3),a=((e.name||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(0,3)||t||"MEM").padEnd(3,"X").slice(0,3);return s?`${s}-${a}`:a},nt=(pe.household||[]).filter(e=>e.loginEnabled),it=a.useMemo(()=>{const e={};return Ps.forEach(s=>{s.inviteeMemberRef&&(e[s.inviteeMemberRef]||(e[s.inviteeMemberRef]=s))}),e},[Ps]),dt=a.useMemo(()=>_s.filter(e=>"pending"===e.status),[_s]),ot=a.useMemo(()=>qs[0]||null,[qs]),ct=a.useMemo(()=>Fs.filter(e=>!e.read).length,[Fs]),xt=async(e,s)=>{Is(null),Ds(null),Hs(e.id);try{await g(e.id,s);const[t,a,l]=await Promise.all([m(),h(),p(50)]);Bs(t),$s(a),Ys(l),Ds("approved"===s?"Connection successful. This member has been added.":"Request rejected.")}catch(t){Is((null==t?void 0:t.message)||"Unable to resolve request right now.")}finally{Hs(null)}},mt=()=>{const e=Ge.map(e=>[e.id,`"${e.fullName.replace(/"/g,'""')}"`,e.phone,e.role,e.active?"Active":"Inactive",`"${e.address.replace(/"/g,'""')}"`,e.communityId||"N/A",e.householdMembers]),s=[["ID","Name","Phone","Role","Status","Address","Community ID","Household Size"].join(","),...e.map(e=>e.join(","))].join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.setAttribute("download",`AERA_User_Directory_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},ht=()=>{r.updateSystemTicker(Qs),alert("Global System Alert Updated")},pt=e=>{be(s=>{const t={...s,language:e};return r.saveProfile(t),t}),we(!0),setTimeout(()=>we(!1),1e3)},bt=e=>{bs({}),hs(e)},ut=(e,s)=>{bs(t=>({...t,[e]:s}))},gt=(e,s)=>{if(ms){r.signReplenishmentRequest(ms.id,e,s);const t={...ms};"RELEASE"===s?(t.signature=e,t.signedAt=(new Date).toISOString()):(t.receivedSignature=e,t.receivedAt=(new Date).toISOString()),hs(t),xs(e=>e.map(e=>e.id===ms.id?t:e))}},jt=()=>{const e=cs.map(e=>[e.id,`"${e.orgName.replace(/"/g,'""')}"`,e.orgId,`"${e.item.replace(/"/g,'""')}"`,e.quantity,e.status,new Date(e.timestamp).toLocaleDateString(),`"${e.provider.replace(/"/g,'""')}"`,e.signature?"Yes":"No",e.receivedSignature?"Yes":"No"]),s=[["Request ID","Org Name","Org ID","Item","Quantity","Status","Date","Provider","Released","Received"].join(","),...e.map(e=>e.join(","))].join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.setAttribute("download",`AERA_Master_Inventory_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},Nt=()=>{const e=cs.reduce((e,s)=>(e[s.item]=(e[s.item]||0)+s.quantity,e),{}),s=Object.entries(e).map(([e,s])=>[`"${e.replace(/"/g,'""')}"`,s]),t=[["Item Name","Total Quantity"].join(","),...s.map(e=>e.join(","))].join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(a),r=document.createElement("a");r.href=l,r.setAttribute("download",`AERA_Inventory_Tally_${(new Date).toISOString().split("T")[0]}.csv`),document.body.appendChild(r),r.click(),document.body.removeChild(r)};if(ms){const e=r.getOrganization(ms.orgId);return l.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto bg-white p-8 font-serif text-black animate-fade-in print:p-0 print:bg-white print:text-black print:static print:overflow-visible",children:[l.jsxs("div",{className:"fixed top-0 left-0 right-0 p-4 bg-slate-900 text-white flex justify-between items-center print:hidden shadow-lg z-50",children:[l.jsx("span",{className:"font-bold",children:"Work Order Preview"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(S,{size:"sm",className:"bg-brand-600 text-white",onClick:()=>window.print(),children:[l.jsx(ne,{size:16,className:"mr-2"})," Print Now"]}),l.jsxs(S,{size:"sm",variant:"secondary",onClick:()=>hs(null),children:[l.jsx(R,{size:16,className:"mr-2"})," Close"]})]})]}),l.jsxs("div",{className:"max-w-3xl mx-auto border border-black p-8 mt-16 print:mt-0 print:border-0 print:w-full",children:[l.jsxs("div",{className:"flex justify-between items-start border-b-2 border-black pb-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-4xl font-bold uppercase tracking-tight",children:"Work Order"}),l.jsx("p",{className:"text-sm font-bold uppercase mt-1",children:"AERA Logistics Fulfillment"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-sm",children:[l.jsx("strong",{children:"Order ID:"})," ",ms.id]}),l.jsxs("p",{className:"text-sm",children:[l.jsx("strong",{children:"Printed On:"})," ",(new Date).toLocaleDateString()]}),l.jsxs("p",{className:"text-sm",children:[l.jsx("strong",{children:"Request Date:"})," ",new Date(ms.timestamp).toLocaleDateString()]}),l.jsxs("p",{className:"text-sm",children:[l.jsx("strong",{children:"Provider:"})," ",ms.provider]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Ship To (Organization)"}),l.jsx("p",{className:"text-lg font-bold",children:ms.orgName}),l.jsx("p",{children:(null==e?void 0:e.address)||"Address Unknown"}),l.jsx("p",{children:null==e?void 0:e.adminContact}),l.jsx("p",{children:null==e?void 0:e.adminPhone}),l.jsxs("p",{className:"mt-2 text-sm font-mono",children:["ID: ",ms.orgId]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Fulfillment Instructions"}),l.jsx("p",{className:"text-sm mb-2",children:"Please pick and pack the items listed below. Ensure quality check is performed before release."}),l.jsxs("div",{className:"border border-black p-2 text-center mt-4",children:[l.jsx("p",{className:"text-xs uppercase font-bold",children:"Priority Status"}),l.jsx("p",{className:"text-xl font-bold",children:"URGENT"})]})]})]}),l.jsx("div",{className:"mb-12",children:l.jsxs("table",{className:"w-full border-collapse border border-black",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[l.jsx("th",{className:"border border-black p-2 text-left w-12 print:text-black",children:"#"}),l.jsx("th",{className:"border border-black p-2 text-left print:text-black",children:"Requested Item"}),l.jsx("th",{className:"border border-black p-2 text-center w-24 print:text-black",children:"Qty Req"}),l.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Qty Picked"}),l.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Verified"})]})}),l.jsxs("tbody",{children:[l.jsxs("tr",{children:[l.jsx("td",{className:"border border-black p-3 text-center print:text-black",children:"1"}),l.jsx("td",{className:"border border-black p-3 font-bold text-lg print:text-black",children:ms.item}),l.jsx("td",{className:"border border-black p-3 text-center font-bold text-lg print:text-black",children:ms.quantity}),l.jsx("td",{className:"border border-black p-1",children:l.jsx("input",{className:"w-full h-full text-center font-bold text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:ps.item_picked||"",onChange:e=>ut("item_picked",e.target.value)})}),l.jsx("td",{className:"border border-black p-1",children:l.jsx("input",{className:"w-full h-full text-center font-medium text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:ps.item_verified||"",onChange:e=>ut("item_verified",e.target.value)})})]}),[2,3].map(e=>l.jsxs("tr",{children:[l.jsx("td",{className:"border border-black p-3 text-center opacity-50 print:text-black",children:e}),l.jsx("td",{className:"border border-black p-2",children:l.jsxs("div",{className:"flex items-center gap-2 h-full",children:[l.jsx("span",{className:"italic text-slate-500 text-sm whitespace-nowrap print:text-black",children:"Notes/Substitutions:"}),l.jsx("input",{className:"flex-1 bg-transparent border-b border-slate-300 focus:border-blue-500 outline-none text-slate-900 print:border-none print:text-black font-mono",value:ps[`note_${e}`]||"",onChange:s=>ut(`note_${e}`,s.target.value)})]})}),l.jsx("td",{className:"border border-black p-3"}),l.jsx("td",{className:"border border-black p-3"}),l.jsx("td",{className:"border border-black p-3"})]},e))]})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-12 mt-12 pt-12",children:[l.jsxs("div",{className:"break-inside-avoid",children:[l.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Released By (Signature)"}),ms.signature?l.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[l.jsx("img",{src:ms.signature,alt:"Digital Signature",className:"h-16 mb-1"}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(ms.signedAt||"").toLocaleString()]})]}):l.jsx("div",{className:"print:hidden",children:l.jsx(oe,{onSave:e=>gt(e,"RELEASE")})}),!ms.signature&&l.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]}),l.jsxs("div",{className:"break-inside-avoid",children:[l.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Received By (Signature)"}),ms.receivedSignature?l.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[l.jsx("img",{src:ms.receivedSignature,alt:"Digital Signature",className:"h-16 mb-1"}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(ms.receivedAt||"").toLocaleString()]})]}):l.jsx("div",{className:"print:hidden",children:l.jsx(oe,{onSave:e=>gt(e,"RECEIVE")})}),!ms.receivedSignature&&l.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]})]}),l.jsx("div",{className:"text-center mt-12 text-xs text-slate-500 print:text-black",children:l.jsxs("p",{children:["Generated by AERA System • ",(new Date).toLocaleString()]})})]})]})}if("MASTER_INVENTORY"===fe){const e=cs.reduce((e,s)=>(e[s.item]=(e[s.item]||0)+s.quantity,e),{});return l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-white min-h-screen print:p-0 print:pb-0",children:[l.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-white z-10 print:hidden",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>ve("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:l.jsx(P,{size:24})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Master Inventory Database"}),l.jsx("p",{className:"text-xs text-slate-500",children:"System-Wide Supply Request Aggregation"})]})]})}),l.jsxs("div",{className:"hidden print:block mb-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"AERA Master Inventory Report"}),l.jsxs("p",{className:"text-sm text-slate-500",children:["Generated on ",(new Date).toLocaleString()]})]}),l.jsxs("div",{className:"space-y-4 print:break-inside-avoid",children:[l.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[l.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Total Tally (All Organizations)"}),l.jsxs("button",{onClick:Nt,className:"text-xs font-bold text-brand-600 hover:text-brand-700 flex items-center gap-1 print:hidden",children:[l.jsx(E,{size:14})," Export Tally CSV"]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Object.entries(e).map(([e,s])=>l.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-lg print:border-black print:bg-white print:border",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase",children:e}),l.jsx("p",{className:"text-2xl font-mono font-bold text-slate-900",children:s})]},e)),0===Object.keys(e).length&&l.jsx("p",{className:"text-slate-500 italic",children:"No requests logged."})]})]}),l.jsxs("div",{className:"space-y-4 mt-8",children:[l.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[l.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Request Log"}),l.jsxs(S,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-50 print:hidden h-8",onClick:jt,children:[l.jsx(E,{size:14,className:"mr-2"})," Export Log CSV"]})]}),l.jsx("div",{className:"overflow-x-auto print:overflow-visible",children:l.jsxs("table",{className:"w-full text-left text-sm print:text-xs",children:[l.jsx("thead",{className:"print:table-header-group",children:l.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[l.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Organization"}),l.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Item"}),l.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Qty"}),l.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Date"}),l.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Status"}),l.jsx("th",{className:"p-3 font-bold text-slate-700 print:hidden",children:"Action"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-200",children:[cs.map(e=>l.jsxs("tr",{className:"print:break-inside-avoid",children:[l.jsxs("td",{className:"p-3 font-medium text-slate-900",children:[e.orgName," ",l.jsx("span",{className:"text-xs text-slate-500 block",children:e.orgId})]}),l.jsx("td",{className:"p-3 text-slate-700",children:e.item}),l.jsx("td",{className:"p-3 font-mono font-bold text-slate-900",children:e.quantity}),l.jsx("td",{className:"p-3 text-slate-500",children:new Date(e.timestamp).toLocaleDateString()}),l.jsx("td",{className:"p-3",children:l.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold "+("FULFILLED"===e.status?"bg-green-100 text-green-700 print:border print:border-black":"bg-yellow-100 text-yellow-700 print:border print:border-black"),children:e.status})}),l.jsx("td",{className:"p-3 print:hidden",children:l.jsx("div",{className:"flex flex-col gap-2",children:"PENDING"===e.status?l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(S,{size:"sm",onClick:()=>{return s=e.id,r.updateReplenishmentRequestStatus(s,"FULFILLED"),void xs(e=>e.map(e=>e.id===s?{...e,status:"FULFILLED"}:e));var s},className:"bg-green-600 hover:bg-green-700 text-xs py-1 h-8",children:[l.jsx(de,{size:14,className:"mr-1"})," Fulfill"]}),l.jsx(S,{size:"sm",variant:"outline",onClick:()=>bt(e),className:"text-xs py-1 h-8 px-2 border-slate-300",title:e.signature?"Print Work Order":"Sign Work Order",children:e.signature&&e.receivedSignature?l.jsx(ne,{size:14}):l.jsx(re,{size:14})})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(S,{size:"sm",variant:"outline",onClick:()=>bt(e),className:"text-xs py-1 h-8 px-2 border-slate-300 mr-2",title:"View Signed Order",children:e.signature&&e.receivedSignature?l.jsx(L,{size:14,className:"text-green-600"}):l.jsx(ne,{size:14})}),l.jsxs("button",{onClick:()=>{return s=e.id,r.updateReplenishmentRequestStatus(s,"PENDING"),void xs(e=>e.map(e=>e.id===s?{...e,status:"PENDING"}:e));var s},className:"text-xs text-slate-400 hover:text-blue-600 hover:underline flex items-center gap-0.5",title:"Undo Completion",children:[l.jsx(ie,{size:10})," Undo"]})]})})})]},e.id)),0===cs.length&&l.jsx("tr",{children:l.jsx("td",{colSpan:6,className:"p-4 text-center text-slate-500",children:"No requests found."})})]})]})})]}),l.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t border-slate-300 text-center text-xs text-slate-500 fixed bottom-0 left-0 right-0",children:l.jsx("p",{children:"End of Report • AERA System"})})]})}if("BROADCAST_CONTROL"===fe)return l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[l.jsx("button",{onClick:()=>ve("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:l.jsx(P,{size:24})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Broadcast Control"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Manage System & Organization Alerts"})]})]}),l.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-xl shadow-sm",children:[l.jsxs("h3",{className:"font-bold text-red-900 mb-2 flex items-center gap-2",children:[l.jsx(M,{size:18})," Global System Alert"]}),l.jsx("p",{className:"text-xs text-red-700 mb-3",children:"This message overrides ALL organization broadcasts and is visible to every user."}),l.jsx(C,{className:"bg-white border-red-200 mb-3",value:Qs,onChange:e=>Zs(e.target.value),placeholder:"Enter high-priority system alert..."}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx(S,{size:"sm",variant:"ghost",onClick:()=>Zs(""),className:"text-slate-500",children:"Clear"}),l.jsx(S,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:ht,children:"Update Global Alert"})]})]}),l.jsx("h3",{className:"font-bold text-slate-900 mt-4",children:"Active Organization Broadcasts"}),l.jsxs("div",{className:"space-y-3",children:[es.filter(e=>e.currentBroadcast).map(e=>l.jsxs("div",{className:"bg-white border border-slate-200 p-4 rounded-xl shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("div",{className:"font-bold text-slate-900",children:e.name}),l.jsx("button",{onClick:()=>{return s=e.id,r.clearOrgBroadcast(s),void ss(e=>e.map(e=>e.id===s?{...e,currentBroadcast:void 0}:e));var s},className:"text-xs text-red-600 font-bold hover:underline",children:"Remove"})]}),l.jsxs("div",{className:"bg-slate-50 p-3 rounded text-sm text-slate-700 italic",children:['"',e.currentBroadcast,'"']}),l.jsxs("div",{className:"text-xs text-slate-400 mt-2 text-right",children:["Last Updated: ",new Date(e.lastBroadcastTime||"").toLocaleString()]})]},e.id)),0===es.filter(e=>e.currentBroadcast).length&&l.jsx("p",{className:"text-center text-slate-400 py-4 italic",children:"No active organization broadcasts."})]})]});if("DB_VIEWER"===fe)return l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-900 min-h-screen text-slate-300 font-mono",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-4 sticky top-0 bg-slate-900 z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>ve("MAIN"),className:"p-2 -ml-2 text-slate-400 hover:text-white",children:l.jsx(P,{size:24})}),l.jsx("h1",{className:"text-xl font-bold text-white",children:"Database Viewer"})]}),l.jsxs(S,{size:"sm",variant:"ghost",className:"text-brand-400 hover:text-brand-300 hover:bg-slate-800",onClick:()=>lt(JSON.stringify(Xe,null,2)),children:[l.jsx(U,{size:16,className:"mr-2"})," Copy JSON"]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[l.jsxs("h3",{className:"text-brand-400 font-bold mb-2",children:["Users (",null==Xe?void 0:Xe.users.length,")"]}),l.jsx("pre",{className:"text-xs overflow-auto max-h-60 text-slate-300",children:JSON.stringify(null==Xe?void 0:Xe.users,null,2)})]}),l.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[l.jsxs("h3",{className:"text-purple-400 font-bold mb-2",children:["Organizations (",null==Xe?void 0:Xe.organizations.length,")"]}),l.jsx("div",{className:"space-y-2",children:null==Xe?void 0:Xe.organizations.map(e=>l.jsxs("div",{className:"p-2 bg-slate-900 rounded border border-slate-600 flex justify-between",children:[l.jsx("span",{children:e.name}),l.jsx("span",{className:"text-purple-300 select-all font-bold",children:e.id})]},e.id))})]})]})]});if("ORG_DIRECTORY"===fe){const e=es.filter(e=>e.name.toLowerCase().includes(ts.toLowerCase())||e.id.toLowerCase().includes(ts.toLowerCase())||e.type.toLowerCase().includes(ts.toLowerCase()));return l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[l.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>ve("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:l.jsx(P,{size:24})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Organization Directory"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Search and View Registered Hubs"})]})]})}),ls?l.jsxs("div",{className:"animate-slide-up space-y-6",children:[l.jsxs(S,{variant:"ghost",onClick:()=>rs(null),className:"pl-0 text-slate-500",children:[l.jsx(P,{size:16,className:"mr-1"})," Back to list"]}),l.jsxs("div",{className:`bg-white rounded-2xl border ${ls.active?"border-slate-200":"border-red-300"} shadow-lg overflow-hidden`,children:[l.jsx("div",{className:(ls.active?"bg-purple-600":"bg-slate-600")+" p-6 text-white",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex gap-2 mb-2",children:[l.jsx("span",{className:"inline-block px-2 py-1 bg-white/20 rounded text-xs font-bold border border-white/30",children:ls.type}),!ls.active&&l.jsx("span",{className:"inline-block px-2 py-1 bg-red-500 rounded text-xs font-bold",children:"SUSPENDED"})]}),l.jsx("h2",{className:"text-2xl font-bold",children:ls.name}),l.jsxs("p",{className:"flex items-center gap-1 text-white/80 text-sm mt-1",children:[l.jsx(T,{size:14})," ",ls.verified?"Verified Partner":"Unverified"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-white/60 font-bold uppercase tracking-wider",children:"Community ID"}),l.jsx("p",{className:"text-3xl font-mono font-black tracking-widest",children:ls.id})]})]})}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Location & Contact"}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(V,{className:"text-slate-400 mt-1",size:18}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Address"}),l.jsx("p",{className:"text-sm text-slate-600",children:ls.address})]})]}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(_,{className:"text-slate-400 mt-1",size:18}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Admin"}),l.jsx("p",{className:"text-sm text-slate-600",children:ls.adminContact}),l.jsx("p",{className:"text-xs text-slate-500",children:ls.adminPhone})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Logistics Profile"}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(B,{className:"text-slate-400 mt-1",size:18}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Replenishment Provider"}),l.jsx("p",{className:"text-sm text-slate-600",children:ls.replenishmentProvider})]})]}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(q,{className:"text-slate-400 mt-1",size:18}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Email"}),l.jsx("p",{className:"text-sm text-slate-600 break-all",children:ls.replenishmentEmail||"N/A"})]})]}),l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx($,{className:"text-slate-400 mt-1",size:18}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Phone"}),l.jsx("p",{className:"text-sm text-slate-600",children:ls.replenishmentPhone||"N/A"})]})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[l.jsx(O,{size:18,className:"text-slate-400"})," Registered Members (",ns.length,")",ds&&l.jsx("span",{className:"text-[11px] text-amber-600 font-semibold",children:"Using cached list"})]}),0===ns.length?l.jsx("p",{className:"text-slate-500 text-sm italic",children:"No members linked yet."}):l.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-slate-100 rounded-lg p-2 bg-slate-50",children:ns.map(e=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 flex justify-between items-center shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs text-white "+("SAFE"===e.status?"bg-green-500":"DANGER"===e.status?"bg-red-500":"bg-slate-400"),children:e.name.charAt(0)}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:e.name}),l.jsx("p",{className:"text-[10px] text-slate-500",children:e.phone})]})]}),l.jsx("div",{className:"text-right",children:l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-bold uppercase "+("SAFE"===e.status?"bg-green-100 text-green-700":"DANGER"===e.status?"bg-red-100 text-red-700":"bg-slate-200 text-slate-600"),children:e.status})})]},e.id))})]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 border-t border-slate-200 flex justify-between items-center",children:[l.jsx(S,{size:"sm",variant:ls.active?"danger":"primary",onClick:()=>((e,s)=>{const t=!s;r.updateOrgStatus(e,t),ss(s=>s.map(s=>s.id===e?{...s,active:t}:s)),ls&&ls.id===e&&rs(e=>e?{...e,active:t}:null)})(ls.id,ls.active),className:ls.active?"bg-red-50 text-red-600 border border-red-200 hover:bg-red-100":"bg-green-600 text-white",children:ls.active?l.jsxs(l.Fragment,{children:[l.jsx(s,{size:16,className:"mr-2"})," Deactivate Org"]}):l.jsxs(l.Fragment,{children:[l.jsx(L,{size:16,className:"mr-2"})," Activate Org"]})}),l.jsxs(S,{size:"sm",variant:"outline",onClick:()=>lt(ls.id),children:[l.jsx(U,{size:16,className:"mr-2"})," Copy Code"]})]})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx(F,{className:"absolute left-3 top-3.5 text-slate-400",size:20}),l.jsx(k,{className:"pl-10",placeholder:"Search by Name, Type, or ID...",value:ts,onChange:e=>as(e.target.value)})]}),l.jsx("div",{className:"space-y-3",children:0===e.length?l.jsxs("div",{className:"text-center py-10 text-slate-400",children:[l.jsx(Y,{size:48,className:"mx-auto mb-2 opacity-20"}),l.jsxs("p",{children:['No organizations found matching "',ts,'"']})]}):e.map(e=>l.jsxs("button",{onClick:()=>rs(e),className:"w-full bg-white p-4 rounded-xl border shadow-sm hover:shadow-md transition-all text-left flex justify-between items-center group "+(e.active?"border-slate-200 hover:border-purple-300":"border-red-200 bg-red-50/30"),children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg border "+(e.active?"bg-purple-50 text-purple-600 border-purple-100":"bg-slate-200 text-slate-500 border-slate-300"),children:e.name.charAt(0)}),l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold transition-colors "+(e.active?"text-slate-900 group-hover:text-purple-700":"text-slate-500"),children:[e.name," ",!e.active&&l.jsx("span",{className:"text-[10px] text-red-500 ml-2 font-bold uppercase",children:"(Inactive)"})]}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[l.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200",children:e.type}),l.jsx("span",{className:"font-mono",children:e.id})]})]})]}),l.jsx(G,{size:20,className:"text-slate-300 group-hover:text-purple-500"})]},e.id))})]})]})}if("ACCESS_CONTROL"===fe){const e=Array.isArray(Ge)?Ge:[],s=e.filter(e=>{const s=(e.fullName||"").toLowerCase(),t=(e.phone||"").toLowerCase(),a=(e.role||"").toLowerCase(),l=We.toLowerCase();return s.includes(l)||t.includes(l)||a.includes(l)});return Qe?l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[l.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[l.jsx("button",{onClick:()=>Ze(null),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:l.jsx(P,{size:24})}),l.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Profile"})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-slide-up",children:[l.jsxs("div",{className:"bg-slate-800 p-6 text-white flex justify-between items-start",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-600 flex items-center justify-center text-2xl font-bold border-2 border-slate-500",children:(Qe.fullName||"?").charAt(0)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold",children:Qe.fullName||"Unnamed User"}),l.jsxs("div",{className:"flex gap-2 mt-1",children:[l.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded text-xs font-bold uppercase",children:(Qe.role||"UNKNOWN").replace("_"," ")}),l.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase "+(Qe.active?"bg-green-500 text-white":"bg-red-500 text-white"),children:Qe.active?"Active":"Suspended"})]})]})]}),l.jsxs("div",{className:"text-right text-xs opacity-60 font-mono",children:["ID: ",Qe.id]})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[l.jsx($,{size:16,className:"text-slate-400"})," Contact Details"]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Mobile Phone"}),l.jsx("a",{href:`tel:${Qe.phone}`,className:"text-blue-600 font-bold hover:underline",children:Qe.phone})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Home Address"}),l.jsxs("div",{className:"flex items-start gap-1",children:[l.jsx(V,{size:14,className:"mt-0.5 text-slate-400"}),l.jsx("p",{className:"text-slate-900",children:Qe.address||"Not Provided"})]})]}),Qe.communityId&&l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Community Connection"}),l.jsx("p",{className:"text-purple-700 font-bold bg-purple-50 px-2 py-1 rounded w-fit text-sm mt-1",children:Qe.communityId})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[l.jsx(W,{size:16,className:"text-slate-400"})," Emergency Profile"]}),Qe.medicalNeeds&&l.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[l.jsx("p",{className:"text-xs text-red-600 font-bold uppercase mb-1",children:"Medical Needs"}),l.jsx("p",{className:"text-red-900 font-medium text-sm",children:Qe.medicalNeeds})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Household"}),l.jsxs("p",{className:"text-slate-900 font-bold text-lg",children:[Qe.householdMembers," Member(s)"]}),Array.isArray(Qe.household)&&Qe.household.length>0&&l.jsx("div",{className:"mt-2 space-y-1",children:Qe.household.map(e=>l.jsxs("div",{className:"text-xs bg-slate-100 p-2 rounded flex justify-between",children:[l.jsx("span",{className:"font-bold",children:e.name}),l.jsxs("span",{className:"text-slate-500",children:[e.age," • ",e.needs||"No needs"]})]},e.id))})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Emergency Contact"}),l.jsxs("p",{className:"text-slate-900 text-sm font-medium",children:[Qe.emergencyContactName," ",l.jsxs("span",{className:"text-slate-500",children:["(",Qe.emergencyContactRelation,")"]})]}),l.jsx("a",{href:`tel:${Qe.emergencyContactPhone}`,className:"text-sm font-bold text-slate-700",children:Qe.emergencyContactPhone})]})]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mt-4 space-y-4",children:[l.jsx("h3",{className:"font-bold text-slate-900 text-sm uppercase tracking-wider",children:"Account Management"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"System Role"}),l.jsx("select",{value:Qe.role,onChange:e=>{return s=Qe.id,t=e.target.value,void(ge&&He(e=>{const a=e.map(e=>e.id===s?{...e,role:t}:e),l=a.find(e=>e.id===s);return l&&r.saveProfile(l),a}));var s,t},className:"text-sm p-2 rounded border bg-white font-medium "+(Qe.active?"border-slate-300":"opacity-50 cursor-not-allowed"),disabled:!Qe.active,children:Fe.map(e=>l.jsx("option",{value:e.id,children:e.label},e.id))})]}),l.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-200",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Account Status"}),l.jsx(S,{size:"sm",onClick:()=>((e,s)=>{if(!ge)return;const t=!s;r.updateUserStatus(e,t),He(s=>s.map(s=>s.id===e?{...s,active:t}:s)),Ze(s=>s&&s.id===e?{...s,active:t}:s)})(Qe.id,!1!==Qe.active),className:Qe.active?"bg-red-100 text-red-700 hover:bg-red-200 border-red-200":"bg-green-600 text-white",children:Qe.active?"Suspend Account":"Activate Account"})]})]})]})]})]}):l.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>ve("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:l.jsx(P,{size:24})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Directory"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Manage All Registered Users & Permissions"})]})]}),l.jsxs(S,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-100 h-9",onClick:mt,children:[l.jsx(E,{size:16,className:"mr-2"})," Export CSV"]})]}),l.jsxs("div",{className:"flex bg-white rounded-lg p-1 border border-slate-200",children:[l.jsxs("button",{onClick:()=>$e("ALL_USERS"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all "+("ALL_USERS"===qe?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"),children:["All Users (",e.length,")"]}),l.jsx("button",{onClick:()=>$e("ROLE_DEFINITIONS"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all "+("ROLE_DEFINITIONS"===qe?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"),children:"Role Definitions"})]}),"ROLE_DEFINITIONS"===qe&&l.jsx("div",{className:"space-y-4",children:Fe.map(e=>l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100",children:[l.jsx("h3",{className:"font-bold text-slate-900",children:e.label}),l.jsx("p",{className:"text-xs text-slate-500",children:e.description})]}),l.jsx("div",{className:"p-4 space-y-3",children:Object.entries(e.permissions).map(([s,t])=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 capitalize",children:s.replace("can","").replace(/([A-Z])/g," $1").trim()}),l.jsx("button",{onClick:()=>{return t=e.id,a=s,void Ye(e=>{const s=e.map(e=>e.id===t?{...e,permissions:{...e.permissions,[a]:!e.permissions[a]}}:e);return r.saveRoles(s),s});var t,a},className:"w-10 h-5 rounded-full relative transition-colors "+(t?"bg-green-500":"bg-slate-300"),children:l.jsx("div",{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full transition-transform shadow-sm "+(t?"left-[22px]":"left-0.5")})})]},s))})]},e.id))}),"ALL_USERS"===qe&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(F,{className:"absolute left-3 top-3.5 text-slate-400",size:18}),l.jsx(k,{className:"pl-10 h-10",placeholder:"Search users by name, phone, or role...",value:We,onChange:e=>Je(e.target.value)})]}),s.map(e=>{const s=e.createdAt?new Date(e.createdAt).toLocaleDateString():"Unknown";return l.jsxs("div",{onClick:()=>Ze(e),className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col gap-3 cursor-pointer hover:border-brand-400 hover:shadow-md transition-all group "+(e.active?"border-slate-200":"border-red-200 bg-red-50/10"),children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 rounded-full "+(e.active?"bg-slate-100 text-slate-600":"bg-red-100 text-red-500"),children:l.jsx(_,{size:18})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold group-hover:text-brand-700 transition-colors "+(e.active?"text-slate-900":"text-slate-500 line-through"),children:e.fullName||"Unnamed User"}),l.jsxs("p",{className:"text-xs text-slate-500",children:[e.phone||"No phone"," ","ADMIN"===e.role&&l.jsx("span",{className:"text-brand-600 font-bold ml-1",children:"(Admin)"})]}),l.jsxs("p",{className:"text-[11px] text-slate-400",children:["Created: ",s]})]})]}),l.jsx(G,{size:18,className:"text-slate-300 group-hover:text-brand-500"})]}),l.jsxs("div",{className:"pt-3 border-t border-slate-100 flex justify-between items-center",children:[l.jsxs("span",{className:"text-[10px] font-bold uppercase "+(e.active?"text-green-600":"text-red-600"),children:["Status: ",e.active?"Active":"Deactivated"]}),l.jsx("span",{className:"text-xs px-2 py-1 bg-slate-100 rounded text-slate-600 font-medium",children:(e.role||"UNKNOWN").replace("_"," ")})]})]},e.id)}),0===s.length&&l.jsx("p",{className:"text-center text-slate-400 py-4",children:"No users found."})]})]})}return l.jsxs("div",{className:"p-6 pb-28 space-y-8 animate-fade-in bg-slate-50 min-h-screen flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800 md:hidden",children:l.jsx(P,{size:24})}),l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:z("settings.title")})]}),ye&&l.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center gap-1 animate-fade-in",children:[l.jsx(A,{size:16})," Saved"]})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 order-10",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[l.jsx("div",{className:"p-3 bg-indigo-50 rounded-full text-indigo-600",children:l.jsx(Q,{size:24})}),l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:z("settings.language")})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>pt("en"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all "+("en"===pe.language?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"English"}),l.jsx("button",{onClick:()=>pt("es"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all "+("es"===pe.language?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"Español"}),l.jsx("button",{onClick:()=>pt("fr"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all "+("fr"===pe.language?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"Français"})]})]}),ge&&l.jsxs("section",{className:"bg-slate-900 text-white p-6 rounded-2xl shadow-lg relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:l.jsx(T,{size:80})}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2 text-brand-400 font-bold text-xs uppercase tracking-wider",children:[l.jsx(Z,{size:12})," Administrator Area"]}),l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Roles & Dashboards"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs(S,{onClick:()=>{if(console.info("[AccessControl] openAccessControl clicked",{isAdmin:ge}),!ge)return void console.warn("[AccessControl] blocked: not admin");const e=r.getDB();console.info("[AccessControl] loading users",{count:Array.isArray(e.users)?e.users.length:0}),He(Array.isArray(e.users)?e.users:[]),$e("ALL_USERS"),ve("ACCESS_CONTROL"),Ze(null)},className:"bg-brand-600 hover:bg-brand-500 text-white border-0 w-full justify-between",children:[l.jsx("span",{children:"User Directory & Access Control"}),l.jsx(O,{size:18})]}),l.jsxs(S,{onClick:()=>{if(!ge)return;const e=r.getDB();ss(e.organizations),ve("ORG_DIRECTORY"),rs(null)},className:"bg-purple-600 hover:bg-purple-500 text-white border-0 w-full justify-between",children:[l.jsx("span",{children:"Organization Directory"}),l.jsx(Y,{size:18})]}),l.jsxs(S,{onClick:()=>{if(!ge)return;const e=r.getAllReplenishmentRequests();xs(e),ve("MASTER_INVENTORY")},className:"bg-orange-600 hover:bg-orange-500 text-white border-0 w-full justify-between",children:[l.jsx("span",{children:"Master Inventory Database"}),l.jsx(X,{size:18})]}),l.jsxs(S,{onClick:()=>{if(!ge)return;const e=r.getDB();ss(e.organizations),Zs(e.tickerMessage),ve("BROADCAST_CONTROL")},className:"bg-red-600 hover:bg-red-500 text-white border-0 w-full justify-between",children:[l.jsx("span",{children:"Manage Broadcasts"}),l.jsx(H,{size:18})]}),l.jsxs(S,{onClick:()=>{if(!ge)return;const e=r.getDB();Ke(e),ve("DB_VIEWER")},variant:"outline",className:"border-slate-700 text-slate-300 hover:text-white hover:bg-slate-800 w-full justify-between",children:[l.jsx("span",{children:"View Raw Database"}),l.jsx(se,{size:18})]})]})]})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[l.jsx("div",{className:"p-3 bg-brand-50 rounded-full text-brand-600",children:l.jsx(_,{size:24})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Identity"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Your personal account and contact details."})]})]}),l.jsxs("div",{className:"text-xs text-slate-400 font-mono -mt-4 mb-2",children:["ID: ",pe.id]}),l.jsx(k,{label:"Full Name",value:pe.fullName,onChange:e=>tt("fullName",e.target.value),placeholder:"e.g. Jane Doe"}),l.jsx(k,{label:"Mobile Phone",value:pe.phone,onChange:e=>tt("phone",ce(e.target.value)),onBlur:()=>Ks(pe.phone),placeholder:"e.g. (555) 123-4567",className:Pe?"border-red-500 bg-red-50":"",error:Pe||void 0}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Home Address"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{placeholder:"123 Main St...",value:pe.address,onChange:e=>{Be(-1),tt("address",e.target.value)},onBlur:()=>{Ue([]),Be(-1),st(pe.address)},onKeyDown:e=>{if("Escape"===e.key)return Ue([]),void Be(-1);if(0!==Oe.length){if("ArrowDown"===e.key)return e.preventDefault(),void Be(e=>(e+1)%Oe.length);if("ArrowUp"===e.key)return e.preventDefault(),void Be(e=>e<=0?Oe.length-1:e-1);"Enter"===e.key&&(e.preventDefault(),(Oe[_e]||Oe[0])&&et())}else"Enter"===e.key&&(e.preventDefault(),st(pe.address))},className:"w-full px-4 py-3 rounded-lg border focus:ring-2 outline-none transition-all font-medium "+("VALID"===Le?"border-green-500 bg-green-50 focus:ring-green-500":"INVALID"===Le?"border-red-500 bg-red-50 focus:ring-red-500":"border-slate-300 focus:ring-brand-500 focus:border-brand-500")}),Oe.length>0&&"VERIFYING"!==Le&&l.jsx("div",{className:"absolute z-20 mt-1 w-full rounded-lg border border-slate-200 bg-white shadow-lg max-h-56 overflow-auto",children:Oe.map((e,s)=>l.jsx("button",{type:"button",onMouseDown:e=>e.preventDefault(),onClick:()=>et(),className:"w-full text-left px-3 py-2 text-sm border-b border-slate-100 last:border-b-0 "+(s===_e?"bg-slate-100 text-slate-900":"text-slate-700 hover:bg-slate-50"),children:e.description||"Suggested address"},`${e.placeId||"addr"}-${s}`))})]}),Te&&"VERIFYING"!==Le&&l.jsx("p",{className:"text-xs text-slate-500 font-semibold mt-1",children:"Finding address suggestions..."}),"VERIFYING"===Le&&l.jsx("p",{className:"text-xs text-slate-500 font-semibold mt-1",children:"Verifying with Google Maps..."}),"VALID"===Le&&l.jsx("p",{className:"text-xs text-green-600 font-bold mt-1",children:"Verified with Google Maps"}),"INVALID"===Le&&l.jsx("p",{className:"text-xs text-red-600 font-bold mt-1",children:"Address not found on Maps"}),"VALID"===Le&&Ne&&l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Verified on ",Ne]}),je&&l.jsxs("div",{className:"mt-2 flex items-center justify-between gap-3 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2",children:[l.jsxs("p",{className:"text-xs font-semibold text-amber-800 flex items-center gap-1",children:[l.jsx(Z,{size:13})," Address verification required before saving."]}),l.jsx("button",{type:"button",onClick:()=>st(pe.address),className:"text-xs font-bold text-amber-800 hover:text-amber-900 underline",children:"Retry"})]})]}),l.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"Emergency Contact"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(k,{placeholder:"Contact Name",value:pe.emergencyContactName,onChange:e=>tt("emergencyContactName",e.target.value)}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx(k,{placeholder:"Mobile Phone",type:"tel",value:pe.emergencyContactPhone,onChange:e=>tt("emergencyContactPhone",ce(e.target.value))}),l.jsx(k,{placeholder:"Relationship",value:pe.emergencyContactRelation,onChange:e=>tt("emergencyContactRelation",e.target.value)})]})]})]}),l.jsxs(S,{onClick:async()=>{const e=String(pe.address||"").trim();if(Ks(pe.phone))if(e.length,"INVALID"!==Le){gs(!0),vs(null);try{await b({fullName:pe.fullName,phone:pe.phone,email:pe.email,address:pe.address,addressLine1:pe.addressLine1,addressLine2:pe.addressLine2,city:pe.city,state:pe.state,zip:pe.zipCode,latitude:pe.latitude,longitude:pe.longitude,googlePlaceId:pe.googlePlaceId,addressVerified:Boolean(pe.addressVerified),addressVerifiedAt:pe.addressVerifiedAt,emergencyContactName:pe.emergencyContactName,emergencyContactPhone:pe.emergencyContactPhone,emergencyContactRelation:pe.emergencyContactRelation,communityId:pe.communityId,role:pe.role}),r.saveProfile(pe),we(!0),setTimeout(()=>we(!1),2e3)}catch(s){vs((null==s?void 0:s.message)||"Unable to update profile.")}finally{gs(!1)}}else alert("Please verify your address.");else alert("Please fix phone number errors before saving.")},fullWidth:!0,className:"shadow-md mt-4 bg-slate-800 hover:bg-slate-700",size:"lg",disabled:us,children:[l.jsx(J,{size:20,className:"mr-2"})," ",us?"Saving...":"Update Profile"]}),fs&&l.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:fs})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-emerald-100 order-30",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[l.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:l.jsx(O,{size:24})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Your Home"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Household code connects family members to the same home."})]})]}),l.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4 flex items-center justify-between gap-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase tracking-wider",children:"Household Code"}),l.jsx("p",{className:"text-2xl font-mono font-black tracking-widest text-emerald-900",children:pe.householdCode||"------"}),l.jsxs("p",{className:"text-xs text-emerald-700 mt-1",children:[pe.householdName||"Your Home"," • ",pe.householdRole||"OWNER"]})]}),l.jsxs(S,{size:"sm",variant:"ghost",onClick:()=>lt(pe.householdCode||""),disabled:!pe.householdCode,className:"text-emerald-800 hover:bg-emerald-100",children:[l.jsx(U,{size:16,className:"mr-2"})," Copy"]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-3 items-end",children:[l.jsx(k,{label:"Request Home Join by Code",placeholder:"e.g. A3K7Q2",value:Cs,onChange:e=>ks(e.target.value.toUpperCase()),maxLength:6}),l.jsx(S,{onClick:async()=>{Is(null),Ds(null);const e=Cs.trim().toUpperCase();if(e.length<6||e.includes("-"))Is("Enter a valid 6-character household code.");else{Rs(!0);try{const s=await u(e);Ds(s.message||"Your request has been sent to the household administrator."),ks("");try{const[e,s,t]=await Promise.all([m(),h(),p(50)]);Bs(e),$s(s),Ys(t)}catch{}}catch(s){Is((null==s?void 0:s.message)||"Unable to submit join request.")}finally{Rs(!1)}}},disabled:zs||Cs.trim().length<6||Cs.includes("-"),children:zs?"Sending...":"Send Request"})]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Your request has been sent to the household administrator and requires approval."}),ot&&l.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[l.jsx("p",{className:"text-[11px] uppercase tracking-wide font-bold text-slate-500",children:"Latest Join Request"}),l.jsxs("p",{className:"text-sm font-semibold text-slate-900 mt-1",children:["Status: ","pending"===ot.status?"Pending Approval":"approved"===ot.status?"Approved":"Rejected"]}),l.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Submitted ",new Date(ot.createdAt).toLocaleString()]})]}),Ss&&l.jsx("p",{className:"text-xs text-red-600 font-semibold",children:Ss}),As&&l.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:As}),"OWNER"===pe.householdRole&&l.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4 space-y-3",children:[l.jsxs("p",{className:"text-xs font-bold text-amber-700 uppercase tracking-wider",children:["New Household Join Request",1===dt.length?"":"s"]}),0===dt.length?l.jsx("p",{className:"text-xs text-amber-700",children:"No pending requests."}):l.jsx("div",{className:"space-y-2",children:dt.map(e=>l.jsxs("div",{className:"rounded-lg border border-amber-200 bg-white p-3 flex items-center justify-between gap-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e.requestingUserName||"AERA user"}),l.jsx("p",{className:"text-[11px] text-slate-500",children:e.requestingUserPhone||e.requestingUserEmail||"No contact preview available"}),l.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Requested ",new Date(e.createdAt).toLocaleString()]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(S,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:()=>xt(e,"approved"),disabled:Gs===e.id,children:Gs===e.id?"Working...":"Approve"}),l.jsx(S,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:()=>xt(e,"rejected"),disabled:Gs===e.id,children:"Reject"})]})]},e.id))})]}),l.jsxs("div",{className:"rounded-xl border border-indigo-200 bg-indigo-50 p-4 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:"text-xs font-bold text-indigo-700 uppercase tracking-wider",children:"Notifications"}),l.jsxs(S,{size:"sm",variant:"ghost",className:"text-indigo-700 hover:bg-indigo-100",onClick:async()=>{Js(!0);try{const e=Fs.filter(e=>!e.read);await Promise.all(e.map(e=>j(e.id)));const s=await p(50);Ys(s)}catch{}finally{Js(!1)}},disabled:Ws||0===ct,children:["Mark Read (",ct,")"]})]}),0===Fs.length?l.jsx("p",{className:"text-xs text-indigo-700",children:"No notifications yet."}):l.jsx("div",{className:"space-y-1",children:Fs.slice(0,5).map(e=>l.jsxs("div",{className:"rounded-md border px-3 py-2 text-xs "+(e.read?"border-indigo-100 bg-white text-slate-500":"border-indigo-300 bg-white text-slate-800 font-semibold"),children:[l.jsx("p",{children:"household_join_request"===e.type?"New Household Join Request":"household_join_approved"===e.type?"Your request was approved.":"household_join_rejected"===e.type?"Your request was not approved.":e.type}),l.jsx("p",{className:"text-[10px] mt-0.5 opacity-80",children:new Date(e.createdAt).toLocaleString()})]},e.id))})]}),l.jsx("div",{children:l.jsx(k,{label:"Household Size",type:"number",min:1,value:String(pe.householdMembers||1),onChange:e=>tt("householdMembers",Math.max(1,Number(e.target.value)||1))})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Who lives in your home"}),l.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Each member requires DOB in MM/DD/YYYY. Young children and seniors are flagged automatically."}),l.jsx(I,{members:pe.household,onChange:e=>tt("household",e)})]}),l.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4 space-y-3",children:[l.jsx("div",{children:l.jsx("p",{className:"text-xs font-bold text-emerald-700 uppercase tracking-wider",children:"Member Account Invites"})}),0===nt.length?l.jsx(l.Fragment,{}):l.jsx("div",{className:"space-y-2",children:nt.map(e=>{var s,t,a;return l.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-emerald-200 bg-white p-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e.name}),l.jsxs("p",{className:"text-xs text-slate-600",children:["Invite Code: ",l.jsx("span",{className:"font-mono font-bold tracking-wider",children:(null===(s=it[e.id])||void 0===s?void 0:s.invitationCode)||rt(e)})]}),l.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Bound phone: ",me((null===(t=it[e.id])||void 0===t?void 0:t.inviteePhone)||e.loginPhone||"")||"Not set"]}),!n(e.loginPhone||"")&&l.jsx("p",{className:"text-[11px] text-amber-700 mt-0.5",children:"Add a valid member phone in Household Members before creating an invite."}),it[e.id]&&l.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",it[e.id].status,it[e.id].expiresAt?` • Expires ${new Date(it[e.id].expiresAt).toLocaleDateString()}`:""]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs(S,{size:"sm",variant:"ghost",className:"text-emerald-800 hover:bg-emerald-100",onClick:()=>(async e=>{Ms(null),Us(null),Vs(e.id);try{if(!n(e.loginPhone||""))throw new Error(`${e.name} needs a valid phone number before creating an account invite.`);const s=await N({memberId:e.id,memberName:e.name,inviteePhone:e.loginPhone||"",suggestedCode:rt(e)}),t=`AERA invite for ${e.name}: create or log in to your account, then use invite code ${s.invitationCode} to join this household.`;await navigator.clipboard.writeText(t),Ms(`Invite copied for ${e.name}. Current status: ${s.status}.`);const a=await x();Es(a)}catch(s){Us((null==s?void 0:s.message)||"Unable to create invite right now.")}finally{Vs(null)}})(e),disabled:Ts===e.id||!n(e.loginPhone||""),children:[l.jsx(U,{size:14,className:"mr-1"})," ",Ts===e.id?"Working...":"Copy"]}),l.jsx(S,{size:"sm",variant:"ghost",className:"text-slate-700 hover:bg-slate-100",onClick:()=>(async e=>{Ms(null),Us(null),Vs(e.id);try{if(!n(e.loginPhone||""))throw new Error(`${e.name} needs a valid phone number before creating an account invite.`);const s=await N({memberId:e.id,memberName:e.name,inviteePhone:e.loginPhone||"",suggestedCode:rt(e),forceNew:!0}),t=`AERA invite for ${e.name}: create or log in to your account, then use invite code ${s.invitationCode} to join this household.`;await navigator.clipboard.writeText(t),Ms(`New invite generated for ${e.name}.`);const a=await x();Es(a)}catch(s){Us((null==s?void 0:s.message)||"Unable to resend invite right now.")}finally{Vs(null)}})(e),disabled:Ts===e.id||!n(e.loginPhone||""),children:Ts===e.id?"Working...":"Resend"}),"PENDING"===(null===(a=it[e.id])||void 0===a?void 0:a.status)&&l.jsx(S,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:()=>(async e=>{const s=it[e.id];if(null!=s&&s.id&&"PENDING"===s.status){Ms(null),Us(null),Vs(e.id);try{await f(s.id),Ms(`Invite revoked for ${e.name}.`);const t=await x();Es(t)}catch(t){Us((null==t?void 0:t.message)||"Unable to revoke invite right now.")}finally{Vs(null)}}})(e),disabled:Ts===e.id,children:"Revoke"})]})]},e.id)})}),Ls&&l.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:Ls}),Os&&l.jsx("p",{className:"text-xs text-red-600 font-semibold",children:Os})]})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-red-100 order-20",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[l.jsx("div",{className:"p-3 bg-red-50 rounded-full text-red-600",children:l.jsx(W,{size:24})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Safety Setup"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Preparedness and vulnerability inputs for planning."})]})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-4 py-3",children:[l.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"ZIP Code"}),l.jsx("p",{className:"text-sm font-semibold text-slate-900 mt-1",children:pe.zipCode||"Not detected yet"}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"From your Home Address"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Medical"}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Medication Dependency"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.medicationDependency),onChange:e=>tt("medicationDependency",e.target.checked)})]}),l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Insulin Dependency"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.insulinDependency),onChange:e=>tt("insulinDependency",e.target.checked)})]}),l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3 md:col-span-2",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Oxygen / Powered Medical Device"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.oxygenPoweredDevice),onChange:e=>tt("oxygenPoweredDevice",e.target.checked)})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Accessibility"}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Mobility Limitation"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.mobilityLimitation),onChange:e=>tt("mobilityLimitation",e.target.checked)})]}),l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Transportation Access"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.transportationAccess),onChange:e=>tt("transportationAccess",e.target.checked)})]}),l.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3 md:col-span-2",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Financial Strain"}),l.jsx("input",{type:"checkbox",checked:Boolean(pe.financialStrain),onChange:e=>tt("financialStrain",e.target.checked)})]})]})]}),l.jsx(k,{label:"Pets",placeholder:"e.g. 2 Dogs",value:pe.petDetails,onChange:e=>tt("petDetails",e.target.value)}),l.jsx(C,{label:"Anything else not listed above",value:pe.medicalNeeds,onChange:e=>tt("medicalNeeds",e.target.value)}),l.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[l.jsx("p",{className:"text-[11px] font-bold text-slate-600 uppercase tracking-wide",children:"Final Step"}),l.jsx("p",{className:"text-sm font-bold text-slate-800 mt-1",children:"Confirm preparedness consent"})]}),l.jsxs("label",{className:"flex items-start gap-3 rounded-lg border border-emerald-200 bg-emerald-50 p-3",children:[l.jsx("input",{className:"mt-1",type:"checkbox",checked:Boolean(pe.consentPreparednessPlanning),onChange:e=>tt("consentPreparednessPlanning",e.target.checked)}),l.jsx("span",{className:"text-sm text-emerald-900 font-semibold",children:"I understand this data is used only for preparedness planning and can be deleted anytime."})]}),l.jsx(S,{onClick:async()=>{var e;if(null===(e=pe.zipCode)||void 0===e||!e.trim())return void ws("ZIP is pulled from your Home Address. Verify your address in Identity first.");const s=v(pe.household||[]);if(s.ok)if(pe.consentPreparednessPlanning){Ns(!0),ws(null);try{await y({household:pe.household,householdMembers:pe.householdMembers,petDetails:pe.petDetails,medicalNeeds:pe.medicalNeeds,zipCode:pe.zipCode,medicationDependency:Boolean(pe.medicationDependency),insulinDependency:Boolean(pe.insulinDependency),oxygenPoweredDevice:Boolean(pe.oxygenPoweredDevice),mobilityLimitation:Boolean(pe.mobilityLimitation),transportationAccess:Boolean(pe.transportationAccess),financialStrain:Boolean(pe.financialStrain),consentPreparednessPlanning:Boolean(pe.consentPreparednessPlanning)});const e={...pe,consentTimestamp:(new Date).toISOString()};be(e),r.saveProfile(e),we(!0),setTimeout(()=>we(!1),2e3)}catch(t){ws((null==t?void 0:t.message)||"Unable to update vitals.")}finally{Ns(!1)}}else ws("You must provide consent before saving Vital Intake.");else ws(s.error)},fullWidth:!0,className:"bg-red-50 border border-red-200 text-red-700 hover:bg-red-100 shadow-sm",disabled:js,children:js?"Saving...":"Update Vitals"}),ys&&l.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:ys})]}),l.jsxs("section",{ref:te,className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-purple-100 relative overflow-hidden order-40",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:l.jsx(Y,{size:64,className:"text-purple-600"})}),l.jsxs("div",{className:"flex items-center gap-4 mb-2 relative z-10",children:[l.jsx("div",{className:"p-3 bg-purple-50 rounded-full text-purple-600",children:l.jsx(Y,{size:24})}),l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:z("settings.trusted_conn")})]}),"INSTITUTION_ADMIN"===pe.role?l.jsxs("div",{className:"relative z-10 space-y-3",children:[l.jsxs("div",{className:"bg-purple-100 border border-purple-200 p-4 rounded-xl flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-purple-600 uppercase tracking-wider",children:"Your Organization ID"}),l.jsx("p",{className:"text-2xl font-mono font-black text-purple-900 tracking-widest",children:pe.communityId||"NOT SET"})]}),l.jsx(S,{size:"sm",variant:"ghost",onClick:()=>lt(pe.communityId),className:"text-purple-700 hover:bg-purple-200",children:l.jsx(U,{size:20})})]}),l.jsxs("div",{className:"flex gap-3 items-end",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx(k,{label:"Change Organization ID",value:pe.communityId,onChange:e=>{tt("communityId",xe(e.target.value)),Ie(null),De(null)},className:Se?"border-green-500 focus:ring-green-500 bg-green-50/30":Ae?"border-red-500 focus:ring-red-500":""}),l.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"Format: CH-1234"})]}),l.jsx(S,{className:"mb-[1px] min-w-[50px] "+(Se?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"),onClick:at,disabled:Ce||!pe.communityId,children:Ce?l.jsx(K,{className:"animate-spin",size:20}):Se?l.jsx(A,{size:20}):l.jsx(ae,{size:20})})]}),Ae&&l.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[l.jsx(ee,{size:16})," ",Ae]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex gap-3 items-end relative z-10",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx(k,{label:"Community ID",value:pe.communityId,onChange:e=>{tt("communityId",xe(e.target.value)),Ie(null),De(null)},className:Se?"border-green-500 focus:ring-green-500 bg-green-50/30":Ae?"border-red-500 focus:ring-red-500":""}),l.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"Format: CH-1234"})]}),l.jsx(S,{className:"mb-[1px] min-w-[50px] "+(Se?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"),onClick:at,disabled:Ce||!pe.communityId,children:Ce?l.jsx(K,{className:"animate-spin",size:20}):Se?l.jsx(A,{size:20}):l.jsx(ae,{size:20})})]}),Se&&l.jsxs("p",{className:"text-xs font-semibold text-emerald-700 relative z-10",children:["Connected to ",Se,"."]}),Ae&&l.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[l.jsx(ee,{size:16})," ",Ae]}),l.jsxs("div",{className:"relative z-10 mt-4 border-t border-slate-200 pt-3",children:[l.jsx("p",{className:"text-[11px] text-slate-500 mb-2",children:"Advanced"}),l.jsx(S,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:async()=>{if(pe.communityId){Re(!0),De(null);try{await b({fullName:pe.fullName,phone:pe.phone,email:pe.email,address:pe.address,emergencyContactName:pe.emergencyContactName,emergencyContactPhone:pe.emergencyContactPhone,emergencyContactRelation:pe.emergencyContactRelation,communityId:"",role:pe.role});const e={...pe,communityId:""};be(e),r.saveProfile(e),Ie(null),De(null)}catch(e){De((null==e?void 0:e.message)||"Unable to disconnect organization right now.")}finally{Re(!1)}}},disabled:ze||!pe.communityId,children:ze?"Disconnecting...":"Disconnect Organization"})]})]})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 order-50",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:l.jsx(T,{size:24})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Legal & Consent"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Privacy policy and proof of consent"})]})]}),l.jsxs(S,{onClick:()=>{sessionStorage.setItem("privacyReturnView","SETTINGS"),e("PRIVACY_POLICY")},variant:"outline",className:"w-full justify-between",children:[l.jsx("span",{children:"View Proof of Consent & Privacy Policy"}),l.jsx(X,{size:18})]})]}),l.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-200 order-60",children:l.jsxs(S,{onClick:()=>{r.logoutUser(),e("LOGIN")},variant:"ghost",fullWidth:!0,className:"text-red-600 hover:bg-red-50 hover:text-red-700",children:[l.jsx(le,{className:"mr-2",size:18}),"Log Out"]})})]})})}}});
