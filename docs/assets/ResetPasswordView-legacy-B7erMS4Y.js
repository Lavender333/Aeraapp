System.register(["./index-legacy-CUEbsImb.js","./Button-legacy-Ct7QJn9V.js","./Input-legacy-BMd5SFgd.js","./lock-legacy-BMeOg3LM.js","./octagon-alert-legacy-JVrabzed.js","./circle-check-big-legacy-CSmzxCnB.js"],function(e,s){"use strict";var t,a,r,l,n,o,i,d;return{setters:[e=>{t=e.r,a=e.j,r=e.E},e=>{l=e.B},e=>{n=e.I},e=>{o=e.L},e=>{i=e.O},e=>{d=e.C}],execute:function(){e("ResetPasswordView",({setView:e})=>{const[s,c]=t.useState(""),[h,u]=t.useState(""),[w,m]=t.useState(""),[f,x]=t.useState(""),[g,p]=t.useState(!1),[b,j]=t.useState(!1),[y,v]=t.useState(!1);return t.useEffect(()=>{let e=!0;return(async()=>{try{const s=window.location.hash||"",t=window.location.search||"",a=new URLSearchParams(s.startsWith("#")?s.slice(1):s),l=new URLSearchParams(t.startsWith("?")?t.slice(1):t),n=a.get("access_token")||l.get("access_token"),o=a.get("refresh_token")||l.get("refresh_token"),i=l.get("code")||a.get("code"),d=l.get("token_hash")||a.get("token_hash"),c=l.get("type")||a.get("type");if(i){const{error:e}=await r.auth.exchangeCodeForSession(i);if(e)throw e}else if(n&&o){const{error:e}=await r.auth.setSession({access_token:n,refresh_token:o});if(e)throw e}else if(d&&"recovery"===c){const{error:e}=await r.auth.verifyOtp({type:"recovery",token_hash:d});if(e)throw e}const{data:h,error:u}=await r.auth.getSession();if(!e)return;if(u)return m("Unable to validate reset link. Please request a new one."),p(!0),void v(!1);const w=null==h?void 0:h.session;v(!!w),p(!0),w||m("Reset link is invalid or expired. Please request a new one.")}catch{if(!e)return;m("Unable to validate reset link. Please request a new one."),v(!1),p(!0)}})(),()=>{e=!1}},[]),a.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col p-6 animate-fade-in pb-safe justify-center max-w-sm mx-auto w-full",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-4 text-brand-700 border border-brand-200",children:a.jsx(o,{size:32})}),a.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reset Password"}),a.jsx("p",{className:"text-slate-600 font-medium",children:"Set a new password for your account."})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm space-y-4",children:[a.jsx(n,{disabled:!g||!y||b,label:"New Password",type:"password",placeholder:"New password",value:s,onChange:e=>c(e.target.value),className:"border-slate-300"}),a.jsx(n,{disabled:!g||!y||b,label:"Confirm Password",type:"password",placeholder:"Confirm password",value:h,onChange:e=>u(e.target.value),className:"border-slate-300"}),w&&a.jsxs("div",{className:"flex items-start gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:[a.jsx(i,{size:16,className:"mt-0.5 shrink-0"}),a.jsx("span",{children:w})]}),f&&a.jsxs("div",{className:"flex items-start gap-2 text-sm text-emerald-700 bg-emerald-50 p-3 rounded-lg",children:[a.jsx(d,{size:16,className:"mt-0.5 shrink-0"}),a.jsx("span",{children:f})]}),a.jsx(l,{fullWidth:!0,size:"lg",onClick:async()=>{if(m(""),x(""),!s||s.length<8)m("Password must be at least 8 characters.");else if(s===h)if(y)try{j(!0);const{error:e}=await r.auth.updateUser({password:s});if(e)throw e;x("Password updated. You can log in now."),c(""),u("")}catch(e){m((null==e?void 0:e.message)||"Password reset failed.")}finally{j(!1)}else m("Reset link is invalid or expired. Please request a new one.");else m("Passwords do not match.")},className:"font-bold shadow-md",disabled:!g||!y||b,children:b?"Savingâ€¦":"Update Password"}),a.jsx(l,{fullWidth:!0,variant:"outline",onClick:()=>e("LOGIN"),className:"border-slate-300 text-slate-900 font-bold",children:"Back to Login"})]})]})})}}});
