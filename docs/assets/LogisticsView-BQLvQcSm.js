import{r as o,S as r,j as e}from"./index-D21_jD2s.js";import{t as m}from"./translations-DYnCuGsW.js";import{g as f}from"./inventoryStatus-BGlXoNrp.js";import{A as j}from"./arrow-left-DagSdbID.js";import{T as N}from"./truck-Bzp_ET5Q.js";import{M as w}from"./map-pin-DKfMhJj3.js";import{N as y}from"./navigation-CafmmTpp.js";const C=({setView:x})=>{const[s,b]=o.useState(null),[g,i]=o.useState({water:0,food:0,blankets:0,medicalKits:0}),[p,l]=o.useState(0);o.useEffect(()=>{const t=r.getProfile().communityId||"CH-9921",d=r.getOrganization(t);b(d),i(r.getOrgInventory(t)),l(r.getOrgMembers(t).length),r.fetchOrgInventoryRemote(t).then(({inventory:c})=>{i(c)}),r.fetchOrgMembersRemote(t).then(({members:c})=>{l(c.length)});const a=()=>{i(r.getOrgInventory(t)),l(r.getOrgMembers(t).length)};return window.addEventListener("inventory-update",a),window.addEventListener("storage",a),()=>{window.removeEventListener("inventory-update",a),window.removeEventListener("storage",a)}},[]);const h=()=>{if(s!=null&&s.address){const n="https://www.google.com/maps/dir/?api=1&destination=".concat(encodeURIComponent(s.address));window.open(n,"_blank")}},u=p||(s==null?void 0:s.registeredPopulation)||0,v=f(g,u);return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col pb-safe animate-fade-in",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 p-4 sticky top-0 z-20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>x("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(j,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg text-slate-900",children:m("logistics.title")}),e.jsx("p",{className:"text-xs text-slate-500",children:m("logistics.subtitle")})]})]})}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsx("div",{className:"bg-brand-50 border border-brand-100 p-4 rounded-xl shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-3 bg-brand-100 rounded-lg text-brand-700",children:e.jsx(N,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-brand-900",children:m("logistics.depot")}),s?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg font-bold text-brand-800 leading-tight mt-1",children:s.name}),e.jsxs("div",{className:"flex items-start gap-1.5 mt-2 text-brand-700",children:[e.jsx(w,{size:16,className:"mt-0.5 shrink-0"}),e.jsx("p",{className:"text-sm font-medium",children:s.address})]}),e.jsxs("button",{onClick:h,className:"mt-3 flex items-center gap-1 text-xs font-bold text-brand-700 bg-white/50 px-3 py-1.5 rounded border border-brand-200 hover:bg-white transition-colors",children:[e.jsx(y,{size:12})," Get Directions"]})]}):e.jsx("p",{className:"text-sm text-brand-700 animate-pulse mt-1",children:"Locating nearest hub..."}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-brand-200/50",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-brand-600 mb-2",children:"Current Stock Levels"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{label:"Water",key:"water",unit:"cases"},{label:"Food",key:"food",unit:"boxes"},{label:"Blankets",key:"blankets",unit:"units"},{label:"Med Kits",key:"medicalKits",unit:"kits"}].map(n=>{const t=v[n.key].level,d=t==="HIGH"?"text-green-700 border-green-200 bg-green-50":t==="MEDIUM"?"text-amber-700 border-amber-200 bg-amber-50":t==="LOW"?"text-red-700 border-red-200 bg-red-50":"text-slate-500 border-slate-200 bg-white";return e.jsxs("div",{className:"text-xs px-3 py-2 rounded border font-bold shadow-sm ".concat(d," flex justify-between"),children:[e.jsx("span",{children:n.label}),e.jsx("span",{children:t==="UNKNOWN"?"N/A":t})]},n.label)})})]})]})]})})})]})};export{C as LogisticsView};
