import{c as R,r as i,j as e,S as x,i as se,f as kt,e as It,h as At,k as Dt,l as ue,m as be,o as ge,p as te,u as Ve,q as Rt,s as zt,t as Pt,v as Ds,w as Et,x as Lt,y as Mt,d as Ot}from"./index-D21_jD2s.js";import{T as Rs,I as A}from"./Input-CRKoqp_l.js";import{B as d}from"./Button-4kycTSxy.js";import{H as Ut}from"./HouseholdManager-CUeyNjJj.js";import{C as je}from"./check-BzBewqu7.js";import{s as zs}from"./supabaseClient-v2pLAF6q.js";import{t as _e}from"./translations-DYnCuGsW.js";import{X as Tt}from"./x-Btfl62Z_.js";import{A as L}from"./arrow-left-DagSdbID.js";import{D as Be}from"./download-BNuEbOuL.js";import{C as Ps}from"./circle-check-big-Cm7ZoXKS.js";import{A as Vt,U as $e}from"./users-5ipgHo-j.js";import{C as ae}from"./copy-DYM_SlO9.js";import{S as Fe}from"./shield-check-Dt_CUtL3.js";import{M as Es}from"./map-pin-DKfMhJj3.js";import{U as He}from"./user-fCl5U7DO.js";import{T as _t}from"./truck-Bzp_ET5Q.js";import{M as Bt}from"./mail-CeYo0zWb.js";import{P as Ls}from"./phone-C4zfy2b5.js";import{S as Ms}from"./search-G-K9RWNS.js";import{B as fe}from"./building-2-CrlLcRGL.js";import{A as Os,R as $t}from"./radio-DnGdk0VF.js";import{H as Us,S as Ft}from"./save-CtaKbsHI.js";import{G as Ht}from"./globe-COF_kRX_.js";import{L as Ts}from"./lock-DMl36SE4.js";import{F as Vs}from"./file-text-Cyxh1phQ.js";import{L as _s}from"./loader-circle-DKAHqKg-.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Yt=R("ban",qt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Bs=R("circle-x",Gt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Wt=R("database",Jt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],Qt=R("eraser",Kt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],$s=R("link",Xt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],ea=R("log-out",Zt);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],ta=R("pen-tool",sa);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],qe=R("printer",aa);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],la=R("refresh-ccw",na);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ia=R("square-check-big",ra),Fs=({onSave:N,className:u})=>{const j=i.useRef(null),[n,I]=i.useState(!1),[Ne,C]=i.useState(!1);i.useEffect(()=>{const c=j.current;if(c){const b=c.getBoundingClientRect();c.width=b.width,c.height=b.height;const v=c.getContext("2d");v&&(v.lineWidth=2,v.lineCap="round",v.strokeStyle="#000")}},[]);const ve=c=>{const b=j.current;if(!b)return{x:0,y:0};const v=b.getBoundingClientRect();let y,w;return"touches"in c?(y=c.touches[0].clientX,w=c.touches[0].clientY):(y=c.clientX,w=c.clientY),{x:y-v.left,y:w-v.top}},ne=c=>{var v;c.preventDefault(),I(!0);const b=(v=j.current)==null?void 0:v.getContext("2d");if(b){const{x:y,y:w}=ve(c);b.beginPath(),b.moveTo(y,w)}},G=c=>{var v;if(!n)return;c.preventDefault();const b=(v=j.current)==null?void 0:v.getContext("2d");if(b){const{x:y,y:w}=ve(c);b.lineTo(y,w),b.stroke(),C(!0)}},D=()=>{I(!1)},S=()=>{const c=j.current,b=c==null?void 0:c.getContext("2d");c&&b&&(b.clearRect(0,0,c.width,c.height),C(!1))},ye=()=>{if(j.current){const c=j.current.toDataURL("image/png");N(c)}};return e.jsxs("div",{className:"space-y-3 ".concat(u),children:[e.jsxs("div",{className:"border-2 border-slate-300 rounded-xl overflow-hidden bg-white shadow-inner relative",children:[e.jsx("canvas",{ref:j,className:"w-full h-40 touch-none cursor-crosshair block",onMouseDown:ne,onMouseMove:G,onMouseUp:D,onMouseLeave:D,onTouchStart:ne,onTouchMove:G,onTouchEnd:D}),e.jsx("div",{className:"absolute bottom-2 left-4 text-xs text-slate-300 pointer-events-none font-bold uppercase select-none",children:"Sign Here"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",onClick:S,size:"sm",className:"flex-1 text-slate-500 border-slate-300",children:[e.jsx(Qt,{size:16,className:"mr-2"})," Clear"]}),e.jsxs(d,{onClick:ye,size:"sm",disabled:!Ne,className:"flex-1 font-bold bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(je,{size:16,className:"mr-2"})," Apply Signature"]})]})]})},oa=async N=>{const u=zs.channel("notifications").on("postgres_changes",{event:"*",schema:"public",table:"notifications"},j=>N(j)).subscribe();return()=>{zs.removeChannel(u)}},Hs=N=>{if(!N)return N;const u=N.replace(/[^\d]/g,""),j=u.length;return j<4?u:j<7?"(".concat(u.slice(0,3),") ").concat(u.slice(3)):"(".concat(u.slice(0,3),") ").concat(u.slice(3,6),"-").concat(u.slice(6,10))},qs=N=>{const u=String(N||"").toUpperCase().replace(/[–—−]/g,"-").replace(/[^A-Z0-9-]/g,"").replace(/-+/g,"-");return u.length<=2||u.includes("-")?u:"".concat(u.slice(0,2),"-").concat(u.slice(2))},da=N=>{const u=String(N||"").replace(/\D/g,"");if(u.length<4)return N;const j=u.slice(-4);return"***-***-".concat(j)},ca=[{id:"ADMIN",label:"Administrator",description:"Full system access and user management.",permissions:{canViewPII:!0,canDispatchDrone:!0,canApproveFunds:!0,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"FIRST_RESPONDER",label:"First Responder",description:"Field access to location data and medical info.",permissions:{canViewPII:!0,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"LOCAL_AUTHORITY",label:"Local Authority",description:"Oversight of alerts and population tracking.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!0,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"CONTRACTOR",label:"Contractor",description:"Logistics and repair management.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!1}},{id:"INSTITUTION_ADMIN",label:"Institution Admin",description:"Manage community members and hub inventory.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"GENERAL_USER",label:"General User",description:"Standard access to report emergencies.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!1}}],Va=({setView:N})=>{const j=i.useRef(null),[n,I]=i.useState({id:"",fullName:"",phone:"",address:"",householdMembers:1,household:[],zipCode:"",petDetails:"",medicalNeeds:"",medicationDependency:!1,insulinDependency:!1,oxygenPoweredDevice:!1,mobilityLimitation:!1,transportationAccess:!0,financialStrain:!1,consentPreparednessPlanning:!1,emergencyContactName:"",emergencyContactPhone:"",emergencyContactRelation:"",communityId:"",role:"GENERAL_USER",language:"en",active:!0,notifications:{push:!0,sms:!0,email:!0}}),Ne=String(n.role||"").toUpperCase(),C=["ADMIN","STATE_ADMIN","COUNTY_ADMIN","ORG_ADMIN","INSTITUTION_ADMIN"].includes(Ne),ne=String(n.address||"").trim().length>0&&!1,G=n.addressVerifiedAt?new Date(n.addressVerifiedAt).toLocaleString():null,[D,S]=i.useState("MAIN"),[ye,c]=i.useState(!1),[b,v]=i.useState(!1),[y,w]=i.useState(null),[T,z]=i.useState(null),[Ye,Ge]=i.useState(!1),[Je,We]=i.useState(null),[P,V]=i.useState("IDLE"),[M,le]=i.useState([]),[Ys,xa]=i.useState(!1),[Ke,O]=i.useState(-1),[re,we]=i.useState("ALL_USERS"),[Qe,Gs]=i.useState(()=>x.getRoles()||ca),[Ce,Se]=i.useState([]),[Xe,Js]=i.useState(""),[m,ie]=i.useState(null),[k,Ws]=i.useState(null),[ke,oe]=i.useState([]),[J,Ks]=i.useState(""),[p,de]=i.useState(null),[Ie,Ae]=i.useState([]),[Qs,Ze]=i.useState(!1),[W,ce]=i.useState([]),[g,De]=i.useState(null),[Re,es]=i.useState({}),[ss,ts]=i.useState(!1),[as,ns]=i.useState(!1),[ls,ze]=i.useState(null),[rs,K]=i.useState(null),[xe,is]=i.useState(""),[os,Q]=i.useState(null),[ds,me]=i.useState(null),[cs,xs]=i.useState(!1),[ms,_]=i.useState([]),[hs,B]=i.useState(null),[ps,$]=i.useState(null),[X,F]=i.useState(null),[us,H]=i.useState([]),[bs,q]=i.useState([]),[Z,Y]=i.useState([]),[Pe,gs]=i.useState(null),[Xs,fs]=i.useState(!1),[js,Ee]=i.useState(""),Ns=s=>{I(a=>({...a,householdId:s.householdId,householdCode:s.householdCode,householdName:s.householdName,householdRole:s.householdRole}));const t=x.getProfile();x.saveProfile({...t,householdId:s.householdId,householdCode:s.householdCode,householdName:s.householdName,householdRole:s.householdRole})};i.useEffect(()=>{const s=x.getProfile();if(s.role||(s.role="GENERAL_USER"),s.language||(s.language="en"),s.active===void 0&&(s.active=!0),s.household||(s.household=[]),typeof s.zipCode!="string"&&(s.zipCode=""),typeof s.medicationDependency!="boolean"&&(s.medicationDependency=!1),typeof s.insulinDependency!="boolean"&&(s.insulinDependency=!1),typeof s.oxygenPoweredDevice!="boolean"&&(s.oxygenPoweredDevice=!1),typeof s.mobilityLimitation!="boolean"&&(s.mobilityLimitation=!1),typeof s.transportationAccess!="boolean"&&(s.transportationAccess=!0),typeof s.financialStrain!="boolean"&&(s.financialStrain=!1),typeof s.consentPreparednessPlanning!="boolean"&&(s.consentPreparednessPlanning=!1),I(s),s.addressVerified?V("VALID"):s.address&&s.address.length>5&&V("IDLE"),s.communityId&&s.role!=="INSTITUTION_ADMIN"){const t=x.getOrganization(s.communityId);t&&w(t.name)}},[]),i.useEffect(()=>{let s=!0;return(async()=>{try{const[a,l]=await Promise.all([kt(),It()]);if(!s)return;if(a||l){const o={...x.getProfile(),...a||{},...l||{}};x.saveProfile(o),I(o),V(o.addressVerified?"VALID":"IDLE")}const r=await At();if(!s)return;if(r)Ns(r);else{const h=await Dt();if(!s)return;Ns(h)}}catch(a){}})(),()=>{s=!1}},[]),i.useEffect(()=>{!C&&D!=="MAIN"&&S("MAIN")},[C,D]),i.useEffect(()=>{if(sessionStorage.getItem("settingsScrollTarget")!=="TRUSTED_COMMUNITY")return;const t=window.setTimeout(()=>{var a;(a=j.current)==null||a.scrollIntoView({behavior:"smooth",block:"start"}),sessionStorage.removeItem("settingsScrollTarget")},150);return()=>window.clearTimeout(t)},[]),i.useEffect(()=>{const s=Array.isArray(n.household)?n.household.length:0;s>0&&n.householdMembers!==s&&I(t=>({...t,householdMembers:s}))},[n.household,n.householdMembers]),i.useEffect(()=>{let s=!0;return(async()=>{if(!n.householdId){_([]);return}try{const a=await ue();s&&_(a)}catch(a){s&&_([])}})(),()=>{s=!1}},[n.householdId]),i.useEffect(()=>{let s=!0;return(async()=>{n.householdId||(H([]),q([]));try{const[a,l]=await Promise.all([be(),ge()]);if(!s)return;H(a),q(l)}catch(a){if(!s)return;H([]),q([])}try{const a=await te(50);s&&Y(a)}catch(a){s&&Y([])}})(),()=>{s=!1}},[n.householdId,n.householdRole]),i.useEffect(()=>{let s=null,t=!0;return(async()=>{try{s=await oa(async()=>{if(t)try{const[l,r,h]=await Promise.all([te(50),be(),ge()]);if(!t)return;Y(l),H(r),q(h)}catch(l){}})}catch(l){s=null}})(),()=>{t=!1,s&&s()}},[]),i.useEffect(()=>{if(p){const s=x.getOrgMembers(p.id);Ae(s),x.fetchOrgMembersRemote(p.id).then(({members:t,fromCache:a})=>{Ae(t),Ze(a)}).catch(()=>Ze(!0))}else Ae([])},[p]);const vs=s=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(s)?(We(null),!0):(We("Invalid format. Use 555-123-4567"),!1),ys=async s=>{},Zs=()=>{le([]),O(-1),Le(n.address)},et=s=>{if(s.key==="Escape"){le([]),O(-1);return}if(M.length===0){s.key==="Enter"&&(s.preventDefault(),Le(n.address));return}if(s.key==="ArrowDown"){s.preventDefault(),O(t=>(t+1)%M.length);return}if(s.key==="ArrowUp"){s.preventDefault(),O(t=>t<=0?M.length-1:t-1);return}s.key==="Enter"&&(s.preventDefault(),(M[Ke]||M[0])&&ys())};i.useEffect(()=>{String(n.address||"").trim();{le([]),O(-1);return}},[n.address,n.addressVerified,void 0]);const Le=async s=>{var a;if(((a=s!=null?s:n.address)!=null?a:"").trim().length<5){V("IDLE");return}{V("IDLE");return}},st=async()=>{const s=String(n.address||"").trim();if(!vs(n.phone)){alert("Please fix phone number errors before saving.");return}if(s.length>0,P==="INVALID"){alert("Please verify your address.");return}ts(!0),ze(null);try{await Ve({fullName:n.fullName,phone:n.phone,email:n.email,address:n.address,addressLine1:n.addressLine1,addressLine2:n.addressLine2,city:n.city,state:n.state,zip:n.zipCode,latitude:n.latitude,longitude:n.longitude,googlePlaceId:n.googlePlaceId,addressVerified:!!n.addressVerified,addressVerifiedAt:n.addressVerifiedAt,emergencyContactName:n.emergencyContactName,emergencyContactPhone:n.emergencyContactPhone,emergencyContactRelation:n.emergencyContactRelation,communityId:n.communityId,role:n.role}),x.saveProfile(n),c(!0),setTimeout(()=>c(!1),2e3)}catch(t){ze((t==null?void 0:t.message)||"Unable to update profile.")}finally{ts(!1)}},tt=async()=>{var t;if(!((t=n.zipCode)!=null&&t.trim())){K("ZIP is pulled from your Home Address. Verify your address in Identity first.");return}const s=Lt(n.household||[]);if(!s.ok){K(s.error);return}if(!n.consentPreparednessPlanning){K("You must provide consent before saving Vital Intake.");return}ns(!0),K(null);try{await Mt({household:n.household,householdMembers:n.householdMembers,petDetails:n.petDetails,medicalNeeds:n.medicalNeeds,zipCode:n.zipCode,medicationDependency:!!n.medicationDependency,insulinDependency:!!n.insulinDependency,oxygenPoweredDevice:!!n.oxygenPoweredDevice,mobilityLimitation:!!n.mobilityLimitation,transportationAccess:!!n.transportationAccess,financialStrain:!!n.financialStrain,consentPreparednessPlanning:!!n.consentPreparednessPlanning});const a={...n,consentTimestamp:new Date().toISOString()};I(a),x.saveProfile(a),c(!0),setTimeout(()=>c(!1),2e3)}catch(a){K((a==null?void 0:a.message)||"Unable to update vitals.")}finally{ns(!1)}},f=(s,t)=>{I(a=>{const l={...a,[s]:t};return s==="address"&&(l.addressVerified=!1,l.addressVerifiedAt=void 0,l.googlePlaceId=void 0,l.latitude=void 0,l.longitude=void 0,l.addressLine1=void 0,l.addressLine2=void 0,l.city=void 0,l.state=void 0),l}),s==="communityId"&&(w(null),z(null)),s==="address"&&(V("IDLE"),le([]),O(-1),ze(null))},ws=async()=>{const s=String(n.communityId||"").trim().replace(/[–—−]/g,"-").replace(/\s+/g,"").toUpperCase();if(s){v(!0),z(null),w(null);try{const t=x.getOrganization(s),a=t?{orgCode:s,orgName:t.name}:await Ot(s);if(!a){z("Invalid Community ID");return}const l=a.orgName||(t==null?void 0:t.name)||s,r={...n,communityId:s};I(r),x.saveProfile(r),w(l);try{await Ve({fullName:r.fullName,phone:r.phone,email:r.email,address:r.address,addressLine1:r.addressLine1,addressLine2:r.addressLine2,city:r.city,state:r.state,zip:r.zipCode,latitude:r.latitude,longitude:r.longitude,googlePlaceId:r.googlePlaceId,addressVerified:!!r.addressVerified,addressVerifiedAt:r.addressVerifiedAt,emergencyContactName:r.emergencyContactName,emergencyContactPhone:r.emergencyContactPhone,emergencyContactRelation:r.emergencyContactRelation,communityId:s,role:r.role})}catch(h){}}catch(t){z("Unable to verify Community ID right now. Please try again.")}finally{v(!1)}}},at=async()=>{if(n.communityId){Ge(!0),z(null);try{await Ve({fullName:n.fullName,phone:n.phone,email:n.email,address:n.address,emergencyContactName:n.emergencyContactName,emergencyContactPhone:n.emergencyContactPhone,emergencyContactRelation:n.emergencyContactRelation,communityId:"",role:n.role});const s={...n,communityId:""};I(s),x.saveProfile(s),w(null),z(null)}catch(s){z((s==null?void 0:s.message)||"Unable to disconnect organization right now.")}finally{Ge(!1)}}},he=s=>{navigator.clipboard.writeText(s),alert("Copied to clipboard")},Me=s=>{const t=(n.householdCode||"").trim().toUpperCase(),a=(s.id||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(-3),r=((s.name||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(0,3)||a||"MEM").padEnd(3,"X").slice(0,3);return t?"".concat(t,"-").concat(r):r},Cs=(n.household||[]).filter(s=>s.loginEnabled),E=i.useMemo(()=>{const s={};return ms.forEach(t=>{t.inviteeMemberRef&&(s[t.inviteeMemberRef]||(s[t.inviteeMemberRef]=t))}),s},[ms]),Oe=i.useMemo(()=>us.filter(s=>s.status==="pending"),[us]),pe=i.useMemo(()=>bs[0]||null,[bs]),Ss=i.useMemo(()=>Z.filter(s=>!s.read).length,[Z]),nt=async s=>{B(null),$(null),F(s.id);try{if(!se(s.loginPhone||""))throw new Error("".concat(s.name," needs a valid phone number before creating an account invite."));const t=await Ds({memberId:s.id,memberName:s.name,inviteePhone:s.loginPhone||"",suggestedCode:Me(s)}),a="AERA invite for ".concat(s.name,": create or log in to your account, then use invite code ").concat(t.invitationCode," to join this household.");await navigator.clipboard.writeText(a),B("Invite copied for ".concat(s.name,". Current status: ").concat(t.status,"."));const l=await ue();_(l)}catch(t){$((t==null?void 0:t.message)||"Unable to create invite right now.")}finally{F(null)}},lt=async s=>{B(null),$(null),F(s.id);try{if(!se(s.loginPhone||""))throw new Error("".concat(s.name," needs a valid phone number before creating an account invite."));const t=await Ds({memberId:s.id,memberName:s.name,inviteePhone:s.loginPhone||"",suggestedCode:Me(s),forceNew:!0}),a="AERA invite for ".concat(s.name,": create or log in to your account, then use invite code ").concat(t.invitationCode," to join this household.");await navigator.clipboard.writeText(a),B("New invite generated for ".concat(s.name,"."));const l=await ue();_(l)}catch(t){$((t==null?void 0:t.message)||"Unable to resend invite right now.")}finally{F(null)}},rt=async s=>{const t=E[s.id];if(!(!(t!=null&&t.id)||t.status!=="PENDING")){B(null),$(null),F(s.id);try{await Et(t.id),B("Invite revoked for ".concat(s.name,"."));const a=await ue();_(a)}catch(a){$((a==null?void 0:a.message)||"Unable to revoke invite right now.")}finally{F(null)}}},it=async()=>{Q(null),me(null);const s=xe.trim().toUpperCase();if(s.length<6||s.includes("-")){Q("Enter a valid 6-character household code.");return}xs(!0);try{const t=await Rt(s);me(t.message||"Your request has been sent to the household administrator."),is("");try{const[a,l,r]=await Promise.all([be(),ge(),te(50)]);H(a),q(l),Y(r)}catch(a){}}catch(t){Q((t==null?void 0:t.message)||"Unable to submit join request.")}finally{xs(!1)}},ks=async(s,t)=>{Q(null),me(null),gs(s.id);try{await zt(s.id,t);const[a,l,r]=await Promise.all([be(),ge(),te(50)]);H(a),q(l),Y(r),me(t==="approved"?"Connection successful. This member has been added.":"Request rejected.")}catch(a){Q((a==null?void 0:a.message)||"Unable to resolve request right now.")}finally{gs(null)}},ot=async()=>{fs(!0);try{const s=Z.filter(a=>!a.read);await Promise.all(s.map(a=>Pt(a.id)));const t=await te(50);Y(t)}catch(s){}finally{fs(!1)}},dt=()=>{x.logoutUser(),N("LOGIN")},ct=()=>{if(!C)return;const s=x.getDB();Ws(s),S("DB_VIEWER")},xt=()=>{if(!C)return;const s=x.getDB();oe(s.organizations),S("ORG_DIRECTORY"),de(null)},mt=()=>{if(console.info("[AccessControl] openAccessControl clicked",{isAdmin:C}),!C){console.warn("[AccessControl] blocked: not admin");return}const s=x.getDB();console.info("[AccessControl] loading users",{count:Array.isArray(s.users)?s.users.length:0}),Se(Array.isArray(s.users)?s.users:[]),we("ALL_USERS"),S("ACCESS_CONTROL"),ie(null)},ht=()=>{if(!C)return;const s=x.getDB();oe(s.organizations),Ee(s.tickerMessage),S("BROADCAST_CONTROL")},pt=()=>{if(!C)return;const s=x.getAllReplenishmentRequests();ce(s),S("MASTER_INVENTORY")},ut=(s,t)=>{Gs(a=>{const l=a.map(r=>r.id===s?{...r,permissions:{...r.permissions,[t]:!r.permissions[t]}}:r);return x.saveRoles(l),l})},bt=(s,t)=>{C&&Se(a=>{const l=a.map(h=>h.id===s?{...h,role:t}:h),r=l.find(h=>h.id===s);return r&&x.saveProfile(r),l})},gt=(s,t)=>{if(!C)return;const a=!t;x.updateUserStatus(s,a),Se(l=>l.map(r=>r.id===s?{...r,active:a}:r)),ie(l=>l&&l.id===s?{...l,active:a}:l)},ft=()=>{const s=["ID","Name","Phone","Role","Status","Address","Community ID","Household Size"],t=Ce.map(o=>[o.id,'"'.concat(o.fullName.replace(/"/g,'""'),'"'),o.phone,o.role,o.active?"Active":"Inactive",'"'.concat(o.address.replace(/"/g,'""'),'"'),o.communityId||"N/A",o.householdMembers]),a=[s.join(","),...t.map(o=>o.join(","))].join("\n"),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(l),h=document.createElement("a");h.href=r,h.setAttribute("download","AERA_User_Directory_".concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(h),h.click(),document.body.removeChild(h)},jt=(s,t)=>{const a=!t;x.updateOrgStatus(s,a),oe(l=>l.map(r=>r.id===s?{...r,active:a}:r)),p&&p.id===s&&de(l=>l?{...l,active:a}:null)},Nt=()=>{x.updateSystemTicker(js),alert("Global System Alert Updated")},vt=s=>{x.clearOrgBroadcast(s),oe(t=>t.map(a=>a.id===s?{...a,currentBroadcast:void 0}:a))},Ue=s=>{I(t=>{const a={...t,language:s};return x.saveProfile(a),a}),c(!0),setTimeout(()=>c(!1),1e3)},yt=s=>{x.updateReplenishmentRequestStatus(s,"FULFILLED"),ce(t=>t.map(a=>a.id===s?{...a,status:"FULFILLED"}:a))},wt=s=>{x.updateReplenishmentRequestStatus(s,"PENDING"),ce(t=>t.map(a=>a.id===s?{...a,status:"PENDING"}:a))},Is=s=>{es({}),De(s)},Te=(s,t)=>{es(a=>({...a,[s]:t}))},As=(s,t)=>{if(g){x.signReplenishmentRequest(g.id,s,t);const a={...g};t==="RELEASE"?(a.signature=s,a.signedAt=new Date().toISOString()):(a.receivedSignature=s,a.receivedAt=new Date().toISOString()),De(a),ce(l=>l.map(r=>r.id===g.id?a:r))}},Ct=()=>{const s=["Request ID","Org Name","Org ID","Item","Quantity","Status","Date","Provider","Released","Received"],t=W.map(o=>[o.id,'"'.concat(o.orgName.replace(/"/g,'""'),'"'),o.orgId,'"'.concat(o.item.replace(/"/g,'""'),'"'),o.quantity,o.status,new Date(o.timestamp).toLocaleDateString(),'"'.concat(o.provider.replace(/"/g,'""'),'"'),o.signature?"Yes":"No",o.receivedSignature?"Yes":"No"]),a=[s.join(","),...t.map(o=>o.join(","))].join("\n"),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(l),h=document.createElement("a");h.href=r,h.setAttribute("download","AERA_Master_Inventory_".concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(h),h.click(),document.body.removeChild(h)},St=()=>{const s=W.reduce((U,ee)=>(U[ee.item]=(U[ee.item]||0)+ee.quantity,U),{}),t=["Item Name","Total Quantity"],a=Object.entries(s).map(([U,ee])=>['"'.concat(U.replace(/"/g,'""'),'"'),ee]),l=[t.join(","),...a.map(U=>U.join(","))].join("\n"),r=new Blob([l],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(r),o=document.createElement("a");o.href=h,o.setAttribute("download","AERA_Inventory_Tally_".concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(o),o.click(),document.body.removeChild(o)};if(g){const s=x.getOrganization(g.orgId);return e.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto bg-white p-8 font-serif text-black animate-fade-in print:p-0 print:bg-white print:text-black print:static print:overflow-visible",children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 p-4 bg-slate-900 text-white flex justify-between items-center print:hidden shadow-lg z-50",children:[e.jsx("span",{className:"font-bold",children:"Work Order Preview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",className:"bg-brand-600 text-white",onClick:()=>window.print(),children:[e.jsx(qe,{size:16,className:"mr-2"})," Print Now"]}),e.jsxs(d,{size:"sm",variant:"secondary",onClick:()=>De(null),children:[e.jsx(Tt,{size:16,className:"mr-2"})," Close"]})]})]}),e.jsxs("div",{className:"max-w-3xl mx-auto border border-black p-8 mt-16 print:mt-0 print:border-0 print:w-full",children:[e.jsxs("div",{className:"flex justify-between items-start border-b-2 border-black pb-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold uppercase tracking-tight",children:"Work Order"}),e.jsx("p",{className:"text-sm font-bold uppercase mt-1",children:"AERA Logistics Fulfillment"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Order ID:"})," ",g.id]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Printed On:"})," ",new Date().toLocaleDateString()]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Request Date:"})," ",new Date(g.timestamp).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Provider:"})," ",g.provider]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Ship To (Organization)"}),e.jsx("p",{className:"text-lg font-bold",children:g.orgName}),e.jsx("p",{children:(s==null?void 0:s.address)||"Address Unknown"}),e.jsx("p",{children:s==null?void 0:s.adminContact}),e.jsx("p",{children:s==null?void 0:s.adminPhone}),e.jsxs("p",{className:"mt-2 text-sm font-mono",children:["ID: ",g.orgId]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Fulfillment Instructions"}),e.jsx("p",{className:"text-sm mb-2",children:"Please pick and pack the items listed below. Ensure quality check is performed before release."}),e.jsxs("div",{className:"border border-black p-2 text-center mt-4",children:[e.jsx("p",{className:"text-xs uppercase font-bold",children:"Priority Status"}),e.jsx("p",{className:"text-xl font-bold",children:"URGENT"})]})]})]}),e.jsx("div",{className:"mb-12",children:e.jsxs("table",{className:"w-full border-collapse border border-black",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[e.jsx("th",{className:"border border-black p-2 text-left w-12 print:text-black",children:"#"}),e.jsx("th",{className:"border border-black p-2 text-left print:text-black",children:"Requested Item"}),e.jsx("th",{className:"border border-black p-2 text-center w-24 print:text-black",children:"Qty Req"}),e.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Qty Picked"}),e.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Verified"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-3 text-center print:text-black",children:"1"}),e.jsx("td",{className:"border border-black p-3 font-bold text-lg print:text-black",children:g.item}),e.jsx("td",{className:"border border-black p-3 text-center font-bold text-lg print:text-black",children:g.quantity}),e.jsx("td",{className:"border border-black p-1",children:e.jsx("input",{className:"w-full h-full text-center font-bold text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:Re.item_picked||"",onChange:t=>Te("item_picked",t.target.value)})}),e.jsx("td",{className:"border border-black p-1",children:e.jsx("input",{className:"w-full h-full text-center font-medium text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:Re.item_verified||"",onChange:t=>Te("item_verified",t.target.value)})})]}),[2,3].map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-3 text-center opacity-50 print:text-black",children:t}),e.jsx("td",{className:"border border-black p-2",children:e.jsxs("div",{className:"flex items-center gap-2 h-full",children:[e.jsx("span",{className:"italic text-slate-500 text-sm whitespace-nowrap print:text-black",children:"Notes/Substitutions:"}),e.jsx("input",{className:"flex-1 bg-transparent border-b border-slate-300 focus:border-blue-500 outline-none text-slate-900 print:border-none print:text-black font-mono",value:Re["note_".concat(t)]||"",onChange:a=>Te("note_".concat(t),a.target.value)})]})}),e.jsx("td",{className:"border border-black p-3"}),e.jsx("td",{className:"border border-black p-3"}),e.jsx("td",{className:"border border-black p-3"})]},t))]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-12 mt-12 pt-12",children:[e.jsxs("div",{className:"break-inside-avoid",children:[e.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Released By (Signature)"}),g.signature?e.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[e.jsx("img",{src:g.signature,alt:"Digital Signature",className:"h-16 mb-1"}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(g.signedAt||"").toLocaleString()]})]}):e.jsx("div",{className:"print:hidden",children:e.jsx(Fs,{onSave:t=>As(t,"RELEASE")})}),!g.signature&&e.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]}),e.jsxs("div",{className:"break-inside-avoid",children:[e.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Received By (Signature)"}),g.receivedSignature?e.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[e.jsx("img",{src:g.receivedSignature,alt:"Digital Signature",className:"h-16 mb-1"}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(g.receivedAt||"").toLocaleString()]})]}):e.jsx("div",{className:"print:hidden",children:e.jsx(Fs,{onSave:t=>As(t,"RECEIVE")})}),!g.receivedSignature&&e.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]})]}),e.jsx("div",{className:"text-center mt-12 text-xs text-slate-500 print:text-black",children:e.jsxs("p",{children:["Generated by AERA System • ",new Date().toLocaleString()]})})]})]})}if(D==="MASTER_INVENTORY"){const s=W.reduce((t,a)=>(t[a.item]=(t[a.item]||0)+a.quantity,t),{});return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-white min-h-screen print:p-0 print:pb-0",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-white z-10 print:hidden",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>S("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Master Inventory Database"}),e.jsx("p",{className:"text-xs text-slate-500",children:"System-Wide Supply Request Aggregation"})]})]})}),e.jsxs("div",{className:"hidden print:block mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"AERA Master Inventory Report"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Generated on ",new Date().toLocaleString()]})]}),e.jsxs("div",{className:"space-y-4 print:break-inside-avoid",children:[e.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Total Tally (All Organizations)"}),e.jsxs("button",{onClick:St,className:"text-xs font-bold text-brand-600 hover:text-brand-700 flex items-center gap-1 print:hidden",children:[e.jsx(Be,{size:14})," Export Tally CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Object.entries(s).map(([t,a])=>e.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-lg print:border-black print:bg-white print:border",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase",children:t}),e.jsx("p",{className:"text-2xl font-mono font-bold text-slate-900",children:a})]},t)),Object.keys(s).length===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No requests logged."})]})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Request Log"}),e.jsxs(d,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-50 print:hidden h-8",onClick:Ct,children:[e.jsx(Be,{size:14,className:"mr-2"})," Export Log CSV"]})]}),e.jsx("div",{className:"overflow-x-auto print:overflow-visible",children:e.jsxs("table",{className:"w-full text-left text-sm print:text-xs",children:[e.jsx("thead",{className:"print:table-header-group",children:e.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Organization"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Item"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Qty"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Date"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Status"}),e.jsx("th",{className:"p-3 font-bold text-slate-700 print:hidden",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[W.map(t=>e.jsxs("tr",{className:"print:break-inside-avoid",children:[e.jsxs("td",{className:"p-3 font-medium text-slate-900",children:[t.orgName," ",e.jsx("span",{className:"text-xs text-slate-500 block",children:t.orgId})]}),e.jsx("td",{className:"p-3 text-slate-700",children:t.item}),e.jsx("td",{className:"p-3 font-mono font-bold text-slate-900",children:t.quantity}),e.jsx("td",{className:"p-3 text-slate-500",children:new Date(t.timestamp).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat(t.status==="FULFILLED"?"bg-green-100 text-green-700 print:border print:border-black":"bg-yellow-100 text-yellow-700 print:border print:border-black"),children:t.status})}),e.jsx("td",{className:"p-3 print:hidden",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.status==="PENDING"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",onClick:()=>yt(t.id),className:"bg-green-600 hover:bg-green-700 text-xs py-1 h-8",children:[e.jsx(ia,{size:14,className:"mr-1"})," Fulfill"]}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Is(t),className:"text-xs py-1 h-8 px-2 border-slate-300",title:t.signature?"Print Work Order":"Sign Work Order",children:t.signature&&t.receivedSignature?e.jsx(qe,{size:14}):e.jsx(ta,{size:14})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Is(t),className:"text-xs py-1 h-8 px-2 border-slate-300 mr-2",title:"View Signed Order",children:t.signature&&t.receivedSignature?e.jsx(Ps,{size:14,className:"text-green-600"}):e.jsx(qe,{size:14})}),e.jsxs("button",{onClick:()=>wt(t.id),className:"text-xs text-slate-400 hover:text-blue-600 hover:underline flex items-center gap-0.5",title:"Undo Completion",children:[e.jsx(la,{size:10})," Undo"]})]})})})]},t.id)),W.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center text-slate-500",children:"No requests found."})})]})]})})]}),e.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t border-slate-300 text-center text-xs text-slate-500 fixed bottom-0 left-0 right-0",children:e.jsx("p",{children:"End of Report • AERA System"})})]})}if(D==="BROADCAST_CONTROL")return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsx("button",{onClick:()=>S("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Broadcast Control"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Manage System & Organization Alerts"})]})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-xl shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-red-900 mb-2 flex items-center gap-2",children:[e.jsx(Vt,{size:18})," Global System Alert"]}),e.jsx("p",{className:"text-xs text-red-700 mb-3",children:"This message overrides ALL organization broadcasts and is visible to every user."}),e.jsx(Rs,{className:"bg-white border-red-200 mb-3",value:js,onChange:s=>Ee(s.target.value),placeholder:"Enter high-priority system alert..."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>Ee(""),className:"text-slate-500",children:"Clear"}),e.jsx(d,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:Nt,children:"Update Global Alert"})]})]}),e.jsx("h3",{className:"font-bold text-slate-900 mt-4",children:"Active Organization Broadcasts"}),e.jsxs("div",{className:"space-y-3",children:[ke.filter(s=>s.currentBroadcast).map(s=>e.jsxs("div",{className:"bg-white border border-slate-200 p-4 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"font-bold text-slate-900",children:s.name}),e.jsx("button",{onClick:()=>vt(s.id),className:"text-xs text-red-600 font-bold hover:underline",children:"Remove"})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded text-sm text-slate-700 italic",children:['"',s.currentBroadcast,'"']}),e.jsxs("div",{className:"text-xs text-slate-400 mt-2 text-right",children:["Last Updated: ",new Date(s.lastBroadcastTime||"").toLocaleString()]})]},s.id)),ke.filter(s=>s.currentBroadcast).length===0&&e.jsx("p",{className:"text-center text-slate-400 py-4 italic",children:"No active organization broadcasts."})]})]});if(D==="DB_VIEWER")return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-900 min-h-screen text-slate-300 font-mono",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-4 sticky top-0 bg-slate-900 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>S("MAIN"),className:"p-2 -ml-2 text-slate-400 hover:text-white",children:e.jsx(L,{size:24})}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"Database Viewer"})]}),e.jsxs(d,{size:"sm",variant:"ghost",className:"text-brand-400 hover:text-brand-300 hover:bg-slate-800",onClick:()=>he(JSON.stringify(k,null,2)),children:[e.jsx(ae,{size:16,className:"mr-2"})," Copy JSON"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("h3",{className:"text-brand-400 font-bold mb-2",children:["Users (",k==null?void 0:k.users.length,")"]}),e.jsx("pre",{className:"text-xs overflow-auto max-h-60 text-slate-300",children:JSON.stringify(k==null?void 0:k.users,null,2)})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("h3",{className:"text-purple-400 font-bold mb-2",children:["Organizations (",k==null?void 0:k.organizations.length,")"]}),e.jsx("div",{className:"space-y-2",children:k==null?void 0:k.organizations.map(s=>e.jsxs("div",{className:"p-2 bg-slate-900 rounded border border-slate-600 flex justify-between",children:[e.jsx("span",{children:s.name}),e.jsx("span",{className:"text-purple-300 select-all font-bold",children:s.id})]},s.id))})]})]})]});if(D==="ORG_DIRECTORY"){const s=ke.filter(t=>t.name.toLowerCase().includes(J.toLowerCase())||t.id.toLowerCase().includes(J.toLowerCase())||t.type.toLowerCase().includes(J.toLowerCase()));return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>S("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Organization Directory"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Search and View Registered Hubs"})]})]})}),p?e.jsxs("div",{className:"animate-slide-up space-y-6",children:[e.jsxs(d,{variant:"ghost",onClick:()=>de(null),className:"pl-0 text-slate-500",children:[e.jsx(L,{size:16,className:"mr-1"})," Back to list"]}),e.jsxs("div",{className:"bg-white rounded-2xl border ".concat(p.active?"border-slate-200":"border-red-300"," shadow-lg overflow-hidden"),children:[e.jsx("div",{className:"".concat(p.active?"bg-purple-600":"bg-slate-600"," p-6 text-white"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("span",{className:"inline-block px-2 py-1 bg-white/20 rounded text-xs font-bold border border-white/30",children:p.type}),!p.active&&e.jsx("span",{className:"inline-block px-2 py-1 bg-red-500 rounded text-xs font-bold",children:"SUSPENDED"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:p.name}),e.jsxs("p",{className:"flex items-center gap-1 text-white/80 text-sm mt-1",children:[e.jsx(Fe,{size:14})," ",p.verified?"Verified Partner":"Unverified"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/60 font-bold uppercase tracking-wider",children:"Community ID"}),e.jsx("p",{className:"text-3xl font-mono font-black tracking-widest",children:p.id})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Location & Contact"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Es,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Address"}),e.jsx("p",{className:"text-sm text-slate-600",children:p.address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(He,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Admin"}),e.jsx("p",{className:"text-sm text-slate-600",children:p.adminContact}),e.jsx("p",{className:"text-xs text-slate-500",children:p.adminPhone})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Logistics Profile"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_t,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Replenishment Provider"}),e.jsx("p",{className:"text-sm text-slate-600",children:p.replenishmentProvider})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Bt,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Email"}),e.jsx("p",{className:"text-sm text-slate-600 break-all",children:p.replenishmentEmail||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ls,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Phone"}),e.jsx("p",{className:"text-sm text-slate-600",children:p.replenishmentPhone||"N/A"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx($e,{size:18,className:"text-slate-400"})," Registered Members (",Ie.length,")",Qs&&e.jsx("span",{className:"text-[11px] text-amber-600 font-semibold",children:"Using cached list"})]}),Ie.length===0?e.jsx("p",{className:"text-slate-500 text-sm italic",children:"No members linked yet."}):e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-slate-100 rounded-lg p-2 bg-slate-50",children:Ie.map(t=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 flex justify-between items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs text-white ".concat(t.status==="SAFE"?"bg-green-500":t.status==="DANGER"?"bg-red-500":"bg-slate-400"),children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:t.name}),e.jsx("p",{className:"text-[10px] text-slate-500",children:t.phone})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ".concat(t.status==="SAFE"?"bg-green-100 text-green-700":t.status==="DANGER"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-600"),children:t.status})})]},t.id))})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 border-t border-slate-200 flex justify-between items-center",children:[e.jsx(d,{size:"sm",variant:p.active?"danger":"primary",onClick:()=>jt(p.id,p.active),className:p.active?"bg-red-50 text-red-600 border border-red-200 hover:bg-red-100":"bg-green-600 text-white",children:p.active?e.jsxs(e.Fragment,{children:[e.jsx(Yt,{size:16,className:"mr-2"})," Deactivate Org"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ps,{size:16,className:"mr-2"})," Activate Org"]})}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>he(p.id),children:[e.jsx(ae,{size:16,className:"mr-2"})," Copy Code"]})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ms,{className:"absolute left-3 top-3.5 text-slate-400",size:20}),e.jsx(A,{className:"pl-10",placeholder:"Search by Name, Type, or ID...",value:J,onChange:t=>Ks(t.target.value)})]}),e.jsx("div",{className:"space-y-3",children:s.length===0?e.jsxs("div",{className:"text-center py-10 text-slate-400",children:[e.jsx(fe,{size:48,className:"mx-auto mb-2 opacity-20"}),e.jsxs("p",{children:['No organizations found matching "',J,'"']})]}):s.map(t=>e.jsxs("button",{onClick:()=>de(t),className:"w-full bg-white p-4 rounded-xl border shadow-sm hover:shadow-md transition-all text-left flex justify-between items-center group ".concat(t.active?"border-slate-200 hover:border-purple-300":"border-red-200 bg-red-50/30"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg border ".concat(t.active?"bg-purple-50 text-purple-600 border-purple-100":"bg-slate-200 text-slate-500 border-slate-300"),children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold transition-colors ".concat(t.active?"text-slate-900 group-hover:text-purple-700":"text-slate-500"),children:[t.name," ",!t.active&&e.jsx("span",{className:"text-[10px] text-red-500 ml-2 font-bold uppercase",children:"(Inactive)"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200",children:t.type}),e.jsx("span",{className:"font-mono",children:t.id})]})]})]}),e.jsx(Os,{size:20,className:"text-slate-300 group-hover:text-purple-500"})]},t.id))})]})]})}if(D==="ACCESS_CONTROL"){const s=Array.isArray(Ce)?Ce:[],t=s.filter(a=>{const l=(a.fullName||"").toLowerCase(),r=(a.phone||"").toLowerCase(),h=(a.role||"").toLowerCase(),o=Xe.toLowerCase();return l.includes(o)||r.includes(o)||h.includes(o)});return m?e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsx("button",{onClick:()=>ie(null),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(L,{size:24})}),e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Profile"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-slide-up",children:[e.jsxs("div",{className:"bg-slate-800 p-6 text-white flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-600 flex items-center justify-center text-2xl font-bold border-2 border-slate-500",children:(m.fullName||"?").charAt(0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:m.fullName||"Unnamed User"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded text-xs font-bold uppercase",children:(m.role||"UNKNOWN").replace("_"," ")}),e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold uppercase ".concat(m.active?"bg-green-500 text-white":"bg-red-500 text-white"),children:m.active?"Active":"Suspended"})]})]})]}),e.jsxs("div",{className:"text-right text-xs opacity-60 font-mono",children:["ID: ",m.id]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(Ls,{size:16,className:"text-slate-400"})," Contact Details"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Mobile Phone"}),e.jsx("a",{href:"tel:".concat(m.phone),className:"text-blue-600 font-bold hover:underline",children:m.phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Home Address"}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(Es,{size:14,className:"mt-0.5 text-slate-400"}),e.jsx("p",{className:"text-slate-900",children:m.address||"Not Provided"})]})]}),m.communityId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Community Connection"}),e.jsx("p",{className:"text-purple-700 font-bold bg-purple-50 px-2 py-1 rounded w-fit text-sm mt-1",children:m.communityId})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(Us,{size:16,className:"text-slate-400"})," Emergency Profile"]}),m.medicalNeeds&&e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-xs text-red-600 font-bold uppercase mb-1",children:"Medical Needs"}),e.jsx("p",{className:"text-red-900 font-medium text-sm",children:m.medicalNeeds})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Household"}),e.jsxs("p",{className:"text-slate-900 font-bold text-lg",children:[m.householdMembers," Member(s)"]}),Array.isArray(m.household)&&m.household.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:m.household.map(a=>e.jsxs("div",{className:"text-xs bg-slate-100 p-2 rounded flex justify-between",children:[e.jsx("span",{className:"font-bold",children:a.name}),e.jsxs("span",{className:"text-slate-500",children:[a.age," • ",a.needs||"No needs"]})]},a.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Emergency Contact"}),e.jsxs("p",{className:"text-slate-900 text-sm font-medium",children:[m.emergencyContactName," ",e.jsxs("span",{className:"text-slate-500",children:["(",m.emergencyContactRelation,")"]})]}),e.jsx("a",{href:"tel:".concat(m.emergencyContactPhone),className:"text-sm font-bold text-slate-700",children:m.emergencyContactPhone})]})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mt-4 space-y-4",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm uppercase tracking-wider",children:"Account Management"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"System Role"}),e.jsx("select",{value:m.role,onChange:a=>bt(m.id,a.target.value),className:"text-sm p-2 rounded border bg-white font-medium ".concat(m.active?"border-slate-300":"opacity-50 cursor-not-allowed"),disabled:!m.active,children:Qe.map(a=>e.jsx("option",{value:a.id,children:a.label},a.id))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Account Status"}),e.jsx(d,{size:"sm",onClick:()=>gt(m.id,m.active!==!1),className:m.active?"bg-red-100 text-red-700 hover:bg-red-200 border-red-200":"bg-green-600 text-white",children:m.active?"Suspend Account":"Activate Account"})]})]})]})]})]}):e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>S("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Directory"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Manage All Registered Users & Permissions"})]})]}),e.jsxs(d,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-100 h-9",onClick:ft,children:[e.jsx(Be,{size:16,className:"mr-2"})," Export CSV"]})]}),e.jsxs("div",{className:"flex bg-white rounded-lg p-1 border border-slate-200",children:[e.jsxs("button",{onClick:()=>we("ALL_USERS"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all ".concat(re==="ALL_USERS"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"),children:["All Users (",s.length,")"]}),e.jsx("button",{onClick:()=>we("ROLE_DEFINITIONS"),className:"flex-1 py-2 text-sm font-bold rounded-md transition-all ".concat(re==="ROLE_DEFINITIONS"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"),children:"Role Definitions"})]}),re==="ROLE_DEFINITIONS"&&e.jsx("div",{className:"space-y-4",children:Qe.map(a=>e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:a.label}),e.jsx("p",{className:"text-xs text-slate-500",children:a.description})]}),e.jsx("div",{className:"p-4 space-y-3",children:Object.entries(a.permissions).map(([l,r])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 capitalize",children:l.replace("can","").replace(/([A-Z])/g," $1").trim()}),e.jsx("button",{onClick:()=>ut(a.id,l),className:"w-10 h-5 rounded-full relative transition-colors ".concat(r?"bg-green-500":"bg-slate-300"),children:e.jsx("div",{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ".concat(r?"left-[22px]":"left-0.5")})})]},l))})]},a.id))}),re==="ALL_USERS"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ms,{className:"absolute left-3 top-3.5 text-slate-400",size:18}),e.jsx(A,{className:"pl-10 h-10",placeholder:"Search users by name, phone, or role...",value:Xe,onChange:a=>Js(a.target.value)})]}),t.map(a=>{const l=a.createdAt?new Date(a.createdAt).toLocaleDateString():"Unknown";return e.jsxs("div",{onClick:()=>ie(a),className:"bg-white p-4 rounded-xl border shadow-sm flex flex-col gap-3 cursor-pointer hover:border-brand-400 hover:shadow-md transition-all group ".concat(a.active?"border-slate-200":"border-red-200 bg-red-50/10"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full ".concat(a.active?"bg-slate-100 text-slate-600":"bg-red-100 text-red-500"),children:e.jsx(He,{size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold group-hover:text-brand-700 transition-colors ".concat(a.active?"text-slate-900":"text-slate-500 line-through"),children:a.fullName||"Unnamed User"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[a.phone||"No phone"," ",a.role==="ADMIN"&&e.jsx("span",{className:"text-brand-600 font-bold ml-1",children:"(Admin)"})]}),e.jsxs("p",{className:"text-[11px] text-slate-400",children:["Created: ",l]})]})]}),e.jsx(Os,{size:18,className:"text-slate-300 group-hover:text-brand-500"})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-100 flex justify-between items-center",children:[e.jsxs("span",{className:"text-[10px] font-bold uppercase ".concat(a.active?"text-green-600":"text-red-600"),children:["Status: ",a.active?"Active":"Deactivated"]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-slate-100 rounded text-slate-600 font-medium",children:(a.role||"UNKNOWN").replace("_"," ")})]})]},a.id)}),t.length===0&&e.jsx("p",{className:"text-center text-slate-400 py-4",children:"No users found."})]})]})}return e.jsxs("div",{className:"p-6 pb-28 space-y-8 animate-fade-in bg-slate-50 min-h-screen flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>N("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800 md:hidden",children:e.jsx(L,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:_e("settings.title")})]}),ye&&e.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center gap-1 animate-fade-in",children:[e.jsx(je,{size:16})," Saved"]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 order-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-full text-indigo-600",children:e.jsx(Ht,{size:24})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:_e("settings.language")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ue("en"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ".concat(n.language==="en"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"English"}),e.jsx("button",{onClick:()=>Ue("es"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ".concat(n.language==="es"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"Español"}),e.jsx("button",{onClick:()=>Ue("fr"),className:"flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ".concat(n.language==="fr"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"),children:"Français"})]})]}),C&&e.jsxs("section",{className:"bg-slate-900 text-white p-6 rounded-2xl shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:e.jsx(Fe,{size:80})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-brand-400 font-bold text-xs uppercase tracking-wider",children:[e.jsx(Ts,{size:12})," Administrator Area"]}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Roles & Dashboards"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{onClick:mt,className:"bg-brand-600 hover:bg-brand-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"User Directory & Access Control"}),e.jsx($e,{size:18})]}),e.jsxs(d,{onClick:xt,className:"bg-purple-600 hover:bg-purple-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Organization Directory"}),e.jsx(fe,{size:18})]}),e.jsxs(d,{onClick:pt,className:"bg-orange-600 hover:bg-orange-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Master Inventory Database"}),e.jsx(Vs,{size:18})]}),e.jsxs(d,{onClick:ht,className:"bg-red-600 hover:bg-red-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Manage Broadcasts"}),e.jsx($t,{size:18})]}),e.jsxs(d,{onClick:ct,variant:"outline",className:"border-slate-700 text-slate-300 hover:text-white hover:bg-slate-800 w-full justify-between",children:[e.jsx("span",{children:"View Raw Database"}),e.jsx(Wt,{size:18})]})]})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-brand-50 rounded-full text-brand-600",children:e.jsx(He,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Identity"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Your personal account and contact details."})]})]}),e.jsxs("div",{className:"text-xs text-slate-400 font-mono -mt-4 mb-2",children:["ID: ",n.id]}),e.jsx(A,{label:"Full Name",value:n.fullName,onChange:s=>f("fullName",s.target.value),placeholder:"e.g. Jane Doe"}),e.jsx(A,{label:"Mobile Phone",value:n.phone,onChange:s=>f("phone",Hs(s.target.value)),onBlur:()=>vs(n.phone),placeholder:"e.g. (555) 123-4567",className:Je?"border-red-500 bg-red-50":"",error:Je||void 0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Home Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{placeholder:"123 Main St...",value:n.address,onChange:s=>{O(-1),f("address",s.target.value)},onBlur:Zs,onKeyDown:et,className:"w-full px-4 py-3 rounded-lg border focus:ring-2 outline-none transition-all font-medium ".concat(P==="VALID"?"border-green-500 bg-green-50 focus:ring-green-500":P==="INVALID"?"border-red-500 bg-red-50 focus:ring-red-500":"border-slate-300 focus:ring-brand-500 focus:border-brand-500")}),M.length>0&&P!=="VERIFYING"&&e.jsx("div",{className:"absolute z-20 mt-1 w-full rounded-lg border border-slate-200 bg-white shadow-lg max-h-56 overflow-auto",children:M.map((s,t)=>e.jsx("button",{type:"button",onMouseDown:a=>a.preventDefault(),onClick:()=>ys(),className:"w-full text-left px-3 py-2 text-sm border-b border-slate-100 last:border-b-0 ".concat(t===Ke?"bg-slate-100 text-slate-900":"text-slate-700 hover:bg-slate-50"),children:s.description||"Suggested address"},"".concat(s.placeId||"addr","-").concat(t)))})]}),Ys&&P!=="VERIFYING"&&e.jsx("p",{className:"text-xs text-slate-500 font-semibold mt-1",children:"Finding address suggestions..."}),P==="VERIFYING"&&e.jsx("p",{className:"text-xs text-slate-500 font-semibold mt-1",children:"Verifying with Google Maps..."}),P==="VALID"&&e.jsx("p",{className:"text-xs text-green-600 font-bold mt-1",children:"Verified with Google Maps"}),P==="INVALID"&&e.jsx("p",{className:"text-xs text-red-600 font-bold mt-1",children:"Address not found on Maps"}),P==="VALID"&&G&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Verified on ",G]}),ne&&e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-3 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2",children:[e.jsxs("p",{className:"text-xs font-semibold text-amber-800 flex items-center gap-1",children:[e.jsx(Ts,{size:13})," Address verification required before saving."]}),e.jsx("button",{type:"button",onClick:()=>Le(n.address),className:"text-xs font-bold text-amber-800 hover:text-amber-900 underline",children:"Retry"})]})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"Emergency Contact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(A,{placeholder:"Contact Name",value:n.emergencyContactName,onChange:s=>f("emergencyContactName",s.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(A,{placeholder:"Mobile Phone",type:"tel",value:n.emergencyContactPhone,onChange:s=>f("emergencyContactPhone",Hs(s.target.value))}),e.jsx(A,{placeholder:"Relationship",value:n.emergencyContactRelation,onChange:s=>f("emergencyContactRelation",s.target.value)})]})]})]}),e.jsxs(d,{onClick:st,fullWidth:!0,className:"shadow-md mt-4 bg-slate-800 hover:bg-slate-700",size:"lg",disabled:ss,children:[e.jsx(Ft,{size:20,className:"mr-2"})," ",ss?"Saving...":"Update Profile"]}),ls&&e.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:ls})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-emerald-100 order-30",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:e.jsx($e,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Your Home"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Household code connects family members to the same home."})]})]}),e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4 flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase tracking-wider",children:"Household Code"}),e.jsx("p",{className:"text-2xl font-mono font-black tracking-widest text-emerald-900",children:n.householdCode||"------"}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-1",children:[n.householdName||"Your Home"," • ",n.householdRole||"OWNER"]})]}),e.jsxs(d,{size:"sm",variant:"ghost",onClick:()=>he(n.householdCode||""),disabled:!n.householdCode,className:"text-emerald-800 hover:bg-emerald-100",children:[e.jsx(ae,{size:16,className:"mr-2"})," Copy"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-3 items-end",children:[e.jsx(A,{label:"Request Home Join by Code",placeholder:"e.g. A3K7Q2",value:xe,onChange:s=>is(s.target.value.toUpperCase()),maxLength:6}),e.jsx(d,{onClick:it,disabled:cs||xe.trim().length<6||xe.includes("-"),children:cs?"Sending...":"Send Request"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Your request has been sent to the household administrator and requires approval."}),pe&&e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide font-bold text-slate-500",children:"Latest Join Request"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-900 mt-1",children:["Status: ",pe.status==="pending"?"Pending Approval":pe.status==="approved"?"Approved":"Rejected"]}),e.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Submitted ",new Date(pe.createdAt).toLocaleString()]})]}),os&&e.jsx("p",{className:"text-xs text-red-600 font-semibold",children:os}),ds&&e.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:ds}),n.householdRole==="OWNER"&&e.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4 space-y-3",children:[e.jsxs("p",{className:"text-xs font-bold text-amber-700 uppercase tracking-wider",children:["New Household Join Request",Oe.length===1?"":"s"]}),Oe.length===0?e.jsx("p",{className:"text-xs text-amber-700",children:"No pending requests."}):e.jsx("div",{className:"space-y-2",children:Oe.map(s=>e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-white p-3 flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.requestingUserName||"AERA user"}),e.jsx("p",{className:"text-[11px] text-slate-500",children:s.requestingUserPhone||s.requestingUserEmail||"No contact preview available"}),e.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Requested ",new Date(s.createdAt).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",onClick:()=>ks(s,"approved"),disabled:Pe===s.id,children:Pe===s.id?"Working...":"Approve"}),e.jsx(d,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:()=>ks(s,"rejected"),disabled:Pe===s.id,children:"Reject"})]})]},s.id))})]}),e.jsxs("div",{className:"rounded-xl border border-indigo-200 bg-indigo-50 p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs font-bold text-indigo-700 uppercase tracking-wider",children:"Notifications"}),e.jsxs(d,{size:"sm",variant:"ghost",className:"text-indigo-700 hover:bg-indigo-100",onClick:ot,disabled:Xs||Ss===0,children:["Mark Read (",Ss,")"]})]}),Z.length===0?e.jsx("p",{className:"text-xs text-indigo-700",children:"No notifications yet."}):e.jsx("div",{className:"space-y-1",children:Z.slice(0,5).map(s=>e.jsxs("div",{className:"rounded-md border px-3 py-2 text-xs ".concat(s.read?"border-indigo-100 bg-white text-slate-500":"border-indigo-300 bg-white text-slate-800 font-semibold"),children:[e.jsx("p",{children:s.type==="household_join_request"?"New Household Join Request":s.type==="household_join_approved"?"Your request was approved.":s.type==="household_join_rejected"?"Your request was not approved.":s.type}),e.jsx("p",{className:"text-[10px] mt-0.5 opacity-80",children:new Date(s.createdAt).toLocaleString()})]},s.id))})]}),e.jsx("div",{children:e.jsx(A,{label:"Household Size",type:"number",min:1,value:String(n.householdMembers||1),onChange:s=>f("householdMembers",Math.max(1,Number(s.target.value)||1))})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Who lives in your home"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Each member requires DOB in MM/DD/YYYY. Young children and seniors are flagged automatically."}),e.jsx(Ut,{members:n.household,onChange:s=>f("household",s)})]}),e.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4 space-y-3",children:[e.jsx("div",{children:e.jsx("p",{className:"text-xs font-bold text-emerald-700 uppercase tracking-wider",children:"Member Account Invites"})}),Cs.length===0?e.jsx(e.Fragment,{}):e.jsx("div",{className:"space-y-2",children:Cs.map(s=>{var t,a,l;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-emerald-200 bg-white p-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-xs text-slate-600",children:["Invite Code: ",e.jsx("span",{className:"font-mono font-bold tracking-wider",children:((t=E[s.id])==null?void 0:t.invitationCode)||Me(s)})]}),e.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Bound phone: ",da(((a=E[s.id])==null?void 0:a.inviteePhone)||s.loginPhone||"")||"Not set"]}),!se(s.loginPhone||"")&&e.jsx("p",{className:"text-[11px] text-amber-700 mt-0.5",children:"Add a valid member phone in Household Members before creating an invite."}),E[s.id]&&e.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",E[s.id].status,E[s.id].expiresAt?" • Expires ".concat(new Date(E[s.id].expiresAt).toLocaleDateString()):""]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(d,{size:"sm",variant:"ghost",className:"text-emerald-800 hover:bg-emerald-100",onClick:()=>nt(s),disabled:X===s.id||!se(s.loginPhone||""),children:[e.jsx(ae,{size:14,className:"mr-1"})," ",X===s.id?"Working...":"Copy"]}),e.jsx(d,{size:"sm",variant:"ghost",className:"text-slate-700 hover:bg-slate-100",onClick:()=>lt(s),disabled:X===s.id||!se(s.loginPhone||""),children:X===s.id?"Working...":"Resend"}),((l=E[s.id])==null?void 0:l.status)==="PENDING"&&e.jsx(d,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:()=>rt(s),disabled:X===s.id,children:"Revoke"})]})]},s.id)})}),hs&&e.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:hs}),ps&&e.jsx("p",{className:"text-xs text-red-600 font-semibold",children:ps})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-red-100 order-20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-full text-red-600",children:e.jsx(Us,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Safety Setup"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Preparedness and vulnerability inputs for planning."})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"ZIP Code"}),e.jsx("p",{className:"text-sm font-semibold text-slate-900 mt-1",children:n.zipCode||"Not detected yet"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"From your Home Address"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Medical"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Medication Dependency"}),e.jsx("input",{type:"checkbox",checked:!!n.medicationDependency,onChange:s=>f("medicationDependency",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Insulin Dependency"}),e.jsx("input",{type:"checkbox",checked:!!n.insulinDependency,onChange:s=>f("insulinDependency",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3 md:col-span-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Oxygen / Powered Medical Device"}),e.jsx("input",{type:"checkbox",checked:!!n.oxygenPoweredDevice,onChange:s=>f("oxygenPoweredDevice",s.target.checked)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Accessibility"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Mobility Limitation"}),e.jsx("input",{type:"checkbox",checked:!!n.mobilityLimitation,onChange:s=>f("mobilityLimitation",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Transportation Access"}),e.jsx("input",{type:"checkbox",checked:!!n.transportationAccess,onChange:s=>f("transportationAccess",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3 md:col-span-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Financial Strain"}),e.jsx("input",{type:"checkbox",checked:!!n.financialStrain,onChange:s=>f("financialStrain",s.target.checked)})]})]})]}),e.jsx(A,{label:"Pets",placeholder:"e.g. 2 Dogs",value:n.petDetails,onChange:s=>f("petDetails",s.target.value)}),e.jsx(Rs,{label:"Anything else not listed above",value:n.medicalNeeds,onChange:s=>f("medicalNeeds",s.target.value)}),e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("p",{className:"text-[11px] font-bold text-slate-600 uppercase tracking-wide",children:"Final Step"}),e.jsx("p",{className:"text-sm font-bold text-slate-800 mt-1",children:"Confirm preparedness consent"})]}),e.jsxs("label",{className:"flex items-start gap-3 rounded-lg border border-emerald-200 bg-emerald-50 p-3",children:[e.jsx("input",{className:"mt-1",type:"checkbox",checked:!!n.consentPreparednessPlanning,onChange:s=>f("consentPreparednessPlanning",s.target.checked)}),e.jsx("span",{className:"text-sm text-emerald-900 font-semibold",children:"I understand this data is used only for preparedness planning and can be deleted anytime."})]}),e.jsx(d,{onClick:tt,fullWidth:!0,className:"bg-red-50 border border-red-200 text-red-700 hover:bg-red-100 shadow-sm",disabled:as,children:as?"Saving...":"Update Vitals"}),rs&&e.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:rs})]}),e.jsxs("section",{ref:j,className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-purple-100 relative overflow-hidden order-40",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(fe,{size:64,className:"text-purple-600"})}),e.jsxs("div",{className:"flex items-center gap-4 mb-2 relative z-10",children:[e.jsx("div",{className:"p-3 bg-purple-50 rounded-full text-purple-600",children:e.jsx(fe,{size:24})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:_e("settings.trusted_conn")})]}),n.role==="INSTITUTION_ADMIN"?e.jsxs("div",{className:"relative z-10 space-y-3",children:[e.jsxs("div",{className:"bg-purple-100 border border-purple-200 p-4 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-purple-600 uppercase tracking-wider",children:"Your Organization ID"}),e.jsx("p",{className:"text-2xl font-mono font-black text-purple-900 tracking-widest",children:n.communityId||"NOT SET"})]}),e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>he(n.communityId),className:"text-purple-700 hover:bg-purple-200",children:e.jsx(ae,{size:20})})]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{label:"Change Organization ID",value:n.communityId,onChange:s=>{f("communityId",qs(s.target.value)),w(null),z(null)},className:y?"border-green-500 focus:ring-green-500 bg-green-50/30":T?"border-red-500 focus:ring-red-500":""}),e.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"Format: CH-1234"})]}),e.jsx(d,{className:"mb-[1px] min-w-[50px] ".concat(y?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"),onClick:ws,disabled:b||!n.communityId,children:b?e.jsx(_s,{className:"animate-spin",size:20}):y?e.jsx(je,{size:20}):e.jsx($s,{size:20})})]}),T&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[e.jsx(Bs,{size:16})," ",T]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-3 items-end relative z-10",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{label:"Community ID",value:n.communityId,onChange:s=>{f("communityId",qs(s.target.value)),w(null),z(null)},className:y?"border-green-500 focus:ring-green-500 bg-green-50/30":T?"border-red-500 focus:ring-red-500":""}),e.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:"Format: CH-1234"})]}),e.jsx(d,{className:"mb-[1px] min-w-[50px] ".concat(y?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"),onClick:ws,disabled:b||!n.communityId,children:b?e.jsx(_s,{className:"animate-spin",size:20}):y?e.jsx(je,{size:20}):e.jsx($s,{size:20})})]}),y&&e.jsxs("p",{className:"text-xs font-semibold text-emerald-700 relative z-10",children:["Connected to ",y,"."]}),T&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[e.jsx(Bs,{size:16})," ",T]}),e.jsxs("div",{className:"relative z-10 mt-4 border-t border-slate-200 pt-3",children:[e.jsx("p",{className:"text-[11px] text-slate-500 mb-2",children:"Advanced"}),e.jsx(d,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50",onClick:at,disabled:Ye||!n.communityId,children:Ye?"Disconnecting...":"Disconnect Organization"})]})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 order-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:e.jsx(Fe,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Legal & Consent"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Privacy policy and proof of consent"})]})]}),e.jsxs(d,{onClick:()=>{sessionStorage.setItem("privacyReturnView","SETTINGS"),N("PRIVACY_POLICY")},variant:"outline",className:"w-full justify-between",children:[e.jsx("span",{children:"View Proof of Consent & Privacy Policy"}),e.jsx(Vs,{size:18})]})]}),e.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-200 order-60",children:e.jsxs(d,{onClick:dt,variant:"ghost",fullWidth:!0,className:"text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(ea,{className:"mr-2",size:18}),"Log Out"]})})]})};export{Va as SettingsView};
