import{c as pe,r as a,S as d,P as $,Q as We,T as Te,j as e,U as Ke,V as qe}from"./index-CJzEU5Yr.js";import{B as m}from"./Button-CnRUMJhP.js";import{g as He,a as Ge}from"./inventoryStatus-BGlXoNrp.js";import{t as n}from"./translations-Btzq2RVP.js";import{T as Qe}from"./Input-BlISMA55.js";import{G as Ve}from"./mockGenAI-BPqgTz-A.js";import{X as Ye}from"./x-pd8-DY5F.js";import{B as xe}from"./building-2-DB6iRbBB.js";import{O as Xe}from"./octagon-alert-B4cGnMXb.js";import{L as me}from"./loader-circle-C2oGxQGC.js";import{S as Je}from"./shield-check-e7FEkpgI.js";import{A as W}from"./arrow-left-BvMvYESN.js";import{C as Ze}from"./copy-Xk1H1Rjz.js";import{C as T}from"./circle-check-big-CYJ0xDz3.js";import{T as K}from"./triangle-alert-D1dmY0gz.js";import{C as he}from"./circle-question-mark-D54SVZB8.js";import{B as es,W as ss}from"./wifi-off-ulZLCF6f.js";import{U as ts}from"./user-jnEtzzBn.js";import{P as as}from"./phone-CIamh-IK.js";import{H as ls,S as ns}from"./save-CJzrS06H.js";import{M as rs}from"./map-pin-CUrl_rxU.js";import{P as os}from"./package-CHaoN4mZ.js";import{T as is}from"./truck-DXMNKKFf.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ue=pe("send",ds);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],xs=pe("wand-sparkles",cs),Fs=({setView:be})=>{const ge=s=>({id:String((s==null?void 0:s.id)||""),name:String((s==null?void 0:s.name)||"Unknown Member"),status:(s==null?void 0:s.status)||"UNKNOWN",lastUpdate:String((s==null?void 0:s.lastUpdate)||(s==null?void 0:s.last_update)||"Unknown"),location:String((s==null?void 0:s.location)||"Unknown"),needs:Array.isArray(s==null?void 0:s.needs)?s.needs:[],phone:String((s==null?void 0:s.phone)||""),address:String((s==null?void 0:s.address)||""),emergencyContactName:String((s==null?void 0:s.emergencyContactName)||(s==null?void 0:s.emergency_contact_name)||""),emergencyContactPhone:String((s==null?void 0:s.emergencyContactPhone)||(s==null?void 0:s.emergency_contact_phone)||""),emergencyContactRelation:String((s==null?void 0:s.emergencyContactRelation)||(s==null?void 0:s.emergency_contact_relation)||"")}),O=s=>Array.isArray(s)?s.map(ge):[],[b,A]=a.useState([]),[h,y]=a.useState({water:0,food:0,blankets:0,medicalKits:0}),[g,I]=a.useState("MEMBERS"),[N,fe]=a.useState("Community Organization"),[o,je]=a.useState(""),[Ne,ve]=a.useState(0),[q,f]=a.useState([]),[P,ye]=a.useState(!1),[z,H]=a.useState(!1),[,G]=a.useState(!1),[l,k]=a.useState(null),[w,ke]=a.useState("Central Warehouse"),[ms,we]=a.useState(""),[Q,V]=a.useState(!1),[L,Se]=a.useState({safe:0,danger:0,unknown:0}),[Ce,S]=a.useState(!1),[Ee,Y]=a.useState(!1),[F,X]=a.useState("Water Cases"),[_,J]=a.useState(10),[Z,ee]=a.useState(!navigator.onLine),[se,te]=a.useState(!1),[D,ae]=a.useState([]),[B,le]=a.useState([]),[ne,Re]=a.useState(""),[Me,C]=a.useState(!1),[p,re]=a.useState(""),[Oe,U]=a.useState("COMPOSE"),[oe,E]=a.useState(!1),[ie,R]=a.useState(null);a.useEffect(()=>{const t=d.getProfile().communityId||"CH-9921";je(t);const i=d.getOrganization(t);i&&(fe(i.name),ke(i.replenishmentProvider||"General Aid Pool"),we(i.replenishmentEmail||""),ve(i.registeredPopulation||0)),A(O(d.getOrgMembers(t))),d.fetchOrgMembersRemote(t).then(({members:r,fromCache:u})=>{A(O(r)),G(u)}).catch(()=>G(!0)),d.fetchOrgInventoryRemote(t).then(({inventory:r,fromCache:u})=>{y(r),ye(u)}),$(t).then(r=>{H(!1),f(r)}).catch(()=>{H(!0),f(d.getOrgReplenishmentRequests(t))}),d.fetchMemberStatus(t).then(r=>{var u;r!=null&&r.counts&&Se(r.counts),(u=r==null?void 0:r.members)!=null&&u.length&&A(O(r.members))}),We(t).then(r=>ae(r)).catch(()=>ae([])),Te(t).then(r=>le(r)).catch(()=>le([]));const c=()=>ee(!1),x=()=>ee(!0);return window.addEventListener("online",c),window.addEventListener("offline",x),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",x)}},[]);const v={total:b.length,safe:L.safe||b.filter(s=>s.status==="SAFE").length,danger:L.danger||b.filter(s=>s.status==="DANGER").length,unknown:L.unknown||b.filter(s=>s.status==="UNKNOWN").length},de=b.filter(s=>s.name.toLowerCase().includes(ne.trim().toLowerCase())),M=v.total||Ne,Ae=(s,t)=>{const i=Math.max(0,Number.isFinite(t)?t:0);y(c=>({...c,[s]:i})),V(!0)},Ie=()=>{const s="Water: ".concat(h.water,"\nFood: ").concat(h.food,"\nBlankets: ").concat(h.blankets,"\nMed Kits: ").concat(h.medicalKits,"\n\nSave these counts?");window.confirm(s)&&(d.updateOrgInventory(o,h),d.saveOrgInventoryRemote(o,h),V(!1),alert("Inventory Updated in Central Database"))},Pe=async()=>{try{await navigator.clipboard.writeText(o),alert("Copied Community ID: ".concat(o));return}catch(s){}try{const s=document.createElement("textarea");s.value=o,s.style.position="fixed",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();const t=document.execCommand("copy");document.body.removeChild(s),alert(t?"Copied Community ID: ".concat(o):"Community ID: ".concat(o))}catch(s){alert("Community ID: ".concat(o))}},ze=()=>{re(""),U("COMPOSE"),R(null),C(!0)},Le=async s=>{var t;E(!0),R(null);try{const x=(t=(await new Ve({apiKey:"PLACEHOLDER_API_KEY"}).models.generateContent({model:"gemini-2.5-flash",contents:'Analyze this broadcast message for an emergency app: "'.concat(s,'". \n        Does it contain profanity, hate speech, threats, or extremely rude language? \n        If it is safe and appropriate for public broadcast, return strictly "SAFE". \n        If it contains prohibited content, return "UNSAFE".')})).text)==null?void 0:t.trim().toUpperCase();return E(!1),x!=null&&x.includes("SAFE")&&!(x!=null&&x.includes("UNSAFE"))?!0:(R("Message flagged as inappropriate or rude by AI system."),!1)}catch(i){return console.error("Moderation failed",i),["hate","kill","stupid","idiot","damn","hell"].some(x=>s.toLowerCase().includes(x))?(R("Message contains prohibited words."),E(!1),!1):(E(!1),!0)}},Fe=async()=>{if(!p.trim())return;await Le(p)&&U("CONFIRM")},_e=()=>{p.trim()&&(d.updateOrgBroadcast(o,p),C(!1),alert("Broadcast sent to all members linked to ".concat(N,".")))},De=()=>{if(l){const s=d.sendPing(l.id);alert(s?"Ping sent to ".concat(l.name,". They will see a status check prompt on their dashboard."):"Failed to ping member.")}},Be=async()=>{try{try{await Ke(o,{item:F,quantity:_,provider:w,orgName:N});const s=await $(o);f(s)}catch(s){console.warn("API request failed, using local storage:",s),d.createReplenishmentRequest(o,{item:F,quantity:_,provider:w,orgName:N});const t=d.getOrgReplenishmentRequests(o);f(t)}Y(!0)}catch(s){console.error(s),alert("Failed to submit request. Please try again.")}setTimeout(()=>{S(!1),Y(!1)},4e3)},Ue=s=>{const t=s.quantity,i=window.prompt("Enter stocked quantity for ".concat(s.item,":"),String(t));if(i===null)return;const c=parseInt(i);if(!Number.isFinite(c)||c<0){alert("Enter a valid non-negative quantity.");return}te(!0),qe(s.id,{status:"STOCKED",deliveredQuantity:c}).then(async()=>{const x=await $(o);f(x),d.fetchOrgInventoryRemote(o).then(y)}).catch(()=>{console.warn("API update failed, using local storage");const r={[s.item.toLowerCase().includes("water")?"water":s.item.toLowerCase().includes("food")?"food":s.item.toLowerCase().includes("blanket")?"blankets":"medicalKits"]:c};d.stockReplenishment(s.id,r);const u=d.getOrgReplenishmentRequests(o);f(u);const $e=d.getOrgInventory(o);y($e)}).finally(()=>te(!1))},j=He(h,M),ce=[{label:"Water Cases",key:"water",unit:"cases"},{label:"Food Boxes",key:"food",unit:"boxes"},{label:"Blankets",key:"blankets",unit:"units"},{label:"Med Kits",key:"medicalKits",unit:"kits"}].filter(s=>j[s.key].level==="LOW");return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col pb-safe animate-fade-in relative",children:[(P||z)&&e.jsxs("div",{className:"mx-4 mb-2 text-xs text-amber-700 font-semibold bg-amber-50 border border-amber-200 rounded-lg p-2 flex items-center justify-between",children:[e.jsxs("span",{children:[P&&"Using cached inventory",P&&z?" • ":"",z&&"Using cached requests"]}),e.jsx("span",{className:"text-amber-500",children:"Check API connection"})]}),Me&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-slide-up",children:[e.jsxs("div",{className:"bg-slate-900 text-white p-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(ue,{size:18})," ",n("org.broadcast")]}),e.jsx("button",{onClick:()=>C(!1),className:"text-slate-400 hover:text-white",children:e.jsx(Ye,{size:24})})]}),e.jsx("div",{className:"p-6",children:Oe==="COMPOSE"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-600 font-medium bg-brand-50 p-2 rounded-lg",children:[e.jsx(xe,{size:16}),e.jsxs("span",{children:["Sending to members of ",e.jsx("strong",{children:N})]})]}),e.jsx(Qe,{label:"Message Content",placeholder:"e.g., Food distribution starts at 2PM in the main hall...",value:p,onChange:s=>re(s.target.value),className:"min-h-[120px] text-lg font-medium"}),ie&&e.jsxs("div",{className:"bg-red-50 text-red-600 text-sm font-bold p-3 rounded-lg flex items-center gap-2 animate-pulse",children:[e.jsx(Xe,{size:16})," ",ie]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(m,{variant:"ghost",fullWidth:!0,onClick:()=>C(!1),children:"Cancel"}),e.jsx(m,{fullWidth:!0,disabled:!p.trim()||oe,onClick:Fe,children:oe?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"animate-spin mr-2",size:18})," Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xs,{className:"mr-2",size:18})," Review"]})})]})]}):e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-full flex items-center justify-center mx-auto text-brand-600 mb-2",children:e.jsx(Je,{size:32})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-900 mb-2",children:"Message Approved"}),e.jsx("p",{className:"text-slate-500 text-sm mb-4",children:"Ready to broadcast to your community members:"}),e.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border border-slate-200 text-slate-900 font-medium text-left italic",children:['"',p,'"']})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:"secondary",fullWidth:!0,onClick:()=>U("COMPOSE"),children:"Edit"}),e.jsx(m,{fullWidth:!0,className:"bg-brand-600 hover:bg-brand-700 text-white font-bold",onClick:_e,children:"SEND NOW"})]})]})})]})}),e.jsxs("div",{className:"bg-white border-b border-slate-200 p-4 sticky top-0 z-20 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>be("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(W,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg text-slate-900 leading-tight",children:N}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-brand-600 font-bold bg-brand-50 px-2 py-0.5 rounded w-fit mt-1",children:[e.jsx(xe,{size:12})," ",n("org.verified")]})]})]}),e.jsxs(m,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-50",onClick:ze,children:[e.jsx(ue,{size:16,className:"mr-2"})," ",n("org.broadcast")]})]}),e.jsxs("div",{className:"bg-slate-900 text-white p-3 rounded-xl mb-4 flex items-center justify-between shadow-md",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider",children:n("org.code")}),e.jsx("p",{className:"text-xl font-mono font-black tracking-widest text-brand-400",children:o})]}),e.jsxs(m,{size:"sm",className:"bg-slate-700 hover:bg-slate-600 text-white border-0",onClick:Pe,children:[e.jsx(Ze,{size:16,className:"mr-2"})," ",n("org.copy")]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-red-50 border border-red-100 p-2 rounded-lg text-center",children:[e.jsx("span",{className:"block text-2xl font-bold text-red-600",children:v.danger}),e.jsx("span",{className:"text-xs text-red-800 font-bold uppercase",children:n("status.danger")})]}),e.jsxs("div",{className:"bg-green-50 border border-green-100 p-2 rounded-lg text-center",children:[e.jsx("span",{className:"block text-2xl font-bold text-green-600",children:v.safe}),e.jsx("span",{className:"text-xs text-green-800 font-bold uppercase",children:n("status.safe")})]}),e.jsxs("div",{className:"bg-slate-100 border border-slate-200 p-2 rounded-lg text-center",children:[e.jsx("span",{className:"block text-2xl font-bold text-slate-600",children:v.unknown}),e.jsx("span",{className:"text-xs text-slate-500 font-bold uppercase",children:n("status.unknown")})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 font-bold mt-2",children:["Total Members: ",v.total]})]}),e.jsxs("div",{className:"flex bg-white border-b border-slate-200",children:[e.jsx("button",{onClick:()=>{I("MEMBERS"),k(null)},className:"flex-1 py-3 text-sm font-bold border-b-2 transition-colors ".concat(g==="MEMBERS"?"border-brand-600 text-brand-700":"border-transparent text-slate-500"),children:n("org.tab.members")}),e.jsx("button",{onClick:()=>{I("PREPAREDNESS"),k(null)},className:"flex-1 py-3 text-sm font-bold border-b-2 transition-colors ".concat(g==="PREPAREDNESS"?"border-brand-600 text-brand-700":"border-transparent text-slate-500"),children:n("org.tab.preparedness")}),e.jsx("button",{onClick:()=>I("INVENTORY"),className:"flex-1 py-3 text-sm font-bold border-b-2 transition-colors ".concat(g==="INVENTORY"?"border-brand-600 text-brand-700":"border-transparent text-slate-500"),children:n("org.tab.inventory")})]}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[g==="MEMBERS"&&(l?e.jsxs("div",{className:"space-y-6 animate-slide-up",children:[e.jsxs(m,{variant:"ghost",onClick:()=>k(null),className:"pl-0 text-slate-500",children:[e.jsx(W,{size:16,className:"mr-1"})," Back to list"]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-6 ".concat(l.status==="SAFE"?"bg-green-600":l.status==="DANGER"?"bg-red-600":"bg-slate-600"," text-white"),children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-white/20 flex items-center justify-center font-bold text-2xl border-2 border-white/30",children:l.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:l.name}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1 bg-black/20 w-fit px-2 py-0.5 rounded text-xs font-bold uppercase",children:[l.status==="SAFE"&&e.jsx(T,{size:12}),l.status==="DANGER"&&e.jsx(K,{size:12}),l.status==="UNKNOWN"&&e.jsx(he,{size:12}),l.status]})]})]})})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-purple-900 font-bold text-sm",children:"Status Check"}),e.jsx("p",{className:"text-purple-700 text-xs",children:"Request immediate update."})]}),e.jsxs(m,{size:"sm",onClick:De,className:"bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(es,{size:16,className:"mr-2"})," Ping Member"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(ts,{size:18,className:"text-slate-400"})," Contact Info"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Phone"}),e.jsxs("a",{href:"tel:".concat(l.phone),className:"text-blue-600 font-bold hover:underline flex items-center gap-1",children:[e.jsx(as,{size:14})," ",l.phone||"N/A"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Home Address"}),e.jsx("p",{className:"text-slate-900",children:l.address||"Not Provided"})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-xs text-red-600 font-bold uppercase mb-1",children:"Emergency Contact"}),e.jsx("div",{className:"text-slate-900 font-medium",children:l.emergencyContactName?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[l.emergencyContactName," (",l.emergencyContactRelation,")"]}),e.jsx("a",{href:"tel:".concat(l.emergencyContactPhone),className:"text-red-700 hover:underline font-bold text-sm",children:l.emergencyContactPhone})]}):e.jsx("p",{children:"None Listed"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(ls,{size:18,className:"text-slate-400"})," Current Status"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Last Location"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-900",children:[e.jsx(rs,{size:16,className:"text-slate-400"}),l.location]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Last Update"}),e.jsx("p",{className:"text-slate-900",children:l.lastUpdate})]}),l.needs.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase mb-1",children:"Reported Needs"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.needs.map(s=>e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded",children:s},s))})]})]})]})]})]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 mb-1",children:"Search Members"}),e.jsx("input",{value:ne,onChange:s=>Re(s.target.value),placeholder:"Search by first or last name",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500"})]}),de.length===0&&e.jsx("p",{className:"text-center text-slate-500 mt-8",children:b.length===0?"No members linked to ".concat(o," yet."):"No members match your search."}),de.map(s=>e.jsxs("div",{onClick:()=>k(s),className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between cursor-pointer hover:border-brand-400 hover:shadow-md transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ".concat(s.status==="SAFE"?"bg-green-500":s.status==="DANGER"?"bg-red-500":"bg-slate-400"),children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 group-hover:text-brand-700 transition-colors",children:s.name}),e.jsxs("p",{className:"text-xs text-slate-600 font-medium",children:[s.location," • ",s.lastUpdate]}),s.needs.length>0&&e.jsx("div",{className:"flex gap-1 mt-1",children:s.needs.map(t=>e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-red-100 text-red-700 rounded font-bold uppercase",children:t},t))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="SAFE"&&e.jsx(T,{className:"text-green-500"}),s.status==="DANGER"&&e.jsx(K,{className:"text-red-500 animate-pulse"}),s.status==="UNKNOWN"&&e.jsx(he,{className:"text-slate-300"}),e.jsx(W,{size:16,className:"text-slate-300 rotate-180 group-hover:text-brand-500 transition-colors"})]})]},s.id))]})),g==="PREPAREDNESS"&&e.jsxs("div",{className:"space-y-3",children:[D.length>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-900 mb-2",children:n("org.outreach.title")}),e.jsx("div",{className:"space-y-2",children:D.slice(0,8).map((s,t)=>{const i=s.outreach_flag==="HIGH"?"bg-red-100 text-red-700 border-red-200":s.outreach_flag==="MEDIUM"?"bg-amber-100 text-amber-700 border-amber-200":"bg-emerald-100 text-emerald-700 border-emerald-200";return e.jsxs("div",{className:"bg-white border border-amber-100 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:s.county_id||s.state_id||"Organization Scope"}),e.jsxs("p",{className:"text-sm text-slate-700",children:[s.member_count," members • Updated ",new Date(s.last_updated).toLocaleString()]})]}),e.jsx("span",{className:"px-2 py-1 text-[11px] border rounded font-bold ".concat(i),children:s.outreach_flag})]},"".concat(s.county_id||"state","-").concat(t))})})]}),B.length>0&&e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 mb-2",children:n("org.gaps.title")}),e.jsx("div",{className:"space-y-2",children:B.slice(0,20).map(s=>{const t=Math.round(Number(s.readiness_score||0)),i=s.risk_tier==="HIGH"?"bg-red-100 text-red-700 border-red-200":s.risk_tier==="ELEVATED"?"bg-amber-100 text-amber-700 border-amber-200":"bg-emerald-100 text-emerald-700 border-emerald-200";return e.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:s.member_name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.phone||"No phone"," • ",s.critical_missing_count," critical missing"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase font-bold",children:n("org.gaps.readiness")}),e.jsxs("p",{className:"text-sm font-black text-slate-900",children:[t,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-[10px] px-2 py-1 border rounded font-bold uppercase ".concat(i),children:s.risk_tier}),s.outreach_flags.slice(0,3).map(c=>e.jsx("span",{className:"text-[10px] px-2 py-1 rounded bg-purple-100 text-purple-700 font-bold",children:c},c))]}),s.critical_missing_items.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:[n("org.gaps.missing"),": ",s.critical_missing_items.slice(0,3).map(c=>c.item||"Critical item").join(", ")]})]},s.profile_id)})})]}),D.length===0&&B.length===0&&e.jsx("div",{className:"bg-white border border-slate-200 rounded-xl p-4 text-sm text-slate-600",children:n("org.gaps.none")})]}),g==="INVENTORY"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(os,{className:"text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-blue-900",children:n("org.manage_res")}),e.jsx("p",{className:"text-sm text-blue-800",children:n("org.manage_desc")})]})]}),M>0&&ce.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(K,{size:18}),e.jsxs("p",{className:"font-bold text-sm",children:["Low stock relative to population of ",M]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:ce.map(s=>{const t=Ge(h[s.key],M)||0;return e.jsxs("div",{className:"bg-white border border-red-100 rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold text-red-700 text-sm",children:s.label}),e.jsx("span",{className:"text-[11px] font-bold text-red-600",children:"LOW"})]}),e.jsxs("p",{className:"text-xs text-slate-600 mt-1",children:["Current: ",e.jsxs("span",{className:"font-bold",children:[h[s.key]," ",s.unit]})]}),e.jsxs("p",{className:"text-xs text-slate-600",children:["Recommend: ",e.jsxs("span",{className:"font-bold",children:[t," ",s.unit]})," to reach 80% coverage"]}),e.jsx(m,{size:"sm",className:"mt-2 w-full",onClick:()=>{X(s.label),J(Math.max(1,t)),S(!0)},children:"Prefill Request"})]},s.key)})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{label:"Water Cases",key:"water",unit:"cases"},{label:"Food Boxes",key:"food",unit:"boxes"},{label:"Blankets",key:"blankets",unit:"units"},{label:"Med Kits",key:"medicalKits",unit:"kits"}].map(s=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm text-center",children:[e.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase mb-1",children:s.label}),e.jsx("input",{type:"number",min:"0",className:"w-full mt-2 p-2 rounded-lg border border-slate-300 text-center font-bold text-slate-900",value:h[s.key],onChange:t=>Ae(s.key,parseInt(t.target.value))}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:s.unit}),e.jsx("p",{className:"text-[11px] font-bold mt-1 ".concat(j[s.key].level==="HIGH"?"text-green-600":j[s.key].level==="MEDIUM"?"text-amber-600":j[s.key].level==="LOW"?"text-red-600":"text-slate-400"),children:j[s.key].level==="UNKNOWN"?"N/A":j[s.key].level})]},s.label))}),e.jsxs(m,{fullWidth:!0,className:"font-bold",onClick:Ie,disabled:!Q,children:[e.jsx(ns,{size:18,className:"mr-2"})," ",Q?n("btn.save"):"All Saved"]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 shadow-sm mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(is,{className:"text-brand-600",size:20}),e.jsx("h3",{className:"font-bold text-slate-900",children:n("org.req_replenish")})]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4 font-medium",children:n("org.req_desc")}),Ce?Ee?e.jsxs("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg text-center font-bold flex flex-col items-center animate-fade-in border border-green-100",children:[e.jsx(T,{size:32,className:"mb-2"}),Z?e.jsxs(e.Fragment,{children:["Request Queued for Sync",e.jsxs("span",{className:"text-xs font-normal mt-1 flex items-center gap-1",children:[e.jsx(ss,{size:10})," Will send when online"]})]}):"Request Sent to ".concat(w)]}):e.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200 space-y-3 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Item"}),e.jsxs("select",{className:"w-full p-2 rounded border border-slate-300 text-sm bg-white text-slate-900 font-bold",value:F,onChange:s=>X(s.target.value),children:[e.jsx("option",{value:"Water Cases",children:"Water Cases"}),e.jsx("option",{value:"Food Boxes",children:"Food Boxes"}),e.jsx("option",{value:"Blankets",children:"Blankets"}),e.jsx("option",{value:"Medical Kits",children:"Medical Kits"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded border border-slate-300 text-sm text-slate-900 font-bold",value:_,onChange:s=>J(parseInt(s.target.value))})]}),e.jsxs("div",{className:"text-xs text-slate-600 text-right",children:["Provider: ",e.jsx("span",{className:"font-bold text-slate-900",children:w})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>S(!1),className:"flex-1 text-slate-700",children:n("btn.cancel")}),e.jsx(m,{size:"sm",className:"flex-1",onClick:Be,children:Z?"Queue Offline":n("org.submit_req")})]})]}):e.jsx(m,{variant:"outline",fullWidth:!0,onClick:()=>S(!0),className:"text-slate-900 border-slate-300",children:n("org.create_req")}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Recent Requests"}),e.jsx("span",{className:"text-xs text-slate-500 font-bold",children:"Latest first"})]}),q.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"No requests yet."}),q.slice(0,5).map(s=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-3 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:s.item}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Qty: ",s.quantity," • ",new Date(s.timestamp).toLocaleString()]})]}),e.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded-full ".concat(s.status==="FULFILLED"?"bg-green-100 text-green-700":s.status==="STOCKED"?"bg-emerald-100 text-emerald-700":s.status==="APPROVED"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"),children:s.status})]}),s.status!=="FULFILLED"&&s.status!=="STOCKED"&&e.jsx("p",{className:"mt-2 text-[11px] text-slate-500 font-bold",children:"Status managed by warehouse log."}),s.status==="FULFILLED"&&e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(m,{size:"sm",variant:s.stocked?"ghost":"outline",onClick:()=>!s.stocked&&Ue(s),disabled:s.stocked||se,children:s.stocked?e.jsx(e.Fragment,{children:"Stocked"}):e.jsxs(e.Fragment,{children:[se?e.jsx(me,{size:14,className:"animate-spin mr-1"}):null,"Mark Stocked"]})}),s.stocked&&s.stockedAt&&e.jsxs("span",{className:"text-[11px] text-slate-500 font-bold",children:["Stocked at ",new Date(s.stockedAt).toLocaleTimeString()]})]}),s.status==="STOCKED"&&e.jsxs("div",{className:"mt-2 text-[11px] text-emerald-700 font-bold",children:["Stocked at ",s.stockedAt?new Date(s.stockedAt).toLocaleTimeString():"—"]})]},s.id))]})]})]})]})]})};export{Fs as OrgDashboardView};
