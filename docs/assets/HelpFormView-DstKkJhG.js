import{c as T,r as n,j as e,S as A,n as we}from"./index-D21_jD2s.js";import{u as Ae,c as Se,l as Ce,a as Me,e as ze,M as Ee,T as Le,L as ce}from"./TileLayer-Bb6VlaGH.js";import{B as m}from"./Button-4kycTSxy.js";import{I as le,T as ne}from"./Input-CRKoqp_l.js";import{t as i}from"./translations-DYnCuGsW.js";import{C as Ie}from"./clock-BU15342t.js";import{C as Te}from"./circle-check-big-Cm7ZoXKS.js";import{R as Y}from"./refresh-cw-CR-dn7fN.js";import{M as Oe}from"./message-square-BM9o0r7t.js";import{A as De}from"./arrow-left-DagSdbID.js";import{X as Be}from"./x-Btfl62Z_.js";import{G as oe}from"./globe-COF_kRX_.js";import{M as V}from"./map-pin-DKfMhJj3.js";import{T as Re}from"./triangle-alert-8cVEAM1p.js";import{D as re}from"./droplets-CtRHS_1h.js";import{S as Pe}from"./shield-BfOdyJcR.js";import{Z as Ue}from"./zap-DbEvWA5N.js";import"./index-DCV6S7Jd.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M10 10H6",key:"1bsnug"}],["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.28a1 1 0 0 0-.684-.948l-1.923-.641a1 1 0 0 1-.578-.502l-1.539-3.076A1 1 0 0 0 16.382 8H14",key:"lrkjwd"}],["path",{d:"M8 8v4",key:"1fwk8c"}],["path",{d:"M9 18h6",key:"x1upvd"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Fe=T("ambulance",He);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],qe=T("flame",Je);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ye=T("locate-fixed",Ke);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],We=T("wifi",Ve);function Xe(){return Ae().map}function Ge(c){const o=Xe();return n.useEffect(function(){return o.on(c),function(){o.off(c)}},[o,c]),o}const Qe=Se(function({position:o,...r},s){const g=new Ce.Marker(o,r);return Me(g,ze(s,{overlayContainer:g}))},function(o,r,s){r.position!==s.position&&o.setLatLng(r.position),r.icon!=null&&r.icon!==s.icon&&o.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==s.zIndexOffset&&o.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==s.opacity&&o.setOpacity(r.opacity),o.dragging!=null&&r.draggable!==s.draggable&&(r.draggable===!0?o.dragging.enable():o.dragging.disable())}),Ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcY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",$e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",et=({current:c,total:o})=>{const r=Math.min(100,Math.max(0,c/o*100));return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between text-xs font-semibold uppercase text-slate-500 mb-2",children:[e.jsxs("span",{children:["Step ",c," of ",o]}),e.jsxs("span",{children:[Math.round(r),"%"]})]}),e.jsx("div",{className:"h-2 w-full bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-brand-500 transition-all duration-500 ease-out rounded-full",style:{width:"".concat(r,"%")}})})]})};delete ce.Icon.Default.prototype._getIconUrl;ce.Icon.Default.mergeOptions({iconRetinaUrl:Ze,iconUrl:$e,shadowUrl:_e});const tt=({marker:c,onPick:o})=>(Ge({click:r=>{o({lat:r.latlng.lat,lng:r.latlng.lng})}}),c?e.jsx(Qe,{position:[c.lat,c.lng]}):null),ie={isSafe:null,location:"",emergencyType:"",isInjured:null,injuryDetails:"",situationDescription:"",canEvacuate:null,hazardsPresent:null,hazardDetails:"",peopleCount:1,petsPresent:null,hasWater:null,hasFood:null,hasMeds:null,hasPower:null,hasPhone:null,needsTransport:null,vulnerableGroups:[],medicalConditions:"",damageType:"",consentToShare:!0},yt=({setView:c})=>{const[o,r]=n.useState(1),[s,g]=n.useState(ie),[W,O]=n.useState(!1),[de,X]=n.useState(!1),[y,M]=n.useState("idle"),[D,xe]=n.useState(""),[B,G]=n.useState(null),[R,j]=n.useState(null),[Q,z]=n.useState(!1),[u,f]=n.useState(!0),[h,E]=n.useState(null),[ue,L]=n.useState(""),[v,p]=n.useState(!1),[N,Z]=n.useState(!navigator.onLine),P=n.useRef(!1),U=n.useRef(null),H=n.useRef(0),[I,$]=n.useState(!1),[me,F]=n.useState(null),fe=n.useRef(null),[_,st]=n.useState(!1);n.useEffect(()=>{r(1),g(ie),O(!1),X(!1),M("idle"),G(null),j(null),z(!1),f(!0),E(null),L(""),p(!1),P.current=!1,U.current=null,H.current=0},[]),n.useEffect(()=>{var x;const t=A.getProfile();xe(t.emergencyContactPhone||""),(x=navigator.permissions)==null||x.query({name:"geolocation"}).then(S=>{S.state==="granted"&&f(!0)});const a=()=>Z(!1),l=()=>Z(!0);return window.addEventListener("online",a),window.addEventListener("offline",l),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",l)}},[]),n.useEffect(()=>{if(P.current)return;const t=A.getLastKnownLocation();t&&(P.current=!0,g(a=>a.location?a:{...a,location:t.location}),L(new Date(t.timestamp).toLocaleTimeString()),f(!1),p(!1))},[]);const J=t=>{const a=t.match(/^\s*(-?\d+(?:\.\d+)?)\s*,\s*(-?\d+(?:\.\d+)?)\s*$/);if(!a)return null;const l=Number(a[1]),x=Number(a[2]);return!Number.isFinite(l)||!Number.isFinite(x)||Math.abs(l)>90||Math.abs(x)>180?null:{lat:l,lng:x}},ee=n.useMemo(()=>{const t=J(s.location||"");if(t)return t;const a=A.getLastKnownLocation();return(a!=null&&a.location?J(a.location):null)||{lat:37.7749,lng:-122.4194}},[s.location]);n.useEffect(()=>{if(!I)return;const t=J(s.location||"");t&&F(t)},[s.location,I]);const q=async()=>{p(!1),j("Location services unavailable. Please enter address manually.")};n.useEffect(()=>{let t;const a=()=>{j(null),z(!1),p(!1);const l=C=>{const{latitude:b,longitude:k,accuracy:te}=C.coords,se=Date.now(),w=Number.isFinite(te)?Math.round(te):null,K=U.current,ye=w!==null&&(K===null||w<=K+5),ve=se-H.current>3e4;if(ye||ve){U.current=w!=null?w:K,H.current=se;const ae="".concat(b.toFixed(6),", ").concat(k.toFixed(6));g(ke=>({...ke,location:ae})),E(w),L(new Date().toLocaleTimeString()),j(null),z(!1),p(!1),B&&A.updateRequestLocation(B,ae)}},x=C=>{let b="Location unavailable",k=!1;switch(C.code){case 1:b="GPS denied. Please enter address manually.",z(!0),q(),k=!0;break;case 2:b="Signal weak. Please enter address manually.",q(),k=!0;break;case 3:b="GPS Timeout. Retrying...";break;default:b="GPS Error"}!v&&!k&&j(b),E(null),k&&f(!1)},S={enableHighAccuracy:!0,maximumAge:0,timeout:2e4};t=navigator.geolocation.watchPosition(l,x,S)};return u&&"geolocation"in navigator?a():u&&!("geolocation"in navigator)&&(j("GPS not supported. Using Network Location."),q(),f(!1)),()=>{t&&navigator.geolocation.clearWatch(t)}},[u,B]),n.useEffect(()=>()=>{var t;if(_){const a=(t=fe.current)==null?void 0:t.srcObject;a==null||a.getTracks().forEach(l=>l.stop())}},[_]);const d=t=>{g(a=>({...a,...t}))},be=()=>r(t=>Math.min(t+1,5)),ge=()=>r(t=>Math.max(t-1,1)),he=async()=>{O(!0);const t=A.getLastKnownLocation(),a=s.location||(t==null?void 0:t.location)||"";a&&!s.location&&g(l=>({...l,location:a}));try{const l=await A.submitRequest({...s,location:a});G(l.id),s.emergencyContactPhone&&(M("sending"),we({contactName:s.emergencyContactName,contactPhone:s.emergencyContactPhone,userName:s.fullName,emergencyType:s.emergencyType,description:s.situationDescription,location:a,requestId:l.id}).then(()=>M("sent")).catch(x=>{console.warn("Emergency contact notify failed",x),M("failed")})),X(!0)}catch(l){console.error(l),alert("Failed to submit request. Saved locally; will retry when online.")}finally{O(!1)}},pe=()=>{const t=D.replace(/[^\d+]/g,""),a=s.isSafe===null?"Unknown Status":s.isSafe?"Safe":"IN DANGER",l=s.emergencyType||"Emergency",x=s.location||"GPS Unavailable",S=s.situationDescription?"- ".concat(s.situationDescription):"",C="I used the AERA app to request emergency assistance.\n\nType: ".concat(l," ").concat(S,"\nLocation: ").concat(x,"\nStatus: ").concat(a),b=navigator.userAgent.match(/iPhone|iPad|iPod/i)?"&":"?";window.location.href="sms:".concat(t).concat(b,"body=").concat(encodeURIComponent(C))},Ne=t=>{let a=0,l="bg-slate-300";return t<=15?(a=4,l="bg-green-500"):t<=30?(a=3,l="bg-green-500"):t<=60?(a=2,l="bg-yellow-500"):(a=1,l="bg-red-500"),e.jsxs("div",{className:"flex items-end gap-1 h-3",role:"img","aria-label":"GPS Signal Strength: ".concat(a," of 4 bars"),children:[e.jsx("div",{className:"w-1 rounded-sm ".concat(a>=1?l:"bg-slate-200"," h-1.5")}),e.jsx("div",{className:"w-1 rounded-sm ".concat(a>=2?l:"bg-slate-200"," h-2")}),e.jsx("div",{className:"w-1 rounded-sm ".concat(a>=3?l:"bg-slate-200"," h-2.5")}),e.jsx("div",{className:"w-1 rounded-sm ".concat(a>=4?l:"bg-slate-200"," h-3")})]})},je=t=>t?t<=15?"Excellent Signal":t<=30?"Good Signal":t<=60?"Fair Signal":"Weak Signal":"";return de?e.jsxs("div",{className:"min-h-screen bg-white flex flex-col items-center justify-center p-8 text-center animate-fade-in pb-safe",children:[e.jsxs("div",{className:"w-24 h-24 rounded-full flex items-center justify-center mb-6 relative ".concat(N?"bg-amber-100":"bg-green-100"),children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 ".concat(N?"border-amber-500/30":"border-green-500/30"," animate-[ping_2s_ease-out_infinite]")}),N?e.jsx(Ie,{size:48,className:"text-amber-600 relative z-10"}):e.jsx(Te,{size:48,className:"text-green-700 relative z-10"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 mb-2",children:N?"Saved to Outbox":i("help.success_title")}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-900 px-4 py-3 rounded-xl text-sm font-bold mb-8 flex flex-col items-center gap-2 max-w-xs mx-auto animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{size:18,className:"animate-spin"}),"Live Location Sharing Active"]}),e.jsx("span",{className:"font-mono text-xs bg-white/60 px-2 py-1 rounded text-blue-800 border border-blue-100",children:s.location||"Locating..."})]}),N&&e.jsx("p",{className:"text-slate-800 font-medium mb-8 max-w-sm",children:"Your report has been saved to your device. It will automatically upload to responders as soon as you connect to the internet."}),D&&!N&&y!=="idle"&&e.jsxs("div",{className:"text-sm font-bold px-4 py-3 rounded-xl border max-w-xs mx-auto ".concat(y==="sent"?"bg-green-50 text-green-800 border-green-200":y==="failed"?"bg-amber-50 text-amber-800 border-amber-200":"bg-slate-50 text-slate-700 border-slate-200"),children:[y==="sent"&&"Emergency contact notified via SMS.",y==="failed"&&"Unable to notify emergency contact. You can continue.",y==="sending"&&"Notifying emergency contact..."]}),e.jsxs("div",{className:"w-full space-y-4",children:[D&&e.jsxs(m,{fullWidth:!0,onClick:pe,className:"bg-slate-900 hover:bg-slate-800 text-white",children:[e.jsx(Oe,{className:"mr-2",size:20}),i("help.text_contact")]}),e.jsx(m,{fullWidth:!0,variant:"outline",onClick:()=>c("DASHBOARD"),className:"border-slate-300 text-slate-900 font-bold",children:i("help.return_dash")})]})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col pb-safe",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 p-4 sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>o===1?c("DASHBOARD"):ge(),className:"p-2 -ml-2 text-slate-600 hover:text-slate-900",children:e.jsx(De,{size:24})}),e.jsx("h1",{className:"font-bold text-xl text-slate-900",children:i("help.title")}),e.jsx("button",{onClick:()=>c("DASHBOARD"),className:"p-2 -mr-2 text-slate-400 hover:text-red-600 transition-colors",title:i("btn.cancel"),children:e.jsx(Be,{size:24})})]}),e.jsx(et,{current:o,total:5})]}),e.jsxs("div",{className:"flex-1 p-6 space-y-8 animate-fade-in overflow-y-auto pb-32",children:[o===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xl font-bold text-slate-900",children:i("help.safe_q")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>d({isSafe:!0}),className:"p-4 rounded-xl border-2 font-bold transition-all ".concat(s.isSafe===!0?"border-brand-600 bg-brand-50 text-brand-800":"border-slate-300 bg-white text-slate-700"),children:i("help.yes_safe")}),e.jsx("button",{onClick:()=>d({isSafe:!1}),className:"p-4 rounded-xl border-2 font-bold transition-all ".concat(s.isSafe===!1?"border-red-600 bg-red-50 text-red-800":"border-slate-300 bg-white text-slate-700"),children:i("help.no_danger")})]})]}),s.isSafe===!1&&e.jsxs("div",{className:"bg-red-600 text-white p-6 rounded-xl shadow-xl animate-pulse space-y-4 border-4 border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(AlertOctagon,{size:48,className:"text-white"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-extrabold uppercase tracking-wider",children:"Immediate Danger"}),e.jsx("p",{className:"font-medium text-red-100",children:"Do not rely solely on this app."})]})]}),e.jsx(m,{fullWidth:!0,size:"xl",className:"bg-white text-red-700 hover:bg-red-50 font-black text-2xl shadow-lg",onClick:()=>window.location.href="tel:911",children:"CALL 911 NOW"}),e.jsx("p",{className:"text-center text-sm font-bold opacity-80",children:"If you cannot call, continue filling this form."})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:i("help.location")}),u&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-green-600 bg-green-50 px-2 py-0.5 rounded border border-green-100 animate-pulse",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})," LIVE TRACKING"]}),v&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-100",children:[e.jsx(oe,{size:10})," APPROX (IP)"]})]}),e.jsx(le,{placeholder:u?i("help.detecting"):i("help.manual"),value:s.location||"",onChange:t=>{f(!1),p(!1),F(null),d({location:t.target.value})},className:"bg-white font-mono text-sm border-slate-300 text-slate-900 font-semibold pr-24 ".concat(u?"border-brand-500 ring-1 ring-brand-500":v?"border-amber-500 ring-1 ring-amber-500":Q?"border-red-500":""),error:!u&&!v&&!s.location&&R&&!Q?R:void 0}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("button",{type:"button",onClick:()=>{$(t=>!t),f(!1),p(!1)},className:"inline-flex items-center gap-2 text-xs font-bold text-slate-700 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full",children:[e.jsx(V,{size:12})," ",I?"Hide Map":"Drop a Pin"]}),e.jsxs("button",{type:"button",onClick:()=>{f(!0),$(!1)},className:"inline-flex items-center gap-2 text-xs font-bold text-brand-700 bg-brand-50 hover:bg-brand-100 px-3 py-1.5 rounded-full",children:[e.jsx(Ye,{size:12})," Use GPS"]})]})]}),I&&e.jsxs("div",{className:"mt-3 rounded-xl overflow-hidden border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"bg-slate-50 px-3 py-2 text-xs font-semibold text-slate-600 flex items-center gap-2",children:[e.jsx(V,{size:12})," Tap the map to set your exact location"]}),e.jsx("div",{className:"h-64 w-full",children:e.jsxs(Ee,{center:[ee.lat,ee.lng],zoom:14,scrollWheelZoom:!0,className:"h-full w-full",children:[e.jsx(Le,{attribution:"Â© OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(tt,{marker:me,onPick:t=>{f(!1),p(!1),F(t);const a="".concat(t.lat.toFixed(6),", ").concat(t.lng.toFixed(6));d({location:a}),E(null),L(new Date().toLocaleTimeString()),j(null)}})]})})]}),u&&h!==null&&e.jsxs("div",{className:"bg-slate-100 rounded-lg p-3 border border-slate-200 -mt-2 shadow-inner",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Ne(h),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-700 uppercase tracking-wider leading-none mb-0.5",children:je(h)}),e.jsxs("p",{className:"text-xs text-slate-500 font-mono leading-none",children:["Â± ",h,"m precision"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-end text-[10px] text-slate-400 font-bold uppercase mb-0.5",children:[e.jsx(We,{size:10})," Last Update"]}),e.jsx("p",{className:"text-xs text-slate-600 font-mono font-bold leading-none",children:ue})]})]}),h>50&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-2 bg-amber-50 p-1.5 rounded border border-amber-100",children:[e.jsx(Re,{size:12,className:"text-amber-600"}),e.jsx("p",{className:"text-[10px] text-amber-700 font-bold",children:"Signal weak. Move outdoors or near windows for better precision."})]})]}),u&&!R&&h===null&&!v&&e.jsxs("p",{className:"text-xs text-brand-600 font-medium -mt-2 animate-pulse flex items-center gap-1",children:[e.jsx(Y,{size:12,className:"animate-spin"})," Acquiring satellite lock..."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xl font-bold text-slate-900",children:i("help.what_need")}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"Medical",icon:e.jsx(Fe,{size:24}),color:"red"},{id:"Fire",icon:e.jsx(qe,{size:24}),color:"orange"},{id:"Flood",icon:e.jsx(re,{size:24}),color:"blue"},{id:"Police",icon:e.jsx(Pe,{size:24}),color:"slate"}].map(t=>e.jsxs("button",{onClick:()=>d({emergencyType:t.id}),className:"p-4 rounded-xl border flex flex-col items-center gap-2 transition-all ".concat(s.emergencyType===t.id?"border-".concat(t.color,"-600 bg-").concat(t.color,"-50 text-").concat(t.color,"-900 ring-2 ring-").concat(t.color,"-600 ring-offset-1"):"border-slate-300 bg-white text-slate-700 hover:border-slate-400"),children:[t.icon,e.jsx("span",{className:"font-bold text-lg",children:t.id})]},t.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xl font-bold text-slate-900",children:i("help.injured_q")}),e.jsx("div",{className:"flex gap-4",children:["Yes","No"].map(t=>{const a=t==="Yes";return e.jsx(m,{type:"button",variant:s.isInjured===a?"primary":"outline",onClick:()=>d({isInjured:a}),className:"flex-1 font-bold ".concat(s.isInjured!==a?"border-slate-300 text-slate-700":""),children:t==="Yes"?"Yes":"No"},t)})})]})]}),o===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ne,{label:i("help.situation"),placeholder:"E.g. Water is rising rapidly, trapped in attic...",value:s.situationDescription,onChange:t=>d({situationDescription:t.target.value}),className:"border-slate-300 text-slate-900"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-lg font-bold text-slate-900",children:i("help.evac_q")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:s.canEvacuate===!0?"primary":"outline",onClick:()=>d({canEvacuate:!0}),className:"flex-1 font-bold",children:"Yes"}),e.jsx(m,{variant:s.canEvacuate===!1?"danger":"outline",onClick:()=>d({canEvacuate:!1}),className:"flex-1 font-bold",children:"No"})]})]}),e.jsx(le,{type:"number",label:i("help.people_count"),min:1,value:s.peopleCount,onChange:t=>d({peopleCount:parseInt(t.target.value)}),className:"border-slate-300 text-slate-900 font-bold"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-lg font-bold text-slate-900",children:i("help.pets_q")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:s.petsPresent===!0?"primary":"outline",onClick:()=>d({petsPresent:!0}),className:"flex-1 font-bold",children:"Yes"}),e.jsx(m,{variant:s.petsPresent===!1?"secondary":"outline",onClick:()=>d({petsPresent:!1}),className:"flex-1 font-bold",children:"No"})]})]})]}),o===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:i("help.resources_title")}),e.jsx("p",{className:"text-slate-600 font-medium text-base",children:i("help.resources_desc")}),[{key:"hasWater",label:"Clean Water",icon:e.jsx(re,{size:18})},{key:"hasFood",label:"Food",icon:e.jsx("span",{className:"text-lg",children:"ðŸ¥«"})},{key:"hasMeds",label:"Medications",icon:e.jsx("span",{className:"text-lg",children:"ðŸ’Š"})},{key:"hasPower",label:"Electricity",icon:e.jsx(Ue,{size:18})},{key:"hasPhone",label:"Phone Service",icon:e.jsx("span",{className:"text-lg",children:"ðŸ“¶"})}].map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-xl border border-slate-300 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-lg text-slate-700",children:t.icon}),e.jsx("span",{className:"font-bold text-slate-900",children:t.label})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d({[t.key]:!0}),className:"px-4 py-2 rounded-lg text-sm font-bold transition-colors ".concat(s[t.key]===!0?"bg-green-100 text-green-800 border border-green-200":"bg-slate-100 text-slate-500 border border-slate-200"),children:"Yes"}),e.jsx("button",{onClick:()=>d({[t.key]:!1}),className:"px-4 py-2 rounded-lg text-sm font-bold transition-colors ".concat(s[t.key]===!1?"bg-red-100 text-red-800 border border-red-200":"bg-slate-100 text-slate-500 border border-slate-200"),children:"No"})]})]},t.key))]}),o===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-lg font-bold text-slate-900",children:i("help.vuln_title")}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["Elderly","Infants","Disabled","Pregnant"].map(t=>e.jsx("button",{onClick:()=>{const a=s.vulnerableGroups,l=a.includes(t)?a.filter(x=>x!==t):[...a,t];d({vulnerableGroups:l})},className:"p-3 rounded-lg border text-sm font-bold transition-all ".concat(s.vulnerableGroups.includes(t)?"bg-brand-50 border-brand-500 text-brand-800":"bg-white border-slate-300 text-slate-600"),children:t},t))})]}),e.jsx(ne,{label:i("help.medical_cond"),placeholder:"Diabetes, requires dialysis, wheelchair user...",value:s.medicalConditions,onChange:t=>d({medicalConditions:t.target.value}),className:"border-slate-300"})]}),o===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:i("help.review")}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-300 p-4 space-y-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Emergency Type"}),e.jsx("span",{className:"font-bold text-slate-900",children:s.emergencyType||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"People Count"}),e.jsx("span",{className:"font-bold text-slate-900",children:s.peopleCount})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Injuries"}),e.jsx("span",{className:"font-bold text-slate-900",children:s.isInjured?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Location"}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"block font-bold truncate max-w-[150px] font-mono text-xs text-slate-900",children:s.location||"Pending..."}),u?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-[10px] text-green-700 font-bold flex items-center justify-end gap-1",children:[e.jsx(Y,{size:10,className:"animate-spin"})," Live"]}),h&&e.jsxs("span",{className:"text-[10px] text-slate-500 font-mono",children:["Â±",h,"m"]})]}):v?e.jsxs("span",{className:"text-[10px] text-amber-600 font-bold flex items-center justify-end gap-1",children:[e.jsx(oe,{size:10})," Network (Approx)"]}):e.jsxs("span",{className:"text-[10px] text-slate-500 font-bold flex items-center justify-end gap-1",children:[e.jsx(V,{size:10})," Manual/Frozen"]})]})]})]})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-slate-200 z-30",children:e.jsx("div",{className:"max-w-md mx-auto flex gap-4",children:o<5?e.jsx(m,{fullWidth:!0,onClick:be,size:"lg",className:"font-bold text-lg",children:i("btn.next")}):e.jsx(m,{fullWidth:!0,size:"lg",disabled:W,onClick:he,className:"bg-red-600 hover:bg-red-700 font-bold text-lg shadow-lg shadow-red-200",children:W?N?"Saving...":"Sending...":N?"Save for Sync":i("help.submit_btn")})})})]})};export{yt as HelpFormView};
