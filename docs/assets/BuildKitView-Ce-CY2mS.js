const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-jspdf-Bd23t5aa.js","assets/vendor-CCVjAPEY.js","assets/vendor-react-DZ0IVLBb.js","assets/vendor-maps-S3fC-LOA.js","assets/vendor-maps-CIGW-MKW.css"])))=>i.map(i=>d[i]);
import{_ as X}from"./vendor-jspdf-Bd23t5aa.js";import{a as m,j as e,G as Z,i as B,aL as ee,af as I,aM as te,aj as se,ao as ae,D as ie,ae as re,aN as le}from"./vendor-react-DZ0IVLBb.js";import{B as oe}from"./Button-BzswROfv.js";import{S as ne,t as de,C as ce,D as P,E as he}from"./index-D_urGLpe.js";import"./vendor-CCVjAPEY.js";import"./vendor-maps-S3fC-LOA.js";import"./vendor-supabase-ChvUvA8t.js";const _="aeraReadyKit",x=[{id:"food",title:"Food & Water",subtitle:"Keep yourself fed and hydrated",icon:e.jsx(ie,{size:20,className:"text-blue-700"}),items:[{id:"water",title:"Bottled water",description:"About 1 gallon per person each day",quantity:"3 days"},{id:"food",title:"Easy-to-eat foods",description:"Canned items, granola bars, crackers",quantity:"3 days"},{id:"plates",title:"Paper plates and utensils",description:"Cups, forks, spoons you can throw away",quantity:"1 pack"},{id:"opener",title:"Can opener",description:"Manual type that doesn't need electricity",quantity:"1x"},{id:"filter",title:"Water filter or purifier",description:"Small device or tablets to clean water",quantity:"1 item"}]},{id:"health",title:"Health Items",subtitle:"Take care of yourself and family",icon:e.jsx(re,{size:20,className:"text-rose-600"}),items:[{id:"bandages",title:"Bandages and wound care",description:"Band-aids, gauze, medical tape",quantity:"1 kit"},{id:"meds",title:"Your regular medications",description:"Keep about a week's worth if possible",quantity:"7 days"},{id:"common-meds",title:"Common medicines",description:"Pain relief, stomach, allergy meds",quantity:"Small supply"},{id:"glasses",title:"Extra glasses or contacts",description:"If you wear them, keep a spare pair",quantity:"1 pair"},{id:"sanitizer",title:"Hand sanitizer and soap",description:"Small bottles to keep hands clean",quantity:"Travel size"},{id:"toiletries",title:"Toiletries",description:"Toothbrush, hygiene items, tissues",quantity:"Small kit"}]},{id:"power",title:"Light & Power",subtitle:"Stay connected and see in the dark",icon:e.jsx(le,{size:20,className:"text-amber-600"}),items:[{id:"flashlight",title:"Flashlight",description:"LED type with extra batteries",quantity:"1-2x"},{id:"radio",title:"Battery or hand-crank radio",description:"To hear news and weather updates",quantity:"1x"},{id:"charger",title:"Phone charger and power bank",description:"Wall plug, cables, backup battery",quantity:"Complete set"},{id:"car-charger",title:"Car phone charger",description:"Charge from your vehicle if needed",quantity:"1x"},{id:"whistle",title:"Whistle",description:"Loud one to get attention",quantity:"1-2x"},{id:"mask",title:"Dust masks",description:"N95 type for filtering air",quantity:"3-5x"},{id:"multi-tool",title:"Multi-tool",description:"Knife, pliers, screwdriver in one",quantity:"1x"}]},{id:"papers",title:"Papers & Money",subtitle:"Keep important info handy",icon:e.jsx(I,{size:20,className:"text-slate-600"}),items:[{id:"ids",title:"Copies of IDs",description:"Driver's license, passport, birth certificate",quantity:"Photocopies"},{id:"cash",title:"Cash",description:"Small bills in case cards don't work",quantity:"$200-300"},{id:"contacts",title:"Contact list",description:"Phone numbers written down on paper",quantity:"1 list"},{id:"insurance",title:"Insurance papers",description:"Copies of your insurance info",quantity:"Photocopies"},{id:"map",title:"Local map",description:"Paper map of your area",quantity:"1x"},{id:"usb",title:"USB drive",description:"Digital copies of important files",quantity:"1x"},{id:"photos",title:"Family photos",description:"Printed pictures to help identify people",quantity:"A few"}]}],ye=({setView:$})=>{const[R,A]=m.useState({}),[p,S]=m.useState({}),[T,E]=m.useState(!1),[h,z]=m.useState(null),f=m.useMemo(()=>{const s=ne.getProfile(),t=Array.isArray(s.household)?s.household:[],i=Math.max(1,Number(s.householdMembers)||1);let a=1,r=0,d=0;t.forEach(n=>{const b=String(n.age||"").trim(),o=de(b),C=Number.isFinite(Number(b))?Number(b):null,y=o??C;if(y!=null){if(y>=65){d+=1;return}if(y<=17){r+=1;return}}n.ageGroup==="SENIOR"?d+=1:n.ageGroup==="CHILD"||n.ageGroup==="TEEN"||n.ageGroup==="INFANT"?r+=1:a+=1});const l=a+r+d;return{people:Math.max(i,l),adults:a,children:r,seniors:d}},[]),F=(s,t)=>{const i=Math.max(1,f.people),a=Math.max(1,f.adults),r=Math.max(0,f.children),d=Math.max(0,f.seniors),l=Math.max(3,Number((h==null?void 0:h.recommended_duration_days)||3));switch(s){case"water":return`${i*l} gal (${l}d)`;case"food":return`${i*l} meals`;case"plates":return`${Math.max(1,Math.ceil(i*l/18))} packs`;case"filter":return`${Math.max(1,Math.ceil(i/4))} unit(s)`;case"bandages":return`${Math.max(1,Math.ceil(i/2))} kit(s)`;case"meds":return`${l} days/person`;case"common-meds":return`${Math.max(1,Math.ceil(i/2))} supply sets`;case"sanitizer":return`${Math.max(1,Math.ceil(i/2))} bottles`;case"toiletries":return`${Math.max(1,Math.ceil(i/2))} hygiene kits`;case"flashlight":return`${Math.max(1,Math.ceil(i/2))}x`;case"whistle":return`${i}x`;case"mask":return`${Math.max(3,i*3)}x`;case"cash":{const u=200+(i-1)*75,n=300+(i-1)*100;return`$${u}-${n}`}case"contacts":return`${Math.max(1,a)} list(s)`;case"photos":return`${Math.max(4,i*2)} photos`;case"opener":case"radio":case"car-charger":case"multi-tool":case"map":case"usb":return i>=4?"2x":"1x";case"glasses":return"1 pair per wearer";default:return d>0&&(s==="charger"||s==="power")?`${Math.max(2,Math.ceil(i/2))} sets`:r>0&&s==="food"?`${i*l} meals (+ child snacks)`:t}},v=m.useMemo(()=>{const s=new Set(x.flatMap(t=>t.items.map(i=>i.id)));return((h==null?void 0:h.added_items)||[]).filter(t=>!s.has(t.id))},[h]),j=m.useMemo(()=>x.reduce((t,i)=>t+i.items.length,0)+v.length,[v]),M=m.useMemo(()=>Object.values(p).filter(Boolean).length,[p]),H=Math.round(M/j*100);m.useEffect(()=>{A(s=>({...s,[x[0].id]:!0}))},[]),m.useEffect(()=>{const s=localStorage.getItem(_);let t=0;if(s)try{const a=JSON.parse(s);if(a!=null&&a.checkedIds&&Array.isArray(a.checkedIds)){const r={};a.checkedIds.forEach(d=>{r[d]=!0}),S(r)}a!=null&&a.lastUpdated&&(t=Date.parse(a.lastUpdated)||0)}catch{}(async()=>{try{const a=await ce();if(!(a!=null&&a.checked_ids)||!Array.isArray(a.checked_ids))return;if((a.updated_at?Date.parse(a.updated_at):0)>=t){const d={};a.checked_ids.forEach(l=>{d[l]=!0}),S(d)}}catch{}try{const a=await P();z(a)}catch{}})()},[]);const W=s=>{A(t=>({...t,[s]:!t[s]}))},q=s=>{S(t=>({...t,[s]:!t[s]}))},G=async()=>{const s=Object.keys(p).filter(t=>p[t]);localStorage.setItem(_,JSON.stringify({checkedIds:s,totalItems:j,checkedItems:s.length,lastUpdated:new Date().toISOString()}));try{await he({checkedIds:s,totalItems:j,checkedItems:s.length});try{const t=await P();z(t)}catch{}}catch{}E(!0)},K=()=>{const s=[];return s.push("AERA Ready Kit"),s.push(`Progress: ${M} of ${j} items`),s.push(""),x.forEach(t=>{s.push(t.title),t.items.forEach(i=>{const a=p[i.id];s.push(`${a?"✓":"•"} ${i.title} (${F(i.id,i.quantity)}) - ${i.description}`)}),s.push("")}),s},L=async()=>{const{jsPDF:s}=await X(async()=>{const{jsPDF:c}=await import("./vendor-jspdf-Bd23t5aa.js").then(g=>g.j);return{jsPDF:c}},__vite__mapDeps([0,1,2,3,4])),t=new s({unit:"pt",format:"letter"}),i=t.internal.pageSize.getWidth(),a=t.internal.pageSize.getHeight(),r=54,d=i-r*2,l={primaryBlue:"#5B9BD5",lightBlue:"#DAE8F5",accentGreen:"#70AD47",textDark:"#2C3E50",textMedium:"#5A6C7D",borderLight:"#BDD7EE",headerBg:"#4472C4",categoryBg:"#E7F3FF",white:"#FFFFFF"},u=c=>t.setFillColor(c),n=c=>t.setTextColor(c),b=c=>t.setDrawColor(c);let o=r;const C=()=>{t.setFont("helvetica","bold"),t.setFontSize(24),n(l.headerBg),t.text("Your Ready Kit Checklist",i/2,o,{align:"center"}),o+=22,t.setFont("helvetica","normal"),t.setFontSize(12),n(l.textMedium),t.text("Gather these helpful items to have on hand when you need them",i/2,o,{align:"center"}),o+=28},y=()=>{u(l.lightBlue),b(l.primaryBlue),t.rect(r,o,d,120,"FD"),t.setFont("helvetica","bold"),t.setFontSize(12),n(l.white),u(l.primaryBlue),t.rect(r,o,d,26,"F"),t.text("My Progress Tracker",r+12,o+18),t.setFont("helvetica","normal"),t.setFontSize(11),n(l.textDark),[`☐ Food & Water (${x[0].items.length} items)`,`☐ Health Items (${x[1].items.length} items)`,`☐ Light & Power (${x[2].items.length} items)`,`☐ Papers & Money (${x[3].items.length} items)`].forEach((w,N)=>{t.text(w,r+16,o+46+N*18)}),o+=148},U=(c,g)=>{u(l.categoryBg),b(l.primaryBlue),t.rect(r,o,d,32,"FD"),t.setFont("helvetica","bold"),t.setFontSize(15),n(l.headerBg),t.text(c,r+12,o+20),o+=40,t.setFont("helvetica","normal"),t.setFontSize(10),n(l.textMedium),t.text(g,r+12,o+2),o+=12},Y=c=>{const D=d-24-90;c.forEach((k,Q)=>{o+30+40>a&&(t.addPage(),o=r);const V=Q%2===1;u(V?l.lightBlue:l.white),b(l.borderLight),t.rect(r,o,d,30,"FD"),t.setFont("helvetica","bold"),t.setFontSize(14),n(l.accentGreen),t.text("☐",r+8,o+20),t.setFont("helvetica","bold"),t.setFontSize(11),n(l.textDark),t.text(k.title,r+24,o+14,{maxWidth:D-10}),t.setFont("helvetica","normal"),t.setFontSize(9),n(l.textMedium),t.text(k.description,r+24,o+26,{maxWidth:D-10}),t.setFont("helvetica","bold"),t.setFontSize(10),n(l.textMedium),t.text(F(k.id,k.quantity),r+24+D+90-8,o+18,{align:"right"}),o+=30}),o+=16},J=()=>{o+120>a&&(t.addPage(),o=r),t.setFont("helvetica","bold"),t.setFontSize(14),n(l.headerBg),t.text("Helpful Tips",r,o+14),o+=22;const c=["Store your kit in an easy-to-reach spot that everyone in your home knows about","Check expiration dates every 6 months and replace items as needed","Keep this list with your kit so you can re-check it later","Share this checklist with family members so everyone can help gather items"],g=86;u(l.lightBlue),b(l.primaryBlue),t.rect(r,o,d,g,"FD"),t.setFont("helvetica","bold"),t.setFontSize(12),n(l.accentGreen),c.forEach((w,N)=>{t.text("✓",r+12,o+22+N*18),t.setFont("helvetica","normal"),t.setFontSize(10),n(l.textDark),t.text(w,r+28,o+22+N*18,{maxWidth:d-40}),t.setFont("helvetica","bold"),t.setFontSize(12),n(l.accentGreen)}),o+=g+10};C(),y(),x.forEach(c=>{o+140>a&&(t.addPage(),o=r),U(`${c.title}`,c.subtitle),Y(c.items)}),J(),t.save("AERA-Ready-Kit.pdf")},O=async()=>{const s=K().join(`
`);if(navigator.share)try{await navigator.share({title:"AERA Ready Kit",text:s});return}catch{}try{await navigator.clipboard.writeText(s),alert("Ready kit copied to clipboard.")}catch{alert("Unable to share right now.")}};return e.jsxs("div",{className:"min-h-screen bg-slate-50 pb-40",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white px-5 pt-4 pb-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("button",{onClick:()=>$("DASHBOARD"),className:"w-9 h-9 rounded-xl bg-white/20 flex items-center justify-center hover:bg-white/30",children:e.jsx(Z,{size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Build Your Ready Kit"}),e.jsx("p",{className:"text-sm text-blue-50",children:"Gather helpful items to have on hand when you need them"})]})]})}),e.jsxs("div",{className:"bg-white px-5 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"What You’ve Gathered"}),e.jsxs("span",{className:"text-xs font-bold text-emerald-600",children:[M," of ",j," items"]})]}),e.jsx("button",{onClick:()=>$("READINESS_GAP"),className:"text-[11px] font-semibold text-brand-600 hover:underline mb-2",children:"View readiness gaps"}),e.jsxs("p",{className:"text-[11px] text-slate-500 mb-2",children:["Quantities auto-scaled for ",f.people," household member",f.people===1?"":"s","."]}),e.jsx("div",{className:"w-full h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-600 to-emerald-400",style:{width:`${H}%`}})})]}),h&&e.jsxs("div",{className:"mx-4 mt-4 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-slate-50 border-b border-slate-200",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Personalized Preparedness Guidance"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Based on your profile, we recommend the following:"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-2",children:[e.jsx("p",{className:"text-[10px] text-blue-700 font-bold uppercase",children:"Supply Duration"}),e.jsxs("p",{className:"text-lg font-black text-blue-900",children:[h.recommended_duration_days,"d"]})]}),e.jsxs("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-2",children:[e.jsx("p",{className:"text-[10px] text-emerald-700 font-bold uppercase",children:"Readiness"}),e.jsxs("p",{className:"text-lg font-black text-emerald-900",children:[Math.round(h.readiness_score),"%"]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-2",children:[e.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase",children:"Risk Tier"}),e.jsx("p",{className:"text-lg font-black text-slate-900",children:h.risk_tier})]})]}),h.critical_missing_items.length>0&&e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3",children:[e.jsx("p",{className:"text-xs font-bold text-red-700 uppercase mb-1",children:"Critical Items Needed"}),e.jsx("ul",{className:"space-y-1",children:h.critical_missing_items.map(s=>e.jsxs("li",{className:"text-sm text-red-900",children:["• ",s.item]},s.id))}),e.jsxs("p",{className:"text-xs text-red-700 mt-2",children:["Readiness is currently capped at ",Math.round(h.readiness_cap),"% until these are completed."]})]}),h.added_items.length>0&&e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-3",children:[e.jsx("p",{className:"text-xs font-bold text-amber-700 uppercase mb-1",children:"Dynamic Kit Additions"}),e.jsx("ul",{className:"space-y-1",children:h.added_items.slice(0,8).map(s=>e.jsxs("li",{className:"text-sm text-amber-900",children:["• ",s.item," ",e.jsxs("span",{className:"text-[11px] uppercase font-semibold",children:["(",s.priority,")"]})]},s.id))})]})]})]}),v.length>0&&e.jsxs("div",{className:"mx-4 mt-4 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 bg-amber-50 border-b border-amber-200",children:[e.jsx("h3",{className:"text-sm font-bold text-amber-900",children:"Profile-Based Required Additions"}),e.jsx("p",{className:"text-xs text-amber-700",children:"These items were added automatically based on your profile."})]}),e.jsx("div",{children:v.map(s=>{const t=!!p[s.id];return e.jsxs("button",{onClick:()=>q(s.id),className:"w-full px-4 py-3 flex items-center gap-3 border-b last:border-b-0 border-slate-100 hover:bg-slate-50",children:[e.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center ${t?"bg-emerald-600 border-emerald-600":"border-slate-300"}`,children:t&&e.jsx(B,{size:12,className:"text-white"})}),e.jsxs("div",{className:`flex-1 text-left ${t?"opacity-60 line-through":""}`,children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s.item}),e.jsx("div",{className:"text-xs text-slate-500",children:s.explanation||"Added from intake rule engine."})]}),e.jsx("span",{className:`text-[10px] px-2 py-1 rounded uppercase font-bold ${String(s.priority).toLowerCase()==="critical"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:s.priority})]},s.id)})})]}),e.jsx("div",{className:"px-4 py-4 space-y-2",children:x.map(s=>{const t=s.items.filter(a=>p[a.id]).length,i=!!R[s.id];return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm",children:[e.jsxs("button",{onClick:()=>W(s.id),className:"w-full flex items-center justify-between px-4 py-4 hover:bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-blue-50 flex items-center justify-center",children:s.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:s.title}),e.jsx("p",{className:"text-xs text-slate-500",children:s.subtitle})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-bold text-emerald-700 bg-emerald-50 px-2 py-1 rounded-lg",children:[t,"/",s.items.length]}),e.jsx(ee,{size:18,className:`text-slate-400 transition-transform ${i?"rotate-180":""}`})]})]}),i&&e.jsx("div",{className:"border-t border-slate-100",children:s.items.map(a=>{const r=!!p[a.id];return e.jsxs("button",{onClick:()=>q(a.id),className:"w-full px-4 py-3 flex items-center gap-3 border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center ${r?"bg-emerald-600 border-emerald-600":"border-slate-300"}`,children:r&&e.jsx(B,{size:12,className:"text-white"})}),e.jsxs("div",{className:`flex-1 text-left ${r?"opacity-60 line-through":""}`,children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:a.title}),e.jsx("div",{className:"text-xs text-slate-500",children:a.description})]}),e.jsx("span",{className:"text-[11px] font-semibold text-slate-600 bg-slate-100 px-2 py-1 rounded-md",children:F(a.id,a.quantity)})]},a.id)})})]},s.id)})}),e.jsxs("div",{className:"fixed bottom-0 inset-x-0 bg-white border-t border-slate-200 px-4 pt-3 pb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("button",{onClick:L,className:"flex items-center justify-center gap-2 rounded-xl border border-slate-200 py-3 text-sm font-semibold text-slate-600 hover:bg-slate-50",children:[e.jsx(I,{size:16})," Download PDF"]}),e.jsxs("button",{onClick:O,className:"flex items-center justify-center gap-2 rounded-xl border border-slate-200 py-3 text-sm font-semibold text-slate-600 hover:bg-slate-50",children:[e.jsx(te,{size:16})," Share"]})]}),e.jsxs("button",{onClick:G,className:"w-full rounded-xl bg-gradient-to-br from-emerald-600 to-emerald-700 text-white py-3 text-sm font-bold shadow-lg shadow-emerald-200",children:[e.jsx(se,{size:16,className:"inline-block mr-2"})," Save My List"]})]}),T&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full text-center shadow-2xl",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-emerald-100 mx-auto flex items-center justify-center text-emerald-600 mb-4",children:e.jsx(ae,{size:26})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"All Set!"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Your list is saved and ready whenever you need it. You can find it in your Settings."}),e.jsx(oe,{className:"mt-4 w-full",onClick:()=>E(!1),children:"Sounds good"})]})})]})};export{ye as BuildKitView};
