import{c as L,r as t,j as e}from"./index-CJzEU5Yr.js";import{G as C}from"./mockGenAI-BPqgTz-A.js";import{I as S}from"./Input-BlISMA55.js";import{C as M}from"./Card-DfWMcASo.js";import{A as E}from"./arrow-left-BvMvYESN.js";import{L as z}from"./loader-circle-C2oGxQGC.js";import{S as P}from"./search-DuOucN67.js";import{M as N}from"./map-pin-CUrl_rxU.js";import{N as I}from"./navigation-bRHTcuFG.js";/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],R=L("external-link",G),Q=({setView:w})=>{const[o,p]=t.useState(""),[l,h]=t.useState(!1),[i,c]=t.useState(null),[u,g]=t.useState([]),[d,y]=t.useState(null);t.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{y({lat:s.coords.latitude,lng:s.coords.longitude})},s=>console.error("Error getting location",s),{enableHighAccuracy:!0})},[]);const x=async s=>{var r,a,b;if(s.trim()){h(!0),c(null),g([]);try{const m=new C({apiKey:"PLACEHOLDER_API_KEY"}),f={tools:[{googleMaps:{}}]};d&&(f.toolConfig={retrievalConfig:{latLng:{latitude:d.lat,longitude:d.lng}}});const j=await m.models.generateContent({model:"gemini-2.5-flash",contents:s,config:f});c(j.text||"No details found.");const A=(((b=(a=(r=j.candidates)==null?void 0:r[0])==null?void 0:a.groundingMetadata)==null?void 0:b.groundingChunks)||[]).map(n=>{var v;return(v=n.web)!=null&&v.uri?null:n.maps}).filter(n=>n);g(A)}catch(m){console.error("Maps Grounding Error:",m),c("Unable to connect to map services. Please try again later.")}finally{h(!1)}}},k=["Nearest emergency shelter","Open hospitals nearby","Where can I buy water?","Gas stations with power"];return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col pb-safe animate-fade-in",children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 p-4 sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("button",{onClick:()=>w("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(E,{size:24})}),e.jsx("h1",{className:"font-bold text-lg text-slate-900",children:"Map Assistant"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{placeholder:"Ask for places (e.g. 'Find nearby shelters')...",value:o,onChange:s=>p(s.target.value),className:"pr-12",onKeyDown:s=>s.key==="Enter"&&x(o)}),e.jsx("button",{onClick:()=>x(o),disabled:l,className:"absolute right-2 top-2 p-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 disabled:opacity-50",children:l?e.jsx(z,{size:20,className:"animate-spin"}):e.jsx(P,{size:20})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto py-3 no-scrollbar",children:k.map(s=>e.jsx("button",{onClick:()=>{p(s),x(s)},className:"px-3 py-1.5 bg-slate-100 text-slate-700 text-xs font-medium rounded-full whitespace-nowrap border border-slate-200 hover:bg-brand-50 hover:text-brand-700 hover:border-brand-200 transition-colors",children:s},s))})]}),e.jsxs("div",{className:"flex-1 p-4 overflow-y-auto",children:[!i&&!l&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 opacity-60",children:[e.jsx(N,{size:64,className:"mb-4"}),e.jsx("p",{children:"Use the search bar to find resources near you."})]}),i&&e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-brand-600 font-bold text-sm uppercase tracking-wide",children:[e.jsx(I,{size:16})," AERA Assistant"]}),e.jsx("div",{className:"prose prose-sm text-slate-800 leading-relaxed",children:i})]}),u.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm uppercase tracking-wider pl-1",children:"Located Places"}),u.map((s,r)=>{var a;return e.jsxs(M,{className:"flex items-start gap-4 hover:border-brand-300 transition-colors",children:[e.jsx("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-lg shrink-0",children:e.jsx(N,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-slate-900 truncate",children:s.title}),e.jsx("p",{className:"text-xs text-slate-500 mb-2 truncate",children:s.address||"Location details via Google Maps"}),((a=s.placeAnswerSources)==null?void 0:a.reviewSnippets)&&e.jsxs("p",{className:"text-xs text-slate-600 italic mb-3 line-clamp-2",children:['"',s.placeAnswerSources.reviewSnippets[0].text,'"']}),e.jsxs("a",{href:s.uri,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs font-bold text-brand-600 hover:underline",children:["View on Maps ",e.jsx(R,{size:12})]})]})]},r)})]})]})]})};export{Q as MapView};
