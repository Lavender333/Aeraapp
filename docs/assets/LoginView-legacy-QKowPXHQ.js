System.register(["./index-legacy-CUEbsImb.js","./Button-legacy-Ct7QJn9V.js","./Input-legacy-BMd5SFgd.js","./translations-legacy-BEsM6qOm.js","./mail-legacy-B4orGsTx.js","./octagon-alert-legacy-JVrabzed.js","./circle-question-mark-legacy-BI89czG1.js"],function(e,s){"use strict";var a,t,l,r,n,o,i,d,c,m,u;return{setters:[e=>{a=e.c,t=e.r,l=e.j,r=e.E,n=e.S},e=>{o=e.B},e=>{i=e.I},e=>{d=e.t},e=>{c=e.M},e=>{m=e.O},e=>{u=e.C}],execute:function(){
/**
       * @license lucide-react v0.556.0 - ISC
       *
       * This source code is licensed under the ISC license.
       * See the LICENSE file in the root directory of this source tree.
       */
const s=a("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),g=a("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);e("LoginView",({setView:e})=>{const[a,h]=t.useState(""),[x,p]=t.useState(""),[w,b]=t.useState(""),[y,j]=t.useState(""),[f,v]=t.useState(""),[S,N]=t.useState(""),[C,k]=t.useState(!1),[z,E]=t.useState(!1),[L,P]=t.useState(""),[A,R]=t.useState(!1),[I,O]=t.useState(!1);return t.useEffect(()=>{const e=window.location.hash||"",s=window.location.search||"";(e.includes("type=recovery")||s.includes("type=recovery"))&&(E(!0),k(!0),v("Enter a new password to finish resetting your account."))},[]),l.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col p-6 animate-fade-in pb-safe justify-center max-w-sm mx-auto w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-4 text-brand-700 border border-brand-200",children:l.jsx(g,{size:32})}),l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:d("login.welcome")}),l.jsx("p",{className:"text-slate-600 font-medium",children:d("login.subtitle")})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm space-y-4",children:[l.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase",children:"Email Login"}),l.jsx(i,{label:"Email",placeholder:"you@example.com",value:x,onChange:e=>p(e.target.value),className:"border-slate-300",leftIcon:l.jsx(c,{size:16})}),l.jsx(i,{label:"Password",type:"password",placeholder:"Your password",value:w,onChange:e=>b(e.target.value),className:"border-slate-300",leftIcon:l.jsx(s,{size:16})}),y&&l.jsxs("div",{className:"flex items-start gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:[l.jsx(m,{size:16,className:"mt-0.5 shrink-0"}),l.jsx("span",{children:y})]}),f&&l.jsxs("div",{className:"flex items-start gap-2 text-sm text-emerald-700 bg-emerald-50 p-3 rounded-lg",children:[l.jsx(u,{size:16,className:"mt-0.5 shrink-0"}),l.jsx("span",{children:f})]}),l.jsx(o,{fullWidth:!0,size:"lg",onClick:async()=>{j(""),v("");try{R(!0);const s=String(x||"").trim().toLowerCase(),a=String(w||"");if(!s||!a)return void j("Email and password are required.");console.log("Attempting login with email:",s),await n.loginWithCredentials(s,a);const t=n.getProfile();console.log("Login successful! Profile:",{id:t.id,name:t.fullName,role:t.role,onboardComplete:t.onboardComplete}),console.log("Redirecting to DASHBOARD"),e("DASHBOARD")}catch(s){console.error("Login error:",s),j((null==s?void 0:s.message)||"Login failed.")}finally{R(!1)}},className:"font-bold shadow-md",disabled:!x||!w||A,children:A?"Signing in…":d("login.btn")}),l.jsx("button",{className:"text-sm text-brand-600 font-semibold underline",onClick:()=>k(!C),children:"Forgot password?"}),C&&l.jsx("div",{className:"space-y-3 border border-slate-200 rounded-lg p-3 bg-slate-50",children:z?l.jsxs(l.Fragment,{children:[l.jsx(i,{label:"New Password",type:"password",placeholder:"New password",value:L,onChange:e=>P(e.target.value)}),l.jsx(o,{size:"sm",onClick:async()=>{j(""),v("");try{O(!0);const{error:e}=await r.auth.updateUser({password:L});if(e)throw e;v("Password updated. You can log in now."),E(!1),k(!1),P(""),await r.auth.signOut({scope:"local"}),window.history.replaceState({},document.title,window.location.pathname)}catch(e){j((null==e?void 0:e.message)||"Password reset failed")}finally{O(!1)}},disabled:!L,children:I?"Saving…":"Set new password"})]}):l.jsxs(l.Fragment,{children:[l.jsx(i,{label:"Email for reset",placeholder:"you@example.com",value:S,onChange:e=>N(e.target.value)}),l.jsx(o,{size:"sm",onClick:async()=>{j(""),v("");try{O(!0);const e=String(S||"").trim().toLowerCase();await n.requestPasswordReset(e),v("Check your email to reset your password.")}catch(e){const s=String((null==e?void 0:e.message)||"").toLowerCase();s.includes("rate")&&s.includes("limit")?j("Too many reset requests. Please wait a few minutes and try again."):j((null==e?void 0:e.message)||"Reset request failed")}finally{O(!1)}},disabled:!S||I,children:I?"Sending…":"Send reset email"})]})})]}),l.jsxs("div",{className:"mt-8 text-center",children:[l.jsx("p",{className:"text-slate-600",children:d("login.no_account")}),l.jsx(o,{variant:"ghost",onClick:()=>e("REGISTRATION"),className:"text-brand-700 font-bold hover:bg-brand-50 mt-1",children:d("login.create")})]})]})})}}});
