import{a as n,j as e,a0 as Vs,i as te,a1 as je,X as Hs,G as R,a2 as Ne,a3 as Gs,a4 as Ys,z as qe,a5 as Ws,A as Js,a6 as Y,a7 as ve,M as es,a8 as ye,a9 as Qs,aa as Xs,q as ss,U as we,ab as Zs,ac as ts,o as se,ad as as,ae as ls,I as Ks,af as ns,ag as qs,ah as et,ai as st,aj as tt,ak as rs,al as is,am as os,an as at}from"./vendor-react-DZ0IVLBb.js";import{T as ds,I as w}from"./Input-D28zJcRZ.js";import{B as d}from"./Button-BzswROfv.js";import{H as lt}from"./HouseholdManager-LBbBYSIJ.js";import{S as m,f as nt,b as rt,c as it,e as ot,l as W,u as cs,j as dt,d as xs,r as ct,v as xt,h as mt}from"./index-Cbj0oizH.js";import{t as Ce}from"./translations-gvebLRaU.js";import"./vendor-CCVjAPEY.js";import"./vendor-maps-S3fC-LOA.js";import"./vendor-jspdf-Bd23t5aa.js";import"./vendor-supabase-ChvUvA8t.js";const ms=({onSave:I,className:l})=>{const g=n.useRef(null),[ae,N]=n.useState(!1),[A,v]=n.useState(!1);n.useEffect(()=>{const c=g.current;if(c){const p=c.getBoundingClientRect();c.width=p.width,c.height=p.height;const j=c.getContext("2d");j&&(j.lineWidth=2,j.lineCap="round",j.strokeStyle="#000")}},[]);const J=c=>{const p=g.current;if(!p)return{x:0,y:0};const j=p.getBoundingClientRect();let S,k;return"touches"in c?(S=c.touches[0].clientX,k=c.touches[0].clientY):(S=c.clientX,k=c.clientY),{x:S-j.left,y:k-j.top}},D=c=>{var j;c.preventDefault(),N(!0);const p=(j=g.current)==null?void 0:j.getContext("2d");if(p){const{x:S,y:k}=J(c);p.beginPath(),p.moveTo(S,k)}},E=c=>{var j;if(!ae)return;c.preventDefault();const p=(j=g.current)==null?void 0:j.getContext("2d");if(p){const{x:S,y:k}=J(c);p.lineTo(S,k),p.stroke(),v(!0)}},M=()=>{N(!1)},C=()=>{const c=g.current,p=c==null?void 0:c.getContext("2d");c&&p&&(p.clearRect(0,0,c.width,c.height),v(!1))},z=()=>{if(g.current){const c=g.current.toDataURL("image/png");I(c)}};return e.jsxs("div",{className:`space-y-3 ${l}`,children:[e.jsxs("div",{className:"border-2 border-slate-300 rounded-xl overflow-hidden bg-white shadow-inner relative",children:[e.jsx("canvas",{ref:g,className:"w-full h-40 touch-none cursor-crosshair block",onMouseDown:D,onMouseMove:E,onMouseUp:M,onMouseLeave:M,onTouchStart:D,onTouchMove:E,onTouchEnd:M}),e.jsx("div",{className:"absolute bottom-2 left-4 text-xs text-slate-300 pointer-events-none font-bold uppercase select-none",children:"Sign Here"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",onClick:C,size:"sm",className:"flex-1 text-slate-500 border-slate-300",children:[e.jsx(Vs,{size:16,className:"mr-2"})," Clear"]}),e.jsxs(d,{onClick:z,size:"sm",disabled:!A,className:"flex-1 font-bold bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(te,{size:16,className:"mr-2"})," Apply Signature"]})]})]})},hs=I=>{if(!I)return I;const l=I.replace(/[^\d]/g,""),g=l.length;return g<4?l:g<7?`(${l.slice(0,3)}) ${l.slice(3)}`:`(${l.slice(0,3)}) ${l.slice(3,6)}-${l.slice(6,10)}`},ht=[{id:"ADMIN",label:"Administrator",description:"Full system access and user management.",permissions:{canViewPII:!0,canDispatchDrone:!0,canApproveFunds:!0,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"FIRST_RESPONDER",label:"First Responder",description:"Field access to location data and medical info.",permissions:{canViewPII:!0,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"LOCAL_AUTHORITY",label:"Local Authority",description:"Oversight of alerts and population tracking.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!0,canManageInventory:!1,canBroadcastAlerts:!0}},{id:"CONTRACTOR",label:"Contractor",description:"Logistics and repair management.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!1}},{id:"INSTITUTION_ADMIN",label:"Institution Admin",description:"Manage community members and hub inventory.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!0,canBroadcastAlerts:!0}},{id:"GENERAL_USER",label:"General User",description:"Standard access to report emergencies.",permissions:{canViewPII:!1,canDispatchDrone:!1,canApproveFunds:!1,canManageInventory:!1,canBroadcastAlerts:!1}}],Ct=({setView:I})=>{const[l,g]=n.useState({id:"",fullName:"",phone:"",address:"",householdMembers:1,household:[],zipCode:"",petDetails:"",medicalNeeds:"",medicationDependency:!1,insulinDependency:!1,oxygenPoweredDevice:!1,mobilityLimitation:!1,transportationAccess:!0,financialStrain:!1,consentPreparednessPlanning:!1,emergencyContactName:"",emergencyContactPhone:"",emergencyContactRelation:"",communityId:"",role:"GENERAL_USER",language:"en",active:!0,notifications:{push:!0,sms:!0,email:!0}}),ae=String(l.role||"").toUpperCase(),N=["ADMIN","STATE_ADMIN","COUNTY_ADMIN","ORG_ADMIN","INSTITUTION_ADMIN"].includes(ae),[A,v]=n.useState("MAIN"),[J,D]=n.useState(!1),[E,M]=n.useState(!1),[C,z]=n.useState(null),[c,p]=n.useState(null),[j,S]=n.useState(!1),[k,Se]=n.useState(null),[$,ke]=n.useState("IDLE"),[Q,le]=n.useState("ALL_USERS"),[Ie,ps]=n.useState(()=>m.getRoles()||ht),[ne,re]=n.useState([]),[Ae,us]=n.useState(""),[x,X]=n.useState(null),[y,bs]=n.useState(null),[ie,Z]=n.useState([]),[_,gs]=n.useState(""),[h,K]=n.useState(null),[oe,de]=n.useState([]),[fs,De]=n.useState(!1),[F,q]=n.useState([]),[b,ce]=n.useState(null),[xe,ze]=n.useState({}),[Re,Ee]=n.useState(!1),[Pe,Oe]=n.useState(!1),[Le,Me]=n.useState(null),[Ue,V]=n.useState(null),[me,Te]=n.useState(""),[Be,he]=n.useState(null),[$e,_e]=n.useState(null),[Fe,Ve]=n.useState(!1),[He,P]=n.useState([]),[Ge,U]=n.useState(null),[Ye,T]=n.useState(null),[H,B]=n.useState(null),[We,pe]=n.useState(""),ue=s=>{g(a=>({...a,householdId:s.householdId,householdCode:s.householdCode,householdName:s.householdName,householdRole:s.householdRole}));const t=m.getProfile();m.saveProfile({...t,householdId:s.householdId,householdCode:s.householdCode,householdName:s.householdName,householdRole:s.householdRole})};n.useEffect(()=>{const s=m.getProfile();if(s.role||(s.role="GENERAL_USER"),s.language||(s.language="en"),s.active===void 0&&(s.active=!0),s.household||(s.household=[]),typeof s.zipCode!="string"&&(s.zipCode=""),typeof s.medicationDependency!="boolean"&&(s.medicationDependency=!1),typeof s.insulinDependency!="boolean"&&(s.insulinDependency=!1),typeof s.oxygenPoweredDevice!="boolean"&&(s.oxygenPoweredDevice=!1),typeof s.mobilityLimitation!="boolean"&&(s.mobilityLimitation=!1),typeof s.transportationAccess!="boolean"&&(s.transportationAccess=!0),typeof s.financialStrain!="boolean"&&(s.financialStrain=!1),typeof s.consentPreparednessPlanning!="boolean"&&(s.consentPreparednessPlanning=!1),g(s),s.address&&s.address.length>5&&ke("VALID"),s.communityId&&s.role!=="INSTITUTION_ADMIN"){const t=m.getOrganization(s.communityId);t&&z(t.name)}},[]),n.useEffect(()=>{let s=!0;return(async()=>{try{const[a,r]=await Promise.all([nt(),rt()]);if(!s)return;if(a||r){const o={...m.getProfile(),...a||{},...r||{}};m.saveProfile(o),g(o)}const i=await it();if(!s)return;if(i)ue(i);else{const u=await ot();if(!s)return;ue(u)}}catch{}})(),()=>{s=!1}},[]),n.useEffect(()=>{!N&&A!=="MAIN"&&v("MAIN")},[N,A]),n.useEffect(()=>{const s=Array.isArray(l.household)?l.household.length:0;s>0&&l.householdMembers!==s&&g(t=>({...t,householdMembers:s}))},[l.household,l.householdMembers]),n.useEffect(()=>{let s=!0;return(async()=>{if(!l.householdId){P([]);return}try{const a=await W();s&&P(a)}catch{s&&P([])}})(),()=>{s=!1}},[l.householdId]),n.useEffect(()=>{if(h){const s=m.getOrgMembers(h.id);de(s),m.fetchOrgMembersRemote(h.id).then(({members:t,fromCache:a})=>{de(t),De(a)}).catch(()=>De(!0))}else de([])},[h]);const Je=s=>/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(s)?(Se(null),!0):(Se("Invalid format. Use 555-123-4567"),!1),js=async()=>{if(!Je(l.phone)){alert("Please fix phone number errors before saving.");return}if($==="INVALID"){alert("Please verify your address.");return}Ee(!0),Me(null);try{await cs({fullName:l.fullName,phone:l.phone,email:l.email,address:l.address,emergencyContactName:l.emergencyContactName,emergencyContactPhone:l.emergencyContactPhone,emergencyContactRelation:l.emergencyContactRelation,communityId:l.communityId,role:l.role}),m.saveProfile(l),D(!0),setTimeout(()=>D(!1),2e3)}catch(s){Me((s==null?void 0:s.message)||"Unable to update profile.")}finally{Ee(!1)}},Ns=async()=>{var t;if(!((t=l.zipCode)!=null&&t.trim())){V("ZIP code is required for preparedness planning.");return}const s=xt(l.household||[]);if(!s.ok){V(s.error);return}if(!l.consentPreparednessPlanning){V("You must provide consent before saving Vital Intake.");return}Oe(!0),V(null);try{await mt({household:l.household,householdMembers:l.householdMembers,petDetails:l.petDetails,medicalNeeds:l.medicalNeeds,zipCode:l.zipCode,medicationDependency:!!l.medicationDependency,insulinDependency:!!l.insulinDependency,oxygenPoweredDevice:!!l.oxygenPoweredDevice,mobilityLimitation:!!l.mobilityLimitation,transportationAccess:!!l.transportationAccess,financialStrain:!!l.financialStrain,consentPreparednessPlanning:!!l.consentPreparednessPlanning});const a={...l,consentTimestamp:new Date().toISOString()};g(a),m.saveProfile(a),D(!0),setTimeout(()=>D(!1),2e3)}catch(a){V((a==null?void 0:a.message)||"Unable to update vitals.")}finally{Oe(!1)}},f=(s,t)=>{g(a=>({...a,[s]:t})),s==="communityId"&&(z(null),p(null)),s==="address"&&ke("IDLE")},Qe=()=>{l.communityId&&(M(!0),p(null),z(null),setTimeout(()=>{const s=m.getOrganization(l.communityId);M(!1),s?z(s.name):p("Invalid Community ID")},800))},vs=async()=>{if(l.communityId){S(!0),p(null);try{await cs({fullName:l.fullName,phone:l.phone,email:l.email,address:l.address,emergencyContactName:l.emergencyContactName,emergencyContactPhone:l.emergencyContactPhone,emergencyContactRelation:l.emergencyContactRelation,communityId:"",role:l.role});const s={...l,communityId:""};g(s),m.saveProfile(s),z(null),p(null)}catch(s){p((s==null?void 0:s.message)||"Unable to disconnect organization right now.")}finally{S(!1)}}},ee=s=>{navigator.clipboard.writeText(s),alert("Copied to clipboard")},be=s=>{const t=(l.householdCode||"").trim().toUpperCase(),a=(s.id||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(-3),i=((s.name||"").replace(/[^A-Z0-9]/gi,"").toUpperCase().slice(0,3)||a||"MEM").padEnd(3,"X").slice(0,3);return t?`${t}-${i}`:i},Xe=(l.household||[]).filter(s=>s.loginEnabled),O=n.useMemo(()=>{const s={};return He.forEach(t=>{t.inviteeMemberRef&&(s[t.inviteeMemberRef]||(s[t.inviteeMemberRef]=t))}),s},[He]),ys=async s=>{U(null),T(null),B(s.id);try{const t=await xs({memberId:s.id,memberName:s.name,suggestedCode:be(s)}),a=`AERA invite for ${s.name}: use invite code ${t.invitationCode} to join this household.`;await navigator.clipboard.writeText(a),U(`Invite copied for ${s.name}. Current status: ${t.status}.`);const r=await W();P(r)}catch(t){T((t==null?void 0:t.message)||"Unable to create invite right now.")}finally{B(null)}},ws=async s=>{U(null),T(null),B(s.id);try{const t=await xs({memberId:s.id,memberName:s.name,suggestedCode:be(s),forceNew:!0}),a=`AERA invite for ${s.name}: use invite code ${t.invitationCode} to join this household.`;await navigator.clipboard.writeText(a),U(`New invite generated for ${s.name}.`);const r=await W();P(r)}catch(t){T((t==null?void 0:t.message)||"Unable to resend invite right now.")}finally{B(null)}},Cs=async s=>{const t=O[s.id];if(!(!(t!=null&&t.id)||t.status!=="PENDING")){U(null),T(null),B(s.id);try{await ct(t.id),U(`Invite revoked for ${s.name}.`);const a=await W();P(a)}catch(a){T((a==null?void 0:a.message)||"Unable to revoke invite right now.")}finally{B(null)}}},Ss=async()=>{he(null),_e(null);const s=me.trim().toUpperCase();if(s.length<6){he("Enter a valid household or invite code.");return}Ve(!0);try{const t=await dt(s);ue(t),_e(`Joined ${t.householdName}.`),Te("");try{const a=await W();P(a)}catch{}}catch(t){he((t==null?void 0:t.message)||"Unable to join household.")}finally{Ve(!1)}},ks=()=>{m.logoutUser(),I("LOGIN")},Is=()=>{if(!N)return;const s=m.getDB();bs(s),v("DB_VIEWER")},As=()=>{if(!N)return;const s=m.getDB();Z(s.organizations),v("ORG_DIRECTORY"),K(null)},Ds=()=>{if(console.info("[AccessControl] openAccessControl clicked",{isAdmin:N}),!N){console.warn("[AccessControl] blocked: not admin");return}const s=m.getDB();console.info("[AccessControl] loading users",{count:Array.isArray(s.users)?s.users.length:0}),re(Array.isArray(s.users)?s.users:[]),le("ALL_USERS"),v("ACCESS_CONTROL"),X(null)},zs=()=>{if(!N)return;const s=m.getDB();Z(s.organizations),pe(s.tickerMessage),v("BROADCAST_CONTROL")},Rs=()=>{if(!N)return;const s=m.getAllReplenishmentRequests();q(s),v("MASTER_INVENTORY")},Es=(s,t)=>{ps(a=>{const r=a.map(i=>i.id===s?{...i,permissions:{...i.permissions,[t]:!i.permissions[t]}}:i);return m.saveRoles(r),r})},Ps=(s,t)=>{N&&re(a=>{const r=a.map(u=>u.id===s?{...u,role:t}:u),i=r.find(u=>u.id===s);return i&&m.saveProfile(i),r})},Os=(s,t)=>{if(!N)return;const a=!t;m.updateUserStatus(s,a),re(r=>r.map(i=>i.id===s?{...i,active:a}:i)),X(r=>r&&r.id===s?{...r,active:a}:r)},Ls=()=>{const s=["ID","Name","Phone","Role","Status","Address","Community ID","Household Size"],t=ne.map(o=>[o.id,`"${o.fullName.replace(/"/g,'""')}"`,o.phone,o.role,o.active?"Active":"Inactive",`"${o.address.replace(/"/g,'""')}"`,o.communityId||"N/A",o.householdMembers]),a=[s.join(","),...t.map(o=>o.join(","))].join(`
`),r=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(r),u=document.createElement("a");u.href=i,u.setAttribute("download",`AERA_User_Directory_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u)},Ms=(s,t)=>{const a=!t;m.updateOrgStatus(s,a),Z(r=>r.map(i=>i.id===s?{...i,active:a}:i)),h&&h.id===s&&K(r=>r?{...r,active:a}:null)},Us=()=>{m.updateSystemTicker(We),alert("Global System Alert Updated")},Ts=s=>{m.clearOrgBroadcast(s),Z(t=>t.map(a=>a.id===s?{...a,currentBroadcast:void 0}:a))},ge=s=>{g(t=>{const a={...t,language:s};return m.saveProfile(a),a}),D(!0),setTimeout(()=>D(!1),1e3)},Bs=s=>{m.updateReplenishmentRequestStatus(s,"FULFILLED"),q(t=>t.map(a=>a.id===s?{...a,status:"FULFILLED"}:a))},$s=s=>{m.updateReplenishmentRequestStatus(s,"PENDING"),q(t=>t.map(a=>a.id===s?{...a,status:"PENDING"}:a))},Ze=s=>{ze({}),ce(s)},fe=(s,t)=>{ze(a=>({...a,[s]:t}))},Ke=(s,t)=>{if(b){m.signReplenishmentRequest(b.id,s,t);const a={...b};t==="RELEASE"?(a.signature=s,a.signedAt=new Date().toISOString()):(a.receivedSignature=s,a.receivedAt=new Date().toISOString()),ce(a),q(r=>r.map(i=>i.id===b.id?a:i))}},_s=()=>{const s=["Request ID","Org Name","Org ID","Item","Quantity","Status","Date","Provider","Released","Received"],t=F.map(o=>[o.id,`"${o.orgName.replace(/"/g,'""')}"`,o.orgId,`"${o.item.replace(/"/g,'""')}"`,o.quantity,o.status,new Date(o.timestamp).toLocaleDateString(),`"${o.provider.replace(/"/g,'""')}"`,o.signature?"Yes":"No",o.receivedSignature?"Yes":"No"]),a=[s.join(","),...t.map(o=>o.join(","))].join(`
`),r=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(r),u=document.createElement("a");u.href=i,u.setAttribute("download",`AERA_Master_Inventory_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u)},Fs=()=>{const s=F.reduce((L,G)=>(L[G.item]=(L[G.item]||0)+G.quantity,L),{}),t=["Item Name","Total Quantity"],a=Object.entries(s).map(([L,G])=>[`"${L.replace(/"/g,'""')}"`,G]),r=[t.join(","),...a.map(L=>L.join(","))].join(`
`),i=new Blob([r],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(i),o=document.createElement("a");o.href=u,o.setAttribute("download",`AERA_Inventory_Tally_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(o),o.click(),document.body.removeChild(o)};if(b){const s=m.getOrganization(b.orgId);return e.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto bg-white p-8 font-serif text-black animate-fade-in print:p-0 print:bg-white print:text-black print:static print:overflow-visible",children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 p-4 bg-slate-900 text-white flex justify-between items-center print:hidden shadow-lg z-50",children:[e.jsx("span",{className:"font-bold",children:"Work Order Preview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",className:"bg-brand-600 text-white",onClick:()=>window.print(),children:[e.jsx(je,{size:16,className:"mr-2"})," Print Now"]}),e.jsxs(d,{size:"sm",variant:"secondary",onClick:()=>ce(null),children:[e.jsx(Hs,{size:16,className:"mr-2"})," Close"]})]})]}),e.jsxs("div",{className:"max-w-3xl mx-auto border border-black p-8 mt-16 print:mt-0 print:border-0 print:w-full",children:[e.jsxs("div",{className:"flex justify-between items-start border-b-2 border-black pb-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold uppercase tracking-tight",children:"Work Order"}),e.jsx("p",{className:"text-sm font-bold uppercase mt-1",children:"AERA Logistics Fulfillment"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Order ID:"})," ",b.id]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Printed On:"})," ",new Date().toLocaleDateString()]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Request Date:"})," ",new Date(b.timestamp).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Provider:"})," ",b.provider]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Ship To (Organization)"}),e.jsx("p",{className:"text-lg font-bold",children:b.orgName}),e.jsx("p",{children:(s==null?void 0:s.address)||"Address Unknown"}),e.jsx("p",{children:s==null?void 0:s.adminContact}),e.jsx("p",{children:s==null?void 0:s.adminPhone}),e.jsxs("p",{className:"mt-2 text-sm font-mono",children:["ID: ",b.orgId]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-2 text-sm",children:"Fulfillment Instructions"}),e.jsx("p",{className:"text-sm mb-2",children:"Please pick and pack the items listed below. Ensure quality check is performed before release."}),e.jsxs("div",{className:"border border-black p-2 text-center mt-4",children:[e.jsx("p",{className:"text-xs uppercase font-bold",children:"Priority Status"}),e.jsx("p",{className:"text-xl font-bold",children:"URGENT"})]})]})]}),e.jsx("div",{className:"mb-12",children:e.jsxs("table",{className:"w-full border-collapse border border-black",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[e.jsx("th",{className:"border border-black p-2 text-left w-12 print:text-black",children:"#"}),e.jsx("th",{className:"border border-black p-2 text-left print:text-black",children:"Requested Item"}),e.jsx("th",{className:"border border-black p-2 text-center w-24 print:text-black",children:"Qty Req"}),e.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Qty Picked"}),e.jsx("th",{className:"border border-black p-2 text-center w-28 print:text-black",children:"Verified"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-3 text-center print:text-black",children:"1"}),e.jsx("td",{className:"border border-black p-3 font-bold text-lg print:text-black",children:b.item}),e.jsx("td",{className:"border border-black p-3 text-center font-bold text-lg print:text-black",children:b.quantity}),e.jsx("td",{className:"border border-black p-1",children:e.jsx("input",{className:"w-full h-full text-center font-bold text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:xe.item_picked||"",onChange:t=>fe("item_picked",t.target.value)})}),e.jsx("td",{className:"border border-black p-1",children:e.jsx("input",{className:"w-full h-full text-center font-medium text-lg bg-yellow-50/50 hover:bg-yellow-50 focus:bg-white outline-none transition-colors print:bg-transparent print:border-none",placeholder:"",value:xe.item_verified||"",onChange:t=>fe("item_verified",t.target.value)})})]}),[2,3].map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-3 text-center opacity-50 print:text-black",children:t}),e.jsx("td",{className:"border border-black p-2",children:e.jsxs("div",{className:"flex items-center gap-2 h-full",children:[e.jsx("span",{className:"italic text-slate-500 text-sm whitespace-nowrap print:text-black",children:"Notes/Substitutions:"}),e.jsx("input",{className:"flex-1 bg-transparent border-b border-slate-300 focus:border-blue-500 outline-none text-slate-900 print:border-none print:text-black font-mono",value:xe[`note_${t}`]||"",onChange:a=>fe(`note_${t}`,a.target.value)})]})}),e.jsx("td",{className:"border border-black p-3"}),e.jsx("td",{className:"border border-black p-3"}),e.jsx("td",{className:"border border-black p-3"})]},t))]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-12 mt-12 pt-12",children:[e.jsxs("div",{className:"break-inside-avoid",children:[e.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Released By (Signature)"}),b.signature?e.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[e.jsx("img",{src:b.signature,alt:"Digital Signature",className:"h-16 mb-1"}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(b.signedAt||"").toLocaleString()]})]}):e.jsx("div",{className:"print:hidden",children:e.jsx(ms,{onSave:t=>Ke(t,"RELEASE")})}),!b.signature&&e.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]}),e.jsxs("div",{className:"break-inside-avoid",children:[e.jsx("p",{className:"text-xs font-bold uppercase mb-2",children:"Received By (Signature)"}),b.receivedSignature?e.jsxs("div",{className:"border border-slate-200 p-2 print:border-none",children:[e.jsx("img",{src:b.receivedSignature,alt:"Digital Signature",className:"h-16 mb-1"}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-mono print:text-black",children:["Signed: ",new Date(b.receivedAt||"").toLocaleString()]})]}):e.jsx("div",{className:"print:hidden",children:e.jsx(ms,{onSave:t=>Ke(t,"RECEIVE")})}),!b.receivedSignature&&e.jsx("div",{className:"hidden print:block border-b border-black mb-2 h-16"})]})]}),e.jsx("div",{className:"text-center mt-12 text-xs text-slate-500 print:text-black",children:e.jsxs("p",{children:["Generated by AERA System • ",new Date().toLocaleString()]})})]})]})}if(A==="MASTER_INVENTORY"){const s=F.reduce((t,a)=>(t[a.item]=(t[a.item]||0)+a.quantity,t),{});return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-white min-h-screen print:p-0 print:pb-0",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-white z-10 print:hidden",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>v("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(R,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Master Inventory Database"}),e.jsx("p",{className:"text-xs text-slate-500",children:"System-Wide Supply Request Aggregation"})]})]})}),e.jsxs("div",{className:"hidden print:block mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"AERA Master Inventory Report"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Generated on ",new Date().toLocaleString()]})]}),e.jsxs("div",{className:"space-y-4 print:break-inside-avoid",children:[e.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Total Tally (All Organizations)"}),e.jsxs("button",{onClick:Fs,className:"text-xs font-bold text-brand-600 hover:text-brand-700 flex items-center gap-1 print:hidden",children:[e.jsx(Ne,{size:14})," Export Tally CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Object.entries(s).map(([t,a])=>e.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-lg print:border-black print:bg-white print:border",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase",children:t}),e.jsx("p",{className:"text-2xl font-mono font-bold text-slate-900",children:a})]},t)),Object.keys(s).length===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No requests logged."})]})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsxs("div",{className:"flex justify-between items-end border-b-2 border-slate-900 pb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 uppercase tracking-wider",children:"Request Log"}),e.jsxs(d,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-50 print:hidden h-8",onClick:_s,children:[e.jsx(Ne,{size:14,className:"mr-2"})," Export Log CSV"]})]}),e.jsx("div",{className:"overflow-x-auto print:overflow-visible",children:e.jsxs("table",{className:"w-full text-left text-sm print:text-xs",children:[e.jsx("thead",{className:"print:table-header-group",children:e.jsxs("tr",{className:"bg-slate-100 print:bg-slate-200",children:[e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Organization"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Item"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Qty"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Date"}),e.jsx("th",{className:"p-3 font-bold text-slate-700",children:"Status"}),e.jsx("th",{className:"p-3 font-bold text-slate-700 print:hidden",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[F.map(t=>e.jsxs("tr",{className:"print:break-inside-avoid",children:[e.jsxs("td",{className:"p-3 font-medium text-slate-900",children:[t.orgName," ",e.jsx("span",{className:"text-xs text-slate-500 block",children:t.orgId})]}),e.jsx("td",{className:"p-3 text-slate-700",children:t.item}),e.jsx("td",{className:"p-3 font-mono font-bold text-slate-900",children:t.quantity}),e.jsx("td",{className:"p-3 text-slate-500",children:new Date(t.timestamp).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${t.status==="FULFILLED"?"bg-green-100 text-green-700 print:border print:border-black":"bg-yellow-100 text-yellow-700 print:border print:border-black"}`,children:t.status})}),e.jsx("td",{className:"p-3 print:hidden",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.status==="PENDING"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",onClick:()=>Bs(t.id),className:"bg-green-600 hover:bg-green-700 text-xs py-1 h-8",children:[e.jsx(Gs,{size:14,className:"mr-1"})," Fulfill"]}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Ze(t),className:"text-xs py-1 h-8 px-2 border-slate-300",title:t.signature?"Print Work Order":"Sign Work Order",children:t.signature&&t.receivedSignature?e.jsx(je,{size:14}):e.jsx(Ys,{size:14})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Ze(t),className:"text-xs py-1 h-8 px-2 border-slate-300 mr-2",title:"View Signed Order",children:t.signature&&t.receivedSignature?e.jsx(qe,{size:14,className:"text-green-600"}):e.jsx(je,{size:14})}),e.jsxs("button",{onClick:()=>$s(t.id),className:"text-xs text-slate-400 hover:text-blue-600 hover:underline flex items-center gap-0.5",title:"Undo Completion",children:[e.jsx(Ws,{size:10})," Undo"]})]})})})]},t.id)),F.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center text-slate-500",children:"No requests found."})})]})]})})]}),e.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t border-slate-300 text-center text-xs text-slate-500 fixed bottom-0 left-0 right-0",children:e.jsx("p",{children:"End of Report • AERA System"})})]})}if(A==="BROADCAST_CONTROL")return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsx("button",{onClick:()=>v("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(R,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Broadcast Control"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Manage System & Organization Alerts"})]})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-xl shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-red-900 mb-2 flex items-center gap-2",children:[e.jsx(Js,{size:18})," Global System Alert"]}),e.jsx("p",{className:"text-xs text-red-700 mb-3",children:"This message overrides ALL organization broadcasts and is visible to every user."}),e.jsx(ds,{className:"bg-white border-red-200 mb-3",value:We,onChange:s=>pe(s.target.value),placeholder:"Enter high-priority system alert..."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>pe(""),className:"text-slate-500",children:"Clear"}),e.jsx(d,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:Us,children:"Update Global Alert"})]})]}),e.jsx("h3",{className:"font-bold text-slate-900 mt-4",children:"Active Organization Broadcasts"}),e.jsxs("div",{className:"space-y-3",children:[ie.filter(s=>s.currentBroadcast).map(s=>e.jsxs("div",{className:"bg-white border border-slate-200 p-4 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"font-bold text-slate-900",children:s.name}),e.jsx("button",{onClick:()=>Ts(s.id),className:"text-xs text-red-600 font-bold hover:underline",children:"Remove"})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded text-sm text-slate-700 italic",children:['"',s.currentBroadcast,'"']}),e.jsxs("div",{className:"text-xs text-slate-400 mt-2 text-right",children:["Last Updated: ",new Date(s.lastBroadcastTime||"").toLocaleString()]})]},s.id)),ie.filter(s=>s.currentBroadcast).length===0&&e.jsx("p",{className:"text-center text-slate-400 py-4 italic",children:"No active organization broadcasts."})]})]});if(A==="DB_VIEWER")return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-900 min-h-screen text-slate-300 font-mono",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-4 sticky top-0 bg-slate-900 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>v("MAIN"),className:"p-2 -ml-2 text-slate-400 hover:text-white",children:e.jsx(R,{size:24})}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"Database Viewer"})]}),e.jsxs(d,{size:"sm",variant:"ghost",className:"text-brand-400 hover:text-brand-300 hover:bg-slate-800",onClick:()=>ee(JSON.stringify(y,null,2)),children:[e.jsx(Y,{size:16,className:"mr-2"})," Copy JSON"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("h3",{className:"text-brand-400 font-bold mb-2",children:["Users (",y==null?void 0:y.users.length,")"]}),e.jsx("pre",{className:"text-xs overflow-auto max-h-60 text-slate-300",children:JSON.stringify(y==null?void 0:y.users,null,2)})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("h3",{className:"text-purple-400 font-bold mb-2",children:["Organizations (",y==null?void 0:y.organizations.length,")"]}),e.jsx("div",{className:"space-y-2",children:y==null?void 0:y.organizations.map(s=>e.jsxs("div",{className:"p-2 bg-slate-900 rounded border border-slate-600 flex justify-between",children:[e.jsx("span",{children:s.name}),e.jsx("span",{className:"text-purple-300 select-all font-bold",children:s.id})]},s.id))})]})]})]});if(A==="ORG_DIRECTORY"){const s=ie.filter(t=>t.name.toLowerCase().includes(_.toLowerCase())||t.id.toLowerCase().includes(_.toLowerCase())||t.type.toLowerCase().includes(_.toLowerCase()));return e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>v("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(R,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"Organization Directory"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Search and View Registered Hubs"})]})]})}),h?e.jsxs("div",{className:"animate-slide-up space-y-6",children:[e.jsxs(d,{variant:"ghost",onClick:()=>K(null),className:"pl-0 text-slate-500",children:[e.jsx(R,{size:16,className:"mr-1"})," Back to list"]}),e.jsxs("div",{className:`bg-white rounded-2xl border ${h.active?"border-slate-200":"border-red-300"} shadow-lg overflow-hidden`,children:[e.jsx("div",{className:`${h.active?"bg-purple-600":"bg-slate-600"} p-6 text-white`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("span",{className:"inline-block px-2 py-1 bg-white/20 rounded text-xs font-bold border border-white/30",children:h.type}),!h.active&&e.jsx("span",{className:"inline-block px-2 py-1 bg-red-500 rounded text-xs font-bold",children:"SUSPENDED"})]}),e.jsx("h2",{className:"text-2xl font-bold",children:h.name}),e.jsxs("p",{className:"flex items-center gap-1 text-white/80 text-sm mt-1",children:[e.jsx(ve,{size:14})," ",h.verified?"Verified Partner":"Unverified"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/60 font-bold uppercase tracking-wider",children:"Community ID"}),e.jsx("p",{className:"text-3xl font-mono font-black tracking-widest",children:h.id})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Location & Contact"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(es,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Address"}),e.jsx("p",{className:"text-sm text-slate-600",children:h.address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Admin"}),e.jsx("p",{className:"text-sm text-slate-600",children:h.adminContact}),e.jsx("p",{className:"text-xs text-slate-500",children:h.adminPhone})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2",children:"Logistics Profile"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Qs,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Replenishment Provider"}),e.jsx("p",{className:"text-sm text-slate-600",children:h.replenishmentProvider})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Xs,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Email"}),e.jsx("p",{className:"text-sm text-slate-600 break-all",children:h.replenishmentEmail||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ss,{className:"text-slate-400 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Supply Phone"}),e.jsx("p",{className:"text-sm text-slate-600",children:h.replenishmentPhone||"N/A"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(we,{size:18,className:"text-slate-400"})," Registered Members (",oe.length,")",fs&&e.jsx("span",{className:"text-[11px] text-amber-600 font-semibold",children:"Using cached list"})]}),oe.length===0?e.jsx("p",{className:"text-slate-500 text-sm italic",children:"No members linked yet."}):e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-slate-100 rounded-lg p-2 bg-slate-50",children:oe.map(t=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 flex justify-between items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs text-white ${t.status==="SAFE"?"bg-green-500":t.status==="DANGER"?"bg-red-500":"bg-slate-400"}`,children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:t.name}),e.jsx("p",{className:"text-[10px] text-slate-500",children:t.phone})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ${t.status==="SAFE"?"bg-green-100 text-green-700":t.status==="DANGER"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-600"}`,children:t.status})})]},t.id))})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 border-t border-slate-200 flex justify-between items-center",children:[e.jsx(d,{size:"sm",variant:h.active?"danger":"primary",onClick:()=>Ms(h.id,h.active),className:h.active?"bg-red-50 text-red-600 border border-red-200 hover:bg-red-100":"bg-green-600 text-white",children:h.active?e.jsxs(e.Fragment,{children:[e.jsx(Zs,{size:16,className:"mr-2"})," Deactivate Org"]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{size:16,className:"mr-2"})," Activate Org"]})}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>ee(h.id),children:[e.jsx(Y,{size:16,className:"mr-2"})," Copy Code"]})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3.5 text-slate-400",size:20}),e.jsx(w,{className:"pl-10",placeholder:"Search by Name, Type, or ID...",value:_,onChange:t=>gs(t.target.value)})]}),e.jsx("div",{className:"space-y-3",children:s.length===0?e.jsxs("div",{className:"text-center py-10 text-slate-400",children:[e.jsx(se,{size:48,className:"mx-auto mb-2 opacity-20"}),e.jsxs("p",{children:['No organizations found matching "',_,'"']})]}):s.map(t=>e.jsxs("button",{onClick:()=>K(t),className:`w-full bg-white p-4 rounded-xl border shadow-sm hover:shadow-md transition-all text-left flex justify-between items-center group ${t.active?"border-slate-200 hover:border-purple-300":"border-red-200 bg-red-50/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg border ${t.active?"bg-purple-50 text-purple-600 border-purple-100":"bg-slate-200 text-slate-500 border-slate-300"}`,children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("h3",{className:`font-bold transition-colors ${t.active?"text-slate-900 group-hover:text-purple-700":"text-slate-500"}`,children:[t.name," ",!t.active&&e.jsx("span",{className:"text-[10px] text-red-500 ml-2 font-bold uppercase",children:"(Inactive)"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded border border-slate-200",children:t.type}),e.jsx("span",{className:"font-mono",children:t.id})]})]})]}),e.jsx(as,{size:20,className:"text-slate-300 group-hover:text-purple-500"})]},t.id))})]})]})}if(A==="ACCESS_CONTROL"){const s=Array.isArray(ne)?ne:[],t=s.filter(a=>{const r=(a.fullName||"").toLowerCase(),i=(a.phone||"").toLowerCase(),u=(a.role||"").toLowerCase(),o=Ae.toLowerCase();return r.includes(o)||i.includes(o)||u.includes(o)});return x?e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsx("button",{onClick:()=>X(null),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(R,{size:24})}),e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Profile"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden animate-slide-up",children:[e.jsxs("div",{className:"bg-slate-800 p-6 text-white flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-600 flex items-center justify-center text-2xl font-bold border-2 border-slate-500",children:(x.fullName||"?").charAt(0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:x.fullName||"Unnamed User"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded text-xs font-bold uppercase",children:(x.role||"UNKNOWN").replace("_"," ")}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase ${x.active?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:x.active?"Active":"Suspended"})]})]})]}),e.jsxs("div",{className:"text-right text-xs opacity-60 font-mono",children:["ID: ",x.id]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(ss,{size:16,className:"text-slate-400"})," Contact Details"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Mobile Phone"}),e.jsx("a",{href:`tel:${x.phone}`,className:"text-blue-600 font-bold hover:underline",children:x.phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Home Address"}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(es,{size:14,className:"mt-0.5 text-slate-400"}),e.jsx("p",{className:"text-slate-900",children:x.address||"Not Provided"})]})]}),x.communityId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Community Connection"}),e.jsx("p",{className:"text-purple-700 font-bold bg-purple-50 px-2 py-1 rounded w-fit text-sm mt-1",children:x.communityId})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold text-slate-900 border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(ls,{size:16,className:"text-slate-400"})," Emergency Profile"]}),x.medicalNeeds&&e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[e.jsx("p",{className:"text-xs text-red-600 font-bold uppercase mb-1",children:"Medical Needs"}),e.jsx("p",{className:"text-red-900 font-medium text-sm",children:x.medicalNeeds})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Household"}),e.jsxs("p",{className:"text-slate-900 font-bold text-lg",children:[x.householdMembers," Member(s)"]}),Array.isArray(x.household)&&x.household.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:x.household.map(a=>e.jsxs("div",{className:"text-xs bg-slate-100 p-2 rounded flex justify-between",children:[e.jsx("span",{className:"font-bold",children:a.name}),e.jsxs("span",{className:"text-slate-500",children:[a.age," • ",a.needs||"No needs"]})]},a.id))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase",children:"Emergency Contact"}),e.jsxs("p",{className:"text-slate-900 text-sm font-medium",children:[x.emergencyContactName," ",e.jsxs("span",{className:"text-slate-500",children:["(",x.emergencyContactRelation,")"]})]}),e.jsx("a",{href:`tel:${x.emergencyContactPhone}`,className:"text-sm font-bold text-slate-700",children:x.emergencyContactPhone})]})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 mt-4 space-y-4",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm uppercase tracking-wider",children:"Account Management"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"System Role"}),e.jsx("select",{value:x.role,onChange:a=>Ps(x.id,a.target.value),className:`text-sm p-2 rounded border bg-white font-medium ${x.active?"border-slate-300":"opacity-50 cursor-not-allowed"}`,disabled:!x.active,children:Ie.map(a=>e.jsx("option",{value:a.id,children:a.label},a.id))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Account Status"}),e.jsx(d,{size:"sm",onClick:()=>Os(x.id,x.active!==!1),className:x.active?"bg-red-100 text-red-700 hover:bg-red-200 border-red-200":"bg-green-600 text-white",children:x.active?"Suspend Account":"Activate Account"})]})]})]})]})]}):e.jsxs("div",{className:"p-6 pb-28 space-y-6 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4 sticky top-0 bg-slate-50 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>v("MAIN"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800",children:e.jsx(R,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"User Directory"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Manage All Registered Users & Permissions"})]})]}),e.jsxs(d,{size:"sm",variant:"outline",className:"border-slate-300 text-slate-900 hover:bg-slate-100 h-9",onClick:Ls,children:[e.jsx(Ne,{size:16,className:"mr-2"})," Export CSV"]})]}),e.jsxs("div",{className:"flex bg-white rounded-lg p-1 border border-slate-200",children:[e.jsxs("button",{onClick:()=>le("ALL_USERS"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${Q==="ALL_USERS"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"}`,children:["All Users (",s.length,")"]}),e.jsx("button",{onClick:()=>le("ROLE_DEFINITIONS"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${Q==="ROLE_DEFINITIONS"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-900"}`,children:"Role Definitions"})]}),Q==="ROLE_DEFINITIONS"&&e.jsx("div",{className:"space-y-4",children:Ie.map(a=>e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-100",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:a.label}),e.jsx("p",{className:"text-xs text-slate-500",children:a.description})]}),e.jsx("div",{className:"p-4 space-y-3",children:Object.entries(a.permissions).map(([r,i])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 capitalize",children:r.replace("can","").replace(/([A-Z])/g," $1").trim()}),e.jsx("button",{onClick:()=>Es(a.id,r),className:`w-10 h-5 rounded-full relative transition-colors ${i?"bg-green-500":"bg-slate-300"}`,children:e.jsx("div",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${i?"left-[22px]":"left-0.5"}`})})]},r))})]},a.id))}),Q==="ALL_USERS"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3.5 text-slate-400",size:18}),e.jsx(w,{className:"pl-10 h-10",placeholder:"Search users by name, phone, or role...",value:Ae,onChange:a=>us(a.target.value)})]}),t.map(a=>{const r=a.createdAt?new Date(a.createdAt).toLocaleDateString():"Unknown";return e.jsxs("div",{onClick:()=>X(a),className:`bg-white p-4 rounded-xl border shadow-sm flex flex-col gap-3 cursor-pointer hover:border-brand-400 hover:shadow-md transition-all group ${a.active?"border-slate-200":"border-red-200 bg-red-50/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${a.active?"bg-slate-100 text-slate-600":"bg-red-100 text-red-500"}`,children:e.jsx(ye,{size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-bold group-hover:text-brand-700 transition-colors ${a.active?"text-slate-900":"text-slate-500 line-through"}`,children:a.fullName||"Unnamed User"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[a.phone||"No phone"," ",a.role==="ADMIN"&&e.jsx("span",{className:"text-brand-600 font-bold ml-1",children:"(Admin)"})]}),e.jsxs("p",{className:"text-[11px] text-slate-400",children:["Created: ",r]})]})]}),e.jsx(as,{size:18,className:"text-slate-300 group-hover:text-brand-500"})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-100 flex justify-between items-center",children:[e.jsxs("span",{className:`text-[10px] font-bold uppercase ${a.active?"text-green-600":"text-red-600"}`,children:["Status: ",a.active?"Active":"Deactivated"]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-slate-100 rounded text-slate-600 font-medium",children:(a.role||"UNKNOWN").replace("_"," ")})]})]},a.id)}),t.length===0&&e.jsx("p",{className:"text-center text-slate-400 py-4",children:"No users found."})]})]})}return e.jsxs("div",{className:"p-6 pb-28 space-y-8 animate-fade-in bg-slate-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>I("DASHBOARD"),className:"p-2 -ml-2 text-slate-500 hover:text-slate-800 md:hidden",children:e.jsx(R,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:Ce("settings.title")})]}),J&&e.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center gap-1 animate-fade-in",children:[e.jsx(te,{size:16})," Saved"]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-full text-indigo-600",children:e.jsx(Ks,{size:24})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:Ce("settings.language")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ge("en"),className:`flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ${l.language==="en"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:"English"}),e.jsx("button",{onClick:()=>ge("es"),className:`flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ${l.language==="es"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:"Español"}),e.jsx("button",{onClick:()=>ge("fr"),className:`flex-1 py-3 px-4 rounded-xl border-2 font-bold transition-all ${l.language==="fr"?"border-indigo-600 bg-indigo-50 text-indigo-800":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:"Français"})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:e.jsx(ve,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Legal & Consent"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Privacy policy and proof of consent"})]})]}),e.jsxs(d,{onClick:()=>{sessionStorage.setItem("privacyReturnView","SETTINGS"),I("PRIVACY_POLICY")},variant:"outline",className:"w-full justify-between",children:[e.jsx("span",{children:"View Proof of Consent & Privacy Policy"}),e.jsx(ns,{size:18})]})]}),N&&e.jsxs("section",{className:"bg-slate-900 text-white p-6 rounded-2xl shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:e.jsx(ve,{size:80})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-brand-400 font-bold text-xs uppercase tracking-wider",children:[e.jsx(qs,{size:12})," Administrator Area"]}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Roles & Dashboards"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{onClick:Ds,className:"bg-brand-600 hover:bg-brand-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"User Directory & Access Control"}),e.jsx(we,{size:18})]}),e.jsxs(d,{onClick:As,className:"bg-purple-600 hover:bg-purple-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Organization Directory"}),e.jsx(se,{size:18})]}),e.jsxs(d,{onClick:Rs,className:"bg-orange-600 hover:bg-orange-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Master Inventory Database"}),e.jsx(ns,{size:18})]}),e.jsxs(d,{onClick:zs,className:"bg-red-600 hover:bg-red-500 text-white border-0 w-full justify-between",children:[e.jsx("span",{children:"Manage Broadcasts"}),e.jsx(et,{size:18})]}),e.jsxs(d,{onClick:Is,variant:"outline",className:"border-slate-700 text-slate-300 hover:text-white hover:bg-slate-800 w-full justify-between",children:[e.jsx("span",{children:"View Raw Database"}),e.jsx(st,{size:18})]})]})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-brand-50 rounded-full text-brand-600",children:e.jsx(ye,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Identity"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Your personal account and contact details."})]})]}),e.jsxs("div",{className:"text-xs text-slate-400 font-mono -mt-4 mb-2",children:["ID: ",l.id]}),e.jsx(w,{label:"Full Name",value:l.fullName,onChange:s=>f("fullName",s.target.value),placeholder:"e.g. Jane Doe"}),e.jsx(w,{label:"Mobile Phone",value:l.phone,onChange:s=>f("phone",hs(s.target.value)),onBlur:()=>Je(l.phone),placeholder:"e.g. (555) 123-4567",className:k?"border-red-500 bg-red-50":"",error:k||void 0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Home Address"}),e.jsx("div",{children:e.jsx("input",{placeholder:"123 Main St...",value:l.address,onChange:s=>f("address",s.target.value),className:`w-full px-4 py-3 rounded-lg border focus:ring-2 outline-none transition-all font-medium ${$==="VALID"?"border-green-500 bg-green-50 focus:ring-green-500":$==="INVALID"?"border-red-500 bg-red-50 focus:ring-red-500":"border-slate-300 focus:ring-brand-500 focus:border-brand-500"}`})}),$==="VALID"&&e.jsx("p",{className:"text-xs text-green-600 font-bold mt-1",children:"Verified with Google Maps"}),$==="INVALID"&&e.jsx("p",{className:"text-xs text-red-600 font-bold mt-1",children:"Address not found on Maps"})]}),e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:"Emergency Contact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{placeholder:"Contact Name",value:l.emergencyContactName,onChange:s=>f("emergencyContactName",s.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(w,{placeholder:"Mobile Phone",type:"tel",value:l.emergencyContactPhone,onChange:s=>f("emergencyContactPhone",hs(s.target.value))}),e.jsx(w,{placeholder:"Relationship",value:l.emergencyContactRelation,onChange:s=>f("emergencyContactRelation",s.target.value)})]})]})]}),e.jsxs(d,{onClick:js,fullWidth:!0,className:"shadow-md mt-4 bg-slate-800 hover:bg-slate-700",size:"lg",disabled:Re,children:[e.jsx(tt,{size:20,className:"mr-2"})," ",Re?"Saving...":"Update Profile"]}),Le&&e.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:Le})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-emerald-50 rounded-full text-emerald-700",children:e.jsx(we,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Your Home"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Household code connects family members to the same home."})]})]}),e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4 flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-700 uppercase tracking-wider",children:"Household Code"}),e.jsx("p",{className:"text-2xl font-mono font-black tracking-widest text-emerald-900",children:l.householdCode||"------"}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-1",children:[l.householdName||"Your Home"," • ",l.householdRole||"OWNER"]})]}),e.jsxs(d,{size:"sm",variant:"ghost",onClick:()=>ee(l.householdCode||""),disabled:!l.householdCode,className:"text-emerald-800 hover:bg-emerald-100",children:[e.jsx(Y,{size:16,className:"mr-2"})," Copy"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-3 items-end",children:[e.jsx(w,{label:"Join Home by Code",placeholder:"e.g. A3K7Q2 or A3K7Q2-BOB",value:me,onChange:s=>Te(s.target.value.toUpperCase()),maxLength:24}),e.jsx(d,{onClick:Ss,disabled:Fe||me.trim().length<6,children:Fe?"Joining...":"Join Home"})]}),Be&&e.jsx("p",{className:"text-xs text-red-600 font-semibold",children:Be}),$e&&e.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:$e}),e.jsx("div",{children:e.jsx(w,{label:"Household Size",type:"number",min:1,value:String(l.householdMembers||1),onChange:s=>f("householdMembers",Math.max(1,Number(s.target.value)||1))})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Who lives in your home"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Each member requires DOB in MM/DD/YYYY plus mobility and medical flags."}),e.jsx(lt,{members:l.household,onChange:s=>f("household",s)})]}),e.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-emerald-700 uppercase tracking-wider",children:"Member Login Invites"}),e.jsx("p",{className:"text-xs text-emerald-800 mt-1",children:"Members with login enabled can be invited by manual code and tracked here."})]}),Xe.length===0?e.jsx("p",{className:"text-xs text-emerald-700",children:"No member logins enabled yet. Turn on “Enable member login” for a household member to create an invite."}):e.jsx("div",{className:"space-y-2",children:Xe.map(s=>{var t,a;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-emerald-200 bg-white p-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-xs text-slate-600",children:["Invite Code: ",e.jsx("span",{className:"font-mono font-bold tracking-wider",children:((t=O[s.id])==null?void 0:t.invitationCode)||be(s)})]}),O[s.id]&&e.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",O[s.id].status,O[s.id].expiresAt?` • Expires ${new Date(O[s.id].expiresAt).toLocaleDateString()}`:""]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(d,{size:"sm",variant:"ghost",className:"text-emerald-800 hover:bg-emerald-100",onClick:()=>ys(s),disabled:H===s.id,children:[e.jsx(Y,{size:14,className:"mr-1"})," ",H===s.id?"Working...":"Copy"]}),e.jsx(d,{size:"sm",variant:"ghost",className:"text-slate-700 hover:bg-slate-100",onClick:()=>ws(s),disabled:H===s.id,children:H===s.id?"Working...":"Resend"}),((a=O[s.id])==null?void 0:a.status)==="PENDING"&&e.jsx(d,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:()=>Cs(s),disabled:H===s.id,children:"Revoke"})]})]},s.id)})}),Ge&&e.jsx("p",{className:"text-xs text-emerald-700 font-semibold",children:Ge}),Ye&&e.jsx("p",{className:"text-xs text-red-600 font-semibold",children:Ye})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-full text-red-600",children:e.jsx(ls,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Safety Setup"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Preparedness and vulnerability inputs for planning."})]})]}),e.jsx(w,{label:"ZIP Code",placeholder:"e.g. 30303",value:l.zipCode||"",onChange:s=>f("zipCode",s.target.value)}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Medication Dependency"}),e.jsx("input",{type:"checkbox",checked:!!l.medicationDependency,onChange:s=>f("medicationDependency",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Insulin Dependency"}),e.jsx("input",{type:"checkbox",checked:!!l.insulinDependency,onChange:s=>f("insulinDependency",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Oxygen / Powered Medical Device"}),e.jsx("input",{type:"checkbox",checked:!!l.oxygenPoweredDevice,onChange:s=>f("oxygenPoweredDevice",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Mobility Limitation"}),e.jsx("input",{type:"checkbox",checked:!!l.mobilityLimitation,onChange:s=>f("mobilityLimitation",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Transportation Access"}),e.jsx("input",{type:"checkbox",checked:!!l.transportationAccess,onChange:s=>f("transportationAccess",s.target.checked)})]}),e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 p-3",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Financial Strain"}),e.jsx("input",{type:"checkbox",checked:!!l.financialStrain,onChange:s=>f("financialStrain",s.target.checked)})]})]}),e.jsx(w,{label:"Pets",placeholder:"e.g. 2 Dogs",value:l.petDetails,onChange:s=>f("petDetails",s.target.value)}),e.jsx(ds,{label:"Medical / Special Needs",value:l.medicalNeeds,onChange:s=>f("medicalNeeds",s.target.value)}),e.jsxs("label",{className:"flex items-start gap-3 rounded-lg border border-emerald-200 bg-emerald-50 p-3",children:[e.jsx("input",{className:"mt-1",type:"checkbox",checked:!!l.consentPreparednessPlanning,onChange:s=>f("consentPreparednessPlanning",s.target.checked)}),e.jsx("span",{className:"text-sm text-emerald-900",children:"I understand this data is used only for preparedness planning and can be deleted anytime."})]}),e.jsx(d,{onClick:Ns,fullWidth:!0,className:"bg-red-50 border border-red-200 text-red-700 hover:bg-red-100 shadow-sm",disabled:Pe,children:Pe?"Saving...":"Update Vitals"}),Ue&&e.jsx("p",{className:"text-xs text-red-600 font-semibold mt-2",children:Ue})]}),e.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm space-y-4 border border-purple-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(se,{size:64,className:"text-purple-600"})}),e.jsxs("div",{className:"flex items-center gap-4 mb-2 relative z-10",children:[e.jsx("div",{className:"p-3 bg-purple-50 rounded-full text-purple-600",children:e.jsx(se,{size:24})}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:Ce("settings.trusted_conn")})]}),l.role==="INSTITUTION_ADMIN"?e.jsxs("div",{className:"relative z-10 space-y-3",children:[e.jsxs("div",{className:"bg-purple-100 border border-purple-200 p-4 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-purple-600 uppercase tracking-wider",children:"Your Organization ID"}),e.jsx("p",{className:"text-2xl font-mono font-black text-purple-900 tracking-widest",children:l.communityId||"NOT SET"})]}),e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>ee(l.communityId),className:"text-purple-700 hover:bg-purple-200",children:e.jsx(Y,{size:20})})]}),e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsx("div",{className:"flex-1",children:e.jsx(w,{label:"Change Organization ID",value:l.communityId,onChange:s=>{f("communityId",s.target.value),z(null),p(null)},className:C?"border-green-500 focus:ring-green-500 bg-green-50/30":c?"border-red-500 focus:ring-red-500":""})}),e.jsx(d,{className:`mb-[1px] min-w-[50px] ${C?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"}`,onClick:Qe,disabled:E||!l.communityId,children:E?e.jsx(rs,{className:"animate-spin",size:20}):C?e.jsx(te,{size:20}):e.jsx(is,{size:20})})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[e.jsx(os,{size:16})," ",c]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-3 items-end relative z-10",children:[e.jsx("div",{className:"flex-1",children:e.jsx(w,{label:"Community ID",value:l.communityId,onChange:s=>{f("communityId",s.target.value),z(null),p(null)},className:C?"border-green-500 focus:ring-green-500 bg-green-50/30":c?"border-red-500 focus:ring-red-500":""})}),e.jsx(d,{className:`mb-[1px] min-w-[50px] ${C?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"}`,onClick:Qe,disabled:E||!l.communityId,children:E?e.jsx(rs,{className:"animate-spin",size:20}):C?e.jsx(te,{size:20}):e.jsx(is,{size:20})})]}),C&&e.jsxs("p",{className:"text-xs font-semibold text-emerald-700 relative z-10",children:["Connected to ",C,"."]}),c&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-bold bg-red-50 p-2 rounded-lg animate-fade-in border border-red-100 relative z-10",children:[e.jsx(os,{size:16})," ",c]}),e.jsx("div",{className:"relative z-10 flex justify-end",children:e.jsx(d,{variant:"ghost",className:"text-red-600 hover:bg-red-50",onClick:vs,disabled:j||!l.communityId,children:j?"Disconnecting...":"Disconnect Organization"})})]})]}),e.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-200",children:e.jsxs(d,{onClick:ks,variant:"ghost",fullWidth:!0,className:"text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(at,{className:"mr-2",size:18}),"Log Out"]})})]})};export{Ct as SettingsView};
